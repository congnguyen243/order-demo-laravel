!function(t){function e(e){for(var r,n,s=e[0],o=e[1],a=0,c=[];a<s.length;a++)n=s[a],Object.prototype.hasOwnProperty.call(i,n)&&i[n]&&c.push(i[n][0]),i[n]=0;for(r in o)Object.prototype.hasOwnProperty.call(o,r)&&(t[r]=o[r]);for(u&&u(e);c.length;)c.shift()()}var r={},i={0:0};function n(e){if(r[e])return r[e].exports;var i=r[e]={i:e,l:!1,exports:{}};return t[e].call(i.exports,i,i.exports,n),i.l=!0,i.exports}n.e=function(t){var e=[],r=i[t];if(0!==r)if(r)e.push(r[2]);else{var s=new Promise((function(e,n){r=i[t]=[e,n]}));e.push(r[2]=s);var o,a=document.createElement("script");a.charset="utf-8",a.timeout=120,n.nc&&a.setAttribute("nonce",n.nc),a.src=function(t){return n.p+"17765a9205e."+({}[t]||t)+".js"}(t);var u=new Error;o=function(e){a.onerror=a.onload=null,clearTimeout(c);var r=i[t];if(0!==r){if(r){var n=e&&("load"===e.type?"missing":e.type),s=e&&e.target&&e.target.src;u.message="Loading chunk "+t+" failed.\n("+n+": "+s+")",u.name="ChunkLoadError",u.type=n,u.request=s,r[1](u)}i[t]=void 0}};var c=setTimeout((function(){o({type:"timeout",target:a})}),12e4);a.onerror=a.onload=o,document.head.appendChild(a)}return Promise.all(e)},n.m=t,n.c=r,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)n.d(r,i,function(e){return t[e]}.bind(null,i));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="https://storage.googleapis.com/public-gcs.subiz-cdn.com/widget-v4/public/",n.oe=function(t){throw console.error(t),t};var s=window._sbz_4_jsonp_17765a9205e=window._sbz_4_jsonp_17765a9205e||[],o=s.push.bind(s);s.push=e,s=s.slice();for(var a=0;a<s.length;a++)e(s[a]);var u=o;n(n.s=124)}([function(t,e,r){"use strict";var i={};r.r(i),r.d(i,"offsetToMin",(function(){return a})),r.d(i,"diffDay",(function(){return u})),r.d(i,"diffYear",(function(){return c})),r.d(i,"sameDay",(function(){return l})),r.d(i,"shortTime",(function(){return h})),r.d(i,"unixSec",(function(){return d})),r.d(i,"getMs",(function(){return p})),r.d(i,"sleep",(function(){return f})),r.d(i,"getDayName",(function(){return m}));var n={};r.r(n),r.d(n,"extractEmojis",(function(){return _})),r.d(n,"extractLinks",(function(){return b})),r.d(n,"extractEmails",(function(){return w})),r.d(n,"extractPhones",(function(){return k})),r.d(n,"extract",(function(){return S})),r.d(n,"pipeExtracts",(function(){return x})),r.d(n,"extractText",(function(){return M}));var s={};r.r(s),r.d(s,"norm",(function(){return C})),r.d(s,"getSourceFromRef",(function(){return E})),r.d(s,"evaluate",(function(){return j})),r.d(s,"trackExitIntent",(function(){return T})),r.d(s,"trackScrollingPercentage",(function(){return R})),r.d(s,"trackAreaClicked",(function(){return D})),r.d(s,"trackInactivity",(function(){return L})),r.d(s,"trackTimeOnPage",(function(){return U}));var o=r(11);function a(t){if(!t)return 0;t.length<=2&&(t+=":00");let e=t.split(":");if(2!==e.length)return 0;let r=parseInt(e[0]);if(r<0||r>23)return 0;let i=parseInt(e[1]);return i<0||i>59?0:60*r+i}function u(t,e,r){var i=-(new Date).getTimezoneOffset();r&&(i=a(r));var n=new Date(t).getTime(),s=new Date(e).getTime(),o=Math.ceil((n/60/1e3+i)/60/24),u=Math.ceil((s/60/1e3+i)/60/24);return Math.abs(o-u)}function c(t,e,r){var i=-(new Date).getTimezoneOffset(),n=-(new Date).getTimezoneOffset();r&&(n=a(r));var s=new Date(t).getTime()+60*(n-i)*1e3,o=new Date(e).getTime()+60*(n-i)*1e3;return Math.abs(new Date(s).getYear()-new Date(o).getYear())}function l(t,e,r){return 0===u(t,e,r)}function h(t,e,r){var i=-(new Date).getTimezoneOffset(),n=i;e&&(n=a(e));var s=new Date(p(t)),h=o(s).add(n-i,"minute");return r||(r=new Date),l(s,r,e)?o(h).format("HH:mm"):u(s,r,e)<=5?o(h).format("dddd, HH:mm"):0===c(s,r,e)?o(h).format("MMM D, HH:mm"):o(h).format("YYYY/M/D, HH:mm")}function d(t){return Math.floor(p(t)/1e3)}function p(t){return t?"number"!=typeof t&&(t=new Date(t).getTime()):t=0,t>1e18?Math.floor(t/1e6):t>1e15?Math.floor(t/1e3):t>1e12?t:1e3*t}var f=t=>new Promise(e=>setTimeout(e,t));function m(t){return["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"][t]}var g=r(16),v=r(16);let y=["like","unlike","wink","tongue-out","tired","surprised","smiling","sleepy","sad","neutral","heart-eyes","grinning","crying","confused","angry","cry","heart_eyes","neutral_face","emoji--disappointed","smile","open_mouth","tired_face","stuck_out_tongue","moyai","thumbsdown","dislike","thumbsup","ok_hand","octopus","pig2","wave","mouse","mouse2","rat"];function _(t){for(var e=[],r=0;r<t.length;r++)for(var i=0;i<y.length;i++)if(t.indexOf(y[i],r)===r){e.push({index:r,length:y[i].length}),r+=y[i].length-1;break}return e}function b(t){t=t||"";for(var e,r=/(https?:\/\/)?(www\.)?[-a-zA-Z0-9@:%._\+~#=]{1,256}\.[a-zA-Z0-9()]{1,6}\b([-a-zA-Z0-9()@:%_\+.,~#?&//=]*)/gim,i=[];e=r.exec(t);)i.push({index:e.index,length:r.lastIndex-e.index});return i}function w(t){t=t||"";for(var e,r=/(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))/gim,i=[];e=r.exec(t);)i.push({index:e.index,length:r.lastIndex-e.index});return i}function k(t){t=t||"";for(var e="",r={},i=0;i<t.length;i++){var n=t.charAt(i);if("."===n||"-"===n||" "===n){var s=i>0?t.charAt(i-1):"-",o=i<t.length-1?t.charAt(i+1):"-";-1!=="0123456789".indexOf(s)&&-1!=="0123456789".indexOf(o)||(r[(e+=n).length-1]=i)}else r[(e+=n).length-1]=i}for(var a,u=/([0-9]{8,13})/gim,c=[];a=u.exec(e);)c.push({index:r[a.index],length:r[u.lastIndex-1]-r[a.index]+1});return c}function S(t,e,r){if(!t)return[];var i=[],n=0,s=e(t);if(0===v.size(s))return[{type:"text",text:t}];v.each(s,e=>{i.push({type:"text",text:t.substr(n,e.index-n)}),i.push({type:r,text:t.substr(e.index,e.length)}),n=e.index+e.length});var o=v.last(s);return i.push({type:"text",text:t.substr(o.index+o.length,t.length-o.index+o.length)}),v.filter(i,t=>""!==t.text)}function x(t,e){var r=[];if(0===v.size(e))return[{type:"text",text:t}];var i=e.shift(),n=S(t,i,i.type);return v.each(n,t=>{if("text"!==t.type)return r.push(t);r=r.concat(x(t.text,e.slice()))}),r}function M(t){var e=b;e.type="link";var r=w;r.type="email";var i=k;i.type="phone";var n=_;return n.type="emoji",x(t,[r,e,i,n])}y=v.map(y,t=>":"+t+":");var A=r(16);function C(t){if(Array.isArray(t)){let e=[];for(let r of t)e.push(r.trim().toLowerCase());return e}return A.trim(t).toLowerCase()}const F=["360.cn","alice.com","aliceadsl.fr","alltheweb.com","altavista.com","aol.com","ask.com","search.aol.fr","alicesuche.aol.de","search.auone.jp","isearch.avg.com","search.babylon.com","baidu.com","biglobe.ne.jp","bing.com","search.centrum.cz","search.comcast.net","search.conduit.com","cnn.com","daum.net","ekolay.net","eniro.se","globo.com/busca","go.mail.ru","google.com","goo.ne","haosou.com","search.incredimail.com","kvasir.no","bing.com","lycos.com","search.lycos.de","mamma.com","msn.com","money.msn.com","local.msn.com","mynet.com","najdi.si","naver.com","search.netscape.com","szukaj.onet.pl","ozu.es","rakuten.co.jp","rambler.ru","search-results.com","search.smt.docomo.ne.jp","sesam.no","seznam.cz","so.com","sogou.com","szukacz.pl","buscador.terra.com.br","search.tut.by","search.ukr.net","search.virgilio.it","voila.fr","wp.pl","yahoo.com","yahoo.cn","yahoo.com","m.yahoo.com","yandex.com","yandex.ru","yam.com","coccoc.com"];let O={},P={};function E(t,e){if(""!==t)return"advertising";let r=e.match(/^(http|https|ftp)?(?:[\:\/]*)([a-z0-9\.-]*)(?:\:([0-9]+))?(\/[^?#]*)?(?:\?([^#]*))?(?:#(.*))?$/i)[2]||"";if(""===r)return"direct";if(r.startsWith("www.")&&(r=r.slice(4)),r.endsWith(".")||(r+="."),r.length>9){let t=r.substring(r.length-8,r.length-3);".com."!==t&&".net."!==t||(r=r.substring(0,r.length-3))}return P[r]?"organic":O[r]?"social":"referring"}function j(t,e,r,i){if("bool"===t){if("eq"===r)return e===i;if("ne"===r)return e!==i}if("strings"===t)return!!A.find(e,t=>{A.find(i,e=>t.indexOf(e)>0)});if("string"===t){if(i=i||"","regex"===r&&(r="con"),e=C(e),i=C(i),"eq"===r)return e===i;if("ne"===r)return e!==i;if("contains"===r||"con"===r)return e.includes(i);if("notContains"===r||"notCon"===r)return!e.includes(i);if("in"===r)return i.includes(e)}if("number"===t){if("gt"===r)return e>i;if("gte"===r)return e>=i;if("lt"===r)return e<i;if("lte"===r)return e<=i;if("eq"===r)return e===i;if("ne"===r)return e!==i;if("inRange"===r)return e>=i[0]&&e<=i[1];if("notInRange"===r)return e<i[0]||e>i[1]}return!1}function T(t){let e=r=>{r.clientY>10||(t&&t(),document.removeEventListener("mouseout",e))};document.addEventListener("mouseout",e)}function R(t,e){let r=i=>{let n=i.srcElement.scrollingElement?i.srcElement.scrollingElement.scrollTop:i.srcElement.scrollTop,s=i.srcElement.scrollingElement?i.srcElement.scrollingElement.scrollHeight:i.srcElement.scrollHeight;n>0&&s>0&&n/s>=t&&(e&&e(),window.removeEventListener("scroll",r,!1))};window.addEventListener("scroll",r,!1)}function D(t,e){t&&(t=t||"",A.map(t.split("\n"),t=>{if(!(t=A.trim(t)))return;let r=document.querySelector(t);r&&r.addEventListener("click",e,!1)}))}function L(t,e){let r=["scroll","keyup","keydown","mousemove","mousewheel","mouseenter","mouseover","mousedown","touchstart","touchmove","touchenter"],i=0,n=()=>{i=0},s=setInterval(()=>{if(i++,!(i<t)){e&&e();for(let t of r)document.removeEventListener(t,n,!1);clearInterval(s)}},1e3);for(let t of r)document.addEventListener(t,n,!1)}["facebook.com","youtube.com","twitter.com","t.co","instagram.com","linkedin.com","reddit.com","vk.com","tumblr.com","pinterest.com","meetup.com","flickr.com","ask.fm","livejournal.com","myspace.com"].forEach(t=>{O[t+"."]=!0}),F.forEach(t=>{P[t+"."]=!0});let I=0;function U(t,e){let r=setInterval(()=>{I<t||(e&&e(),clearInterval(r))},1e3)}setInterval(()=>{I++},1e3);var $={};$=Object.assign($,i),($=Object.assign($,g)).Gate=r(74).default;var z=r(46);$.get=z.get,$.set=z.set,$.Pubsub=r(75).default,$=Object.assign($,n),$=Object.assign($,s);e.a=$},function(t,e,r){(function(e){var r=function(t){return t&&t.Math==Math&&t};t.exports=r("object"==typeof globalThis&&globalThis)||r("object"==typeof window&&window)||r("object"==typeof self&&self)||r("object"==typeof e&&e)||function(){return this}()||Function("return this")()}).call(this,r(65))},function(t,e){var r={}.hasOwnProperty;t.exports=function(t,e){return r.call(t,e)}},function(t,e,r){var i=r(1),n=r(41),s=r(2),o=r(42),a=r(53),u=r(91),c=n("wks"),l=i.Symbol,h=u?l:l&&l.withoutSetter||o;t.exports=function(t){return s(c,t)||(a&&s(l,t)?c[t]=l[t]:c[t]=h("Symbol."+t)),c[t]}},function(t,e){t.exports=function(t){try{return!!t()}catch(t){return!0}}},function(t,e,r){var i=r(8);t.exports=function(t){if(!i(t))throw TypeError(String(t)+" is not an object");return t}},function(t,e,r){t.exports=r.p+"assets/img/default_avatar.5b74dc1.png"},function(t,e,r){var i=r(4);t.exports=!i((function(){return 7!=Object.defineProperty({},1,{get:function(){return 7}})[1]}))},function(t,e){t.exports=function(t){return"object"==typeof t?null!==t:"function"==typeof t}},function(t,e,r){var i=r(7),n=r(10),s=r(12);t.exports=i?function(t,e,r){return n.f(t,e,s(1,r))}:function(t,e,r){return t[e]=r,t}},function(t,e,r){var i=r(7),n=r(38),s=r(5),o=r(23),a=Object.defineProperty;e.f=i?a:function(t,e,r){if(s(t),e=o(e,!0),s(r),n)try{return a(t,e,r)}catch(t){}if("get"in r||"set"in r)throw TypeError("Accessors not supported");return"value"in r&&(t[e]=r.value),t}},function(t,e,r){t.exports=function(){"use strict";var t="millisecond",e="second",r="minute",i="hour",n="day",s="week",o="month",a="quarter",u="year",c="date",l=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[^0-9]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?.?(\d+)?$/,h=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,d={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_")},p=function(t,e,r){var i=String(t);return!i||i.length>=e?t:""+Array(e+1-i.length).join(r)+t},f={s:p,z:function(t){var e=-t.utcOffset(),r=Math.abs(e),i=Math.floor(r/60),n=r%60;return(e<=0?"+":"-")+p(i,2,"0")+":"+p(n,2,"0")},m:function t(e,r){if(e.date()<r.date())return-t(r,e);var i=12*(r.year()-e.year())+(r.month()-e.month()),n=e.clone().add(i,o),s=r-n<0,a=e.clone().add(i+(s?-1:1),o);return+(-(i+(r-n)/(s?n-a:a-n))||0)},a:function(t){return t<0?Math.ceil(t)||0:Math.floor(t)},p:function(l){return{M:o,y:u,w:s,d:n,D:c,h:i,m:r,s:e,ms:t,Q:a}[l]||String(l||"").toLowerCase().replace(/s$/,"")},u:function(t){return void 0===t}},m="en",g={};g[m]=d;var v=function(t){return t instanceof w},y=function(t,e,r){var i;if(!t)return m;if("string"==typeof t)g[t]&&(i=t),e&&(g[t]=e,i=t);else{var n=t.name;g[n]=t,i=n}return!r&&i&&(m=i),i||!r&&m},_=function(t,e){if(v(t))return t.clone();var r="object"==typeof e?e:{};return r.date=t,r.args=arguments,new w(r)},b=f;b.l=y,b.i=v,b.w=function(t,e){return _(t,{locale:e.$L,utc:e.$u,x:e.$x,$offset:e.$offset})};var w=function(){function d(t){this.$L=y(t.locale,null,!0),this.parse(t)}var p=d.prototype;return p.parse=function(t){this.$d=function(t){var e=t.date,r=t.utc;if(null===e)return new Date(NaN);if(b.u(e))return new Date;if(e instanceof Date)return new Date(e);if("string"==typeof e&&!/Z$/i.test(e)){var i=e.match(l);if(i){var n=i[2]-1||0,s=(i[7]||"0").substring(0,3);return r?new Date(Date.UTC(i[1],n,i[3]||1,i[4]||0,i[5]||0,i[6]||0,s)):new Date(i[1],n,i[3]||1,i[4]||0,i[5]||0,i[6]||0,s)}}return new Date(e)}(t),this.$x=t.x||{},this.init()},p.init=function(){var t=this.$d;this.$y=t.getFullYear(),this.$M=t.getMonth(),this.$D=t.getDate(),this.$W=t.getDay(),this.$H=t.getHours(),this.$m=t.getMinutes(),this.$s=t.getSeconds(),this.$ms=t.getMilliseconds()},p.$utils=function(){return b},p.isValid=function(){return!("Invalid Date"===this.$d.toString())},p.isSame=function(t,e){var r=_(t);return this.startOf(e)<=r&&r<=this.endOf(e)},p.isAfter=function(t,e){return _(t)<this.startOf(e)},p.isBefore=function(t,e){return this.endOf(e)<_(t)},p.$g=function(t,e,r){return b.u(t)?this[e]:this.set(r,t)},p.unix=function(){return Math.floor(this.valueOf()/1e3)},p.valueOf=function(){return this.$d.getTime()},p.startOf=function(t,a){var l=this,h=!!b.u(a)||a,d=b.p(t),p=function(t,e){var r=b.w(l.$u?Date.UTC(l.$y,e,t):new Date(l.$y,e,t),l);return h?r:r.endOf(n)},f=function(t,e){return b.w(l.toDate()[t].apply(l.toDate("s"),(h?[0,0,0,0]:[23,59,59,999]).slice(e)),l)},m=this.$W,g=this.$M,v=this.$D,y="set"+(this.$u?"UTC":"");switch(d){case u:return h?p(1,0):p(31,11);case o:return h?p(1,g):p(0,g+1);case s:var _=this.$locale().weekStart||0,w=(m<_?m+7:m)-_;return p(h?v-w:v+(6-w),g);case n:case c:return f(y+"Hours",0);case i:return f(y+"Minutes",1);case r:return f(y+"Seconds",2);case e:return f(y+"Milliseconds",3);default:return this.clone()}},p.endOf=function(t){return this.startOf(t,!1)},p.$set=function(s,a){var l,h=b.p(s),d="set"+(this.$u?"UTC":""),p=(l={},l[n]=d+"Date",l[c]=d+"Date",l[o]=d+"Month",l[u]=d+"FullYear",l[i]=d+"Hours",l[r]=d+"Minutes",l[e]=d+"Seconds",l[t]=d+"Milliseconds",l)[h],f=h===n?this.$D+(a-this.$W):a;if(h===o||h===u){var m=this.clone().set(c,1);m.$d[p](f),m.init(),this.$d=m.set(c,Math.min(this.$D,m.daysInMonth())).$d}else p&&this.$d[p](f);return this.init(),this},p.set=function(t,e){return this.clone().$set(t,e)},p.get=function(t){return this[b.p(t)]()},p.add=function(t,a){var c,l=this;t=Number(t);var h=b.p(a),d=function(e){var r=_(l);return b.w(r.date(r.date()+Math.round(e*t)),l)};if(h===o)return this.set(o,this.$M+t);if(h===u)return this.set(u,this.$y+t);if(h===n)return d(1);if(h===s)return d(7);var p=(c={},c[r]=6e4,c[i]=36e5,c[e]=1e3,c)[h]||1,f=this.$d.getTime()+t*p;return b.w(f,this)},p.subtract=function(t,e){return this.add(-1*t,e)},p.format=function(t){var e=this;if(!this.isValid())return"Invalid Date";var r=t||"YYYY-MM-DDTHH:mm:ssZ",i=b.z(this),n=this.$locale(),s=this.$H,o=this.$m,a=this.$M,u=n.weekdays,c=n.months,l=function(t,i,n,s){return t&&(t[i]||t(e,r))||n[i].substr(0,s)},d=function(t){return b.s(s%12||12,t,"0")},p=n.meridiem||function(t,e,r){var i=t<12?"AM":"PM";return r?i.toLowerCase():i},f={YY:String(this.$y).slice(-2),YYYY:this.$y,M:a+1,MM:b.s(a+1,2,"0"),MMM:l(n.monthsShort,a,c,3),MMMM:l(c,a),D:this.$D,DD:b.s(this.$D,2,"0"),d:String(this.$W),dd:l(n.weekdaysMin,this.$W,u,2),ddd:l(n.weekdaysShort,this.$W,u,3),dddd:u[this.$W],H:String(s),HH:b.s(s,2,"0"),h:d(1),hh:d(2),a:p(s,o,!0),A:p(s,o,!1),m:String(o),mm:b.s(o,2,"0"),s:String(this.$s),ss:b.s(this.$s,2,"0"),SSS:b.s(this.$ms,3,"0"),Z:i};return r.replace(h,(function(t,e){return e||f[t]||i.replace(":","")}))},p.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},p.diff=function(t,c,l){var h,d=b.p(c),p=_(t),f=6e4*(p.utcOffset()-this.utcOffset()),m=this-p,g=b.m(this,p);return g=(h={},h[u]=g/12,h[o]=g,h[a]=g/3,h[s]=(m-f)/6048e5,h[n]=(m-f)/864e5,h[i]=m/36e5,h[r]=m/6e4,h[e]=m/1e3,h)[d]||m,l?g:b.a(g)},p.daysInMonth=function(){return this.endOf(o).$D},p.$locale=function(){return g[this.$L]},p.locale=function(t,e){if(!t)return this.$L;var r=this.clone(),i=y(t,e,!0);return i&&(r.$L=i),r},p.clone=function(){return b.w(this.$d,this)},p.toDate=function(){return new Date(this.valueOf())},p.toJSON=function(){return this.isValid()?this.toISOString():null},p.toISOString=function(){return this.$d.toISOString()},p.toString=function(){return this.$d.toUTCString()},d}(),k=w.prototype;return _.prototype=k,[["$ms",t],["$s",e],["$m",r],["$H",i],["$W",n],["$M",o],["$y",u],["$D",c]].forEach((function(t){k[t[1]]=function(e){return this.$g(e,t[0],t[1])}})),_.extend=function(t,e){return t.$i||(t(e,w,_),t.$i=!0),_},_.locale=y,_.isDayjs=v,_.unix=function(t){return _(1e3*t)},_.en=g[m],_.Ls=g,_.p={},_}()},function(t,e){t.exports=function(t,e){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:e}}},function(t,e,r){var i=r(1),n=r(9),s=r(2),o=r(24),a=r(40),u=r(14),c=u.get,l=u.enforce,h=String(String).split("String");(t.exports=function(t,e,r,a){var u,c=!!a&&!!a.unsafe,d=!!a&&!!a.enumerable,p=!!a&&!!a.noTargetGet;"function"==typeof r&&("string"!=typeof e||s(r,"name")||n(r,"name",e),(u=l(r)).source||(u.source=h.join("string"==typeof e?e:""))),t!==i?(c?!p&&t[e]&&(d=!0):delete t[e],d?t[e]=r:n(t,e,r)):d?t[e]=r:o(e,r)})(Function.prototype,"toString",(function(){return"function"==typeof this&&c(this).source||a(this)}))},function(t,e,r){var i,n,s,o=r(66),a=r(1),u=r(8),c=r(9),l=r(2),h=r(25),d=r(26),p=r(27),f=a.WeakMap;if(o){var m=h.state||(h.state=new f),g=m.get,v=m.has,y=m.set;i=function(t,e){return e.facade=t,y.call(m,t,e),e},n=function(t){return g.call(m,t)||{}},s=function(t){return v.call(m,t)}}else{var _=d("state");p[_]=!0,i=function(t,e){return e.facade=t,c(t,_,e),e},n=function(t){return l(t,_)?t[_]:{}},s=function(t){return l(t,_)}}t.exports={set:i,get:n,has:s,enforce:function(t){return s(t)?n(t):i(t,{})},getterFor:function(t){return function(e){var r;if(!u(e)||(r=n(e)).type!==t)throw TypeError("Incompatible receiver, "+t+" required");return r}}}},function(t,e){t.exports={}},function(t,e,r){"use strict";r.r(e),r.d(e,"parseJSON",(function(){return n})),r.d(e,"isValidLanguageCode",(function(){return s})),r.d(e,"convoOfEv",(function(){return o})),r.d(e,"convoToEv",(function(){return a})),r.d(e,"setMsgField",(function(){return u})),r.d(e,"getMsgField",(function(){return c})),r.d(e,"cloneDeep",(function(){return l})),r.d(e,"randomString",(function(){return h})),r.d(e,"filter",(function(){return d})),r.d(e,"includes",(function(){return p})),r.d(e,"map",(function(){return f})),r.d(e,"each",(function(){return m})),r.d(e,"usersOfConvo",(function(){return g})),r.d(e,"isConvoSeen",(function(){return v})),r.d(e,"agentsOfConvo",(function(){return y})),r.d(e,"isURL",(function(){return _})),r.d(e,"startsWith",(function(){return b})),r.d(e,"size",(function(){return w})),r.d(e,"trim",(function(){return k})),r.d(e,"trimStart",(function(){return S})),r.d(e,"throttle",(function(){return x})),r.d(e,"debounce",(function(){return M})),r.d(e,"find",(function(){return A})),r.d(e,"findIndex",(function(){return C})),r.d(e,"orderBy",(function(){return F})),r.d(e,"getIntegrationId",(function(){return O})),r.d(e,"isEmail",(function(){return P})),r.d(e,"getUrlParameter",(function(){return E})),r.d(e,"last",(function(){return j})),r.d(e,"backwardCompatibleEv",(function(){return T})),r.d(e,"getAgentDisplayName",(function(){return R})),r.d(e,"isUserBanned",(function(){return D})),r.d(e,"setUserAttr",(function(){return L})),r.d(e,"getUserAttr",(function(){return I})),r.d(e,"stringify",(function(){return U})),r.d(e,"jsonTest",(function(){return z})),r.d(e,"assignDeep",(function(){return G})),r.d(e,"norm",(function(){return H})),r.d(e,"noop",(function(){return Y})),r.d(e,"isMobile",(function(){return V}));r(64);var i=r(46);function n(t){try{return $(t)}catch(t){}}function s(t){return w(t)>0&&["en","vi","en-US","vi-VN"].indexOf(t)>=0}function o(t){if(!t)return"";switch(t.type){case"conversation_state_updated":case"conversation_joined":case"conversation_invited":case"conversation_left":case"conversation_tagged":case"conversation_untagged":case"conversation_typing":case"conversation_rating_requested":case"conversation_rated":return i.get(t,"data.conversation.id");case"message_sent":case"message_updated":case"message_pong":return i.get(t,"data.message.conversation_id");case"ticket_updated":return i.get(t,"data.ticket.conversation_id");default:return""}}function a(t,e){if(!e)return"";switch(e.type){case"conversation_state_updated":case"conversation_joined":case"conversation_invited":case"conversation_left":case"conversation_tagged":case"conversation_untagged":case"conversation_typing":case"conversation_rating_requested":case"conversation_rated":return i.set(e,"data.conversation.id",t);case"message_sent":case"message_updated":case"message_pong":return i.set(e,"data.message.conversation_id",t);case"ticket_updated":return i.set(e,"data.ticket.conversation_id",t);default:return""}}function u(t,e,r){var n=i.get(t,"data.message.fields")||[];(n=d(n,t=>t.key!==e)).push({key:e,value:U(r)}),i.set(t,"data.message.fields",n)}function c(t,e){var r=i.get(t,"data.message.fields");if(0===w(r))return;let n=r.find(t=>t.key===e);try{return n?$(n.value):void 0}catch(t){}}function l(t){if(t!==Object(t))return t;var e=U(t);return void 0!==e?$(e):void 0}function h(t){var e,r="";(!t||t<1)&&(t=10);for(var i=0;i<t;i++)e=Math.floor(25*Math.random()+97),r+=String.fromCharCode(e);return r}function d(t,e){if(!t)return[];if(!e)return t;var r=[];if(Array.isArray(t)){for(let i=0;i<t.length;i++)e(t[i],i)&&r.push(t[i]);return r}if("object"==typeof t){var i=Object.keys(t);for(let s=0;s<i.length;s++){var n=i[s];e(t[n],n)&&r.push(t[n])}return r}return r}function p(t,e){if(!t)return!1;var r="string"==typeof t||t instanceof String;return!(!Array.isArray(t)&&!r)&&t.includes(e)}function f(t,e){if(!t)return[];e||(e=t=>t);var r=[];if(Array.isArray(t)){for(let i=0;i<t.length;i++)r.push(e(t[i],i));return r}if("object"==typeof t){var i=Object.keys(t);for(let s=0;s<i.length;s++){var n=i[s];r.push(e(t[n],n))}return r}return r}function m(t,e){return f(t,e)}function g(t){return t?f(d(t.members,t=>"user"===t.type),t=>t.id):[]}function v(t,e){if(!e)return!0;if(0===w(e))return!0;var r=(e=d(e,t=>"message_sent"===t.type))[w(e)-1];if(!r)return!0;if(i.get(r,"by.id")===t)return!0;return!!A(i.get(r,"data.message.pongs",[]),e=>"seen"===e.type&&e.member_id===t)}function y(t,e){return t?f(d(t.members,t=>e?"agent"===t.type||"bot"===t.type:"agent"===t.type),t=>t.id):[]}function _(t){return new RegExp("^((https?|content):\\/\\/)?((([a-z\\d]([a-z\\d-]*[a-z\\d])*)\\.?)+[a-z]{2,}|((\\d{1,3}\\.){3}\\d{1,3}))(\\:\\d+)?(\\/[-a-z\\d%_.~+]*)*(\\?[;&a-z\\d%_.~+=-]*)?(\\#[-a-z\\d_]*)?$","i").test(t)}function b(t,e){return((t||"")+"").startsWith(e)}function w(t){return t?void 0!==t.length?t.length:Object.keys(t).length:0}function k(t,e){return((t||"")+"").replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")}function S(t,e){for(t=(t||"")+"";t.charAt(0)===e;)t=t.substr(1);return t}function x(t,e,r){var i,n,s,o=null,a=0;r||(r={});var u=function(){a=!1===r.leading?0:(new Date).getTime(),o=null,s=t.apply(i,n),o||(i=n=null)};return function(){var c=(new Date).getTime();a||!1!==r.leading||(a=c);var l=e-(c-a);return i=this,n=arguments,l<=0||l>e?(o&&(clearTimeout(o),o=null),a=c,s=t.apply(i,n),o||(i=n=null)):o||!1===r.trailing||(o=setTimeout(u,l)),s}}function M(t,e,r){var i;return function(){var n=this,s=arguments,o=r&&!i;clearTimeout(i),i=setTimeout((function(){i=null,r||t.apply(n,s)}),e),o&&t.apply(n,s)}}function A(t,e){if(t)return t[C(t,e)]}function C(t,e){if(!t)return-1;if(!e)return-1;if(Array.isArray(t)){for(let r=0;r<t.length;r++)if(e(t[r],r))return r;return-1}if("object"==typeof t){var r=Object.keys(t);for(let n=0;n<r.length;n++){var i=r[n];if(e(t[i],i))return i}}return-1}function F(t,e,r){var i=[];return m(t,t=>i.push(t)),i.sort((t,i)=>{if(t[e]===i[e])return 0;var n=t[e]<i[e]?-1:1;return"desc"===r?-n:n}),i}function O(t){return t+".subizv4.subikon"}function P(t){return/^((([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)|((\x22)((((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(([\x01-\x08\x0b\x0c\x0e-\x1f\x7f]|\x21|[\x23-\x5b]|[\x5d-\x7e]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(\\([\x01-\x09\x0b\x0c\x0d-\x7f]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))))*(((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(\x22)))@((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))$/i.test(String(t).toLowerCase())}function E(t=window.location.search,e){e=e.replace(/[[]/,"\\[").replace(/[\]]/,"\\]");var r=new RegExp("[\\?&]"+e+"=([^&#]*)").exec(t);return null===r?"":decodeURIComponent(r[1].replace(/\+/g," "))}function j(t){var e=null==t?0:t.length;return e?t[e-1]:void 0}function T(t,e){if("message_sent"===i.get(t,"type")){var r=i.get(t,"data.message.attachments",[]);r=d(r,t=>!!t);var n=[];m(r,t=>{"button"===t.type&&(t.buttons=d(t.buttons,t=>!!t&&("widget_ask_contact_info_button"!==t.type||(n.push({type:"ask_info_form",form:{title:t.title,fields:[{input_type:"text",title:"Name",name:"fullname",default_answer:U(I(e,"fullname","text")),is_required:!0},{input_type:"text",title:"Email",name:"emails",default_answer:U(I(e,"emails","text")),is_required:!0},{input_type:"text",title:"Phone",name:"phones",default_answer:U(I(e,"phones","text")),is_required:!0}]}}),!1))))}),w(r=r.concat(n))>0&&i.set(t,"data.message.attachments",r)}}function R(t,e){return i.get(e,"fullname")||i.get(e,"email")||i.get(t,"name")||"Agent"}function D(t){return I(t,"is_ban","boolean")}function L(t,e){if(t&&i.get(e,"key")){t.attributes=t.attributes||[];var r=C(t.attributes,t=>t.key===e.key);-1!==r?t.attributes[r]=e:t.attributes.push(e)}}function I(t,e,r){if(!t||!t.attributes)return;let i;return m(t.attributes,t=>{t&&t.key===e&&("datetime"===r&&(i=t.datetime),"boolean"===r&&(i=t.boolean),"number"===r&&(i=t.number),"text"===r&&(i=t.text),"list"===r&&(i=t.list))}),i}var U=JSON.stringify,$=JSON.parse;function z(){if('{"a":["1",2]}'===JSON.stringify({a:["1",2]})){var t=JSON.parse('{"a":["1",2]}');if(t.a&&"1"===t.a[0]&&2===t.a[1])return}window.Prototype&&(delete Object.prototype.toJSON,delete Array.prototype.toJSON,delete Hash.prototype.toJSON,delete String.prototype.toJSON),JSON.decode&&($=JSON.decode),JSON.encode&&(U=JSON.encode)}function B(t){return null===t?"null":void 0===t?"undefined":"object"==typeof t?Array.isArray(t)?"array":"object":typeof t}function q(t){return"object"===B(t)?W(t):"array"===B(t)?N(t):t}function N(t){return f(t,q)}function W(t){const e={};for(const r in t)t.hasOwnProperty(r)&&(e[r]=q(t[r]));return e}function G(t,...e){const r=t||{};for(let t=0;t<e.length;t++){const i=e[t],n=Object.keys(i);for(let t=0;t<n.length;t++){const e=n[t],s=i[e],o=B(s),a=B(r[e]);if("object"===o)if("undefined"!==a){const t="object"===a?r[e]:{};r[e]=G({},t,W(s))}else r[e]=W(s);else if("array"===o)if("array"===a){const t=N(s);r[e]=t}else r[e]=N(s);else r[e]=s}}return r}function H(t){return(t=t||"").trim().toLowerCase()}function Y(){}function V(){return[/Android/i,/webOS/i,/iPhone/i,/iPad/i,/iPod/i,/BlackBerry/i,/Windows Phone/i].some(t=>navigator.userAgent.match(t))}z()},function(t,e,r){t.exports=function(t){var e={};function r(i){if(e[i])return e[i].exports;var n=e[i]={i:i,l:!1,exports:{}};return t[i].call(n.exports,n,n.exports,r),n.l=!0,n.exports}return r.m=t,r.c=e,r.d=function(t,e,i){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},r.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(r.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)r.d(i,n,function(e){return t[e]}.bind(null,n));return i},r.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="",r(r.s=90)}({17:function(t,e,r){"use strict";e.__esModule=!0,e.default=void 0;var i=r(18),n=function(){function t(){}return t.getFirstMatch=function(t,e){var r=e.match(t);return r&&r.length>0&&r[1]||""},t.getSecondMatch=function(t,e){var r=e.match(t);return r&&r.length>1&&r[2]||""},t.matchAndReturnConst=function(t,e,r){if(t.test(e))return r},t.getWindowsVersionName=function(t){switch(t){case"NT":return"NT";case"XP":return"XP";case"NT 5.0":return"2000";case"NT 5.1":return"XP";case"NT 5.2":return"2003";case"NT 6.0":return"Vista";case"NT 6.1":return"7";case"NT 6.2":return"8";case"NT 6.3":return"8.1";case"NT 10.0":return"10";default:return}},t.getMacOSVersionName=function(t){var e=t.split(".").splice(0,2).map((function(t){return parseInt(t,10)||0}));if(e.push(0),10===e[0])switch(e[1]){case 5:return"Leopard";case 6:return"Snow Leopard";case 7:return"Lion";case 8:return"Mountain Lion";case 9:return"Mavericks";case 10:return"Yosemite";case 11:return"El Capitan";case 12:return"Sierra";case 13:return"High Sierra";case 14:return"Mojave";case 15:return"Catalina";default:return}},t.getAndroidVersionName=function(t){var e=t.split(".").splice(0,2).map((function(t){return parseInt(t,10)||0}));if(e.push(0),!(1===e[0]&&e[1]<5))return 1===e[0]&&e[1]<6?"Cupcake":1===e[0]&&e[1]>=6?"Donut":2===e[0]&&e[1]<2?"Eclair":2===e[0]&&2===e[1]?"Froyo":2===e[0]&&e[1]>2?"Gingerbread":3===e[0]?"Honeycomb":4===e[0]&&e[1]<1?"Ice Cream Sandwich":4===e[0]&&e[1]<4?"Jelly Bean":4===e[0]&&e[1]>=4?"KitKat":5===e[0]?"Lollipop":6===e[0]?"Marshmallow":7===e[0]?"Nougat":8===e[0]?"Oreo":9===e[0]?"Pie":void 0},t.getVersionPrecision=function(t){return t.split(".").length},t.compareVersions=function(e,r,i){void 0===i&&(i=!1);var n=t.getVersionPrecision(e),s=t.getVersionPrecision(r),o=Math.max(n,s),a=0,u=t.map([e,r],(function(e){var r=o-t.getVersionPrecision(e),i=e+new Array(r+1).join(".0");return t.map(i.split("."),(function(t){return new Array(20-t.length).join("0")+t})).reverse()}));for(i&&(a=o-Math.min(n,s)),o-=1;o>=a;){if(u[0][o]>u[1][o])return 1;if(u[0][o]===u[1][o]){if(o===a)return 0;o-=1}else if(u[0][o]<u[1][o])return-1}},t.map=function(t,e){var r,i=[];if(Array.prototype.map)return Array.prototype.map.call(t,e);for(r=0;r<t.length;r+=1)i.push(e(t[r]));return i},t.find=function(t,e){var r,i;if(Array.prototype.find)return Array.prototype.find.call(t,e);for(r=0,i=t.length;r<i;r+=1){var n=t[r];if(e(n,r))return n}},t.assign=function(t){for(var e,r,i=t,n=arguments.length,s=new Array(n>1?n-1:0),o=1;o<n;o++)s[o-1]=arguments[o];if(Object.assign)return Object.assign.apply(Object,[t].concat(s));var a=function(){var t=s[e];"object"==typeof t&&null!==t&&Object.keys(t).forEach((function(e){i[e]=t[e]}))};for(e=0,r=s.length;e<r;e+=1)a();return t},t.getBrowserAlias=function(t){return i.BROWSER_ALIASES_MAP[t]},t.getBrowserTypeByAlias=function(t){return i.BROWSER_MAP[t]||""},t}();e.default=n,t.exports=e.default},18:function(t,e,r){"use strict";e.__esModule=!0,e.ENGINE_MAP=e.OS_MAP=e.PLATFORMS_MAP=e.BROWSER_MAP=e.BROWSER_ALIASES_MAP=void 0,e.BROWSER_ALIASES_MAP={"Amazon Silk":"amazon_silk","Android Browser":"android",Bada:"bada",BlackBerry:"blackberry",Chrome:"chrome",Chromium:"chromium",Electron:"electron",Epiphany:"epiphany",Firefox:"firefox",Focus:"focus",Generic:"generic","Google Search":"google_search",Googlebot:"googlebot","Internet Explorer":"ie","K-Meleon":"k_meleon",Maxthon:"maxthon","Microsoft Edge":"edge","MZ Browser":"mz","NAVER Whale Browser":"naver",Opera:"opera","Opera Coast":"opera_coast",PhantomJS:"phantomjs",Puffin:"puffin",QupZilla:"qupzilla",QQ:"qq",QQLite:"qqlite",Safari:"safari",Sailfish:"sailfish","Samsung Internet for Android":"samsung_internet",SeaMonkey:"seamonkey",Sleipnir:"sleipnir",Swing:"swing",Tizen:"tizen","UC Browser":"uc",Vivaldi:"vivaldi","WebOS Browser":"webos",WeChat:"wechat","Yandex Browser":"yandex",Roku:"roku"},e.BROWSER_MAP={amazon_silk:"Amazon Silk",android:"Android Browser",bada:"Bada",blackberry:"BlackBerry",chrome:"Chrome",chromium:"Chromium",electron:"Electron",epiphany:"Epiphany",firefox:"Firefox",focus:"Focus",generic:"Generic",googlebot:"Googlebot",google_search:"Google Search",ie:"Internet Explorer",k_meleon:"K-Meleon",maxthon:"Maxthon",edge:"Microsoft Edge",mz:"MZ Browser",naver:"NAVER Whale Browser",opera:"Opera",opera_coast:"Opera Coast",phantomjs:"PhantomJS",puffin:"Puffin",qupzilla:"QupZilla",qq:"QQ Browser",qqlite:"QQ Browser Lite",safari:"Safari",sailfish:"Sailfish",samsung_internet:"Samsung Internet for Android",seamonkey:"SeaMonkey",sleipnir:"Sleipnir",swing:"Swing",tizen:"Tizen",uc:"UC Browser",vivaldi:"Vivaldi",webos:"WebOS Browser",wechat:"WeChat",yandex:"Yandex Browser"},e.PLATFORMS_MAP={tablet:"tablet",mobile:"mobile",desktop:"desktop",tv:"tv"},e.OS_MAP={WindowsPhone:"Windows Phone",Windows:"Windows",MacOS:"macOS",iOS:"iOS",Android:"Android",WebOS:"WebOS",BlackBerry:"BlackBerry",Bada:"Bada",Tizen:"Tizen",Linux:"Linux",ChromeOS:"Chrome OS",PlayStation4:"PlayStation 4",Roku:"Roku"},e.ENGINE_MAP={EdgeHTML:"EdgeHTML",Blink:"Blink",Trident:"Trident",Presto:"Presto",Gecko:"Gecko",WebKit:"WebKit"}},90:function(t,e,r){"use strict";e.__esModule=!0,e.default=void 0;var i,n=(i=r(91))&&i.__esModule?i:{default:i},s=r(18);function o(t,e){for(var r=0;r<e.length;r++){var i=e[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var a=function(){function t(){}var e,r;return t.getParser=function(t,e){if(void 0===e&&(e=!1),"string"!=typeof t)throw new Error("UserAgent should be a string");return new n.default(t,e)},t.parse=function(t){return new n.default(t).getResult()},e=t,(r=[{key:"BROWSER_MAP",get:function(){return s.BROWSER_MAP}},{key:"ENGINE_MAP",get:function(){return s.ENGINE_MAP}},{key:"OS_MAP",get:function(){return s.OS_MAP}},{key:"PLATFORMS_MAP",get:function(){return s.PLATFORMS_MAP}}])&&o(e,r),t}();e.default=a,t.exports=e.default},91:function(t,e,r){"use strict";e.__esModule=!0,e.default=void 0;var i=u(r(92)),n=u(r(93)),s=u(r(94)),o=u(r(95)),a=u(r(17));function u(t){return t&&t.__esModule?t:{default:t}}var c=function(){function t(t,e){if(void 0===e&&(e=!1),null==t||""===t)throw new Error("UserAgent parameter can't be empty");this._ua=t,this.parsedResult={},!0!==e&&this.parse()}var e=t.prototype;return e.getUA=function(){return this._ua},e.test=function(t){return t.test(this._ua)},e.parseBrowser=function(){var t=this;this.parsedResult.browser={};var e=a.default.find(i.default,(function(e){if("function"==typeof e.test)return e.test(t);if(e.test instanceof Array)return e.test.some((function(e){return t.test(e)}));throw new Error("Browser's test function is not valid")}));return e&&(this.parsedResult.browser=e.describe(this.getUA())),this.parsedResult.browser},e.getBrowser=function(){return this.parsedResult.browser?this.parsedResult.browser:this.parseBrowser()},e.getBrowserName=function(t){return t?String(this.getBrowser().name).toLowerCase()||"":this.getBrowser().name||""},e.getBrowserVersion=function(){return this.getBrowser().version},e.getOS=function(){return this.parsedResult.os?this.parsedResult.os:this.parseOS()},e.parseOS=function(){var t=this;this.parsedResult.os={};var e=a.default.find(n.default,(function(e){if("function"==typeof e.test)return e.test(t);if(e.test instanceof Array)return e.test.some((function(e){return t.test(e)}));throw new Error("Browser's test function is not valid")}));return e&&(this.parsedResult.os=e.describe(this.getUA())),this.parsedResult.os},e.getOSName=function(t){var e=this.getOS().name;return t?String(e).toLowerCase()||"":e||""},e.getOSVersion=function(){return this.getOS().version},e.getPlatform=function(){return this.parsedResult.platform?this.parsedResult.platform:this.parsePlatform()},e.getPlatformType=function(t){void 0===t&&(t=!1);var e=this.getPlatform().type;return t?String(e).toLowerCase()||"":e||""},e.parsePlatform=function(){var t=this;this.parsedResult.platform={};var e=a.default.find(s.default,(function(e){if("function"==typeof e.test)return e.test(t);if(e.test instanceof Array)return e.test.some((function(e){return t.test(e)}));throw new Error("Browser's test function is not valid")}));return e&&(this.parsedResult.platform=e.describe(this.getUA())),this.parsedResult.platform},e.getEngine=function(){return this.parsedResult.engine?this.parsedResult.engine:this.parseEngine()},e.getEngineName=function(t){return t?String(this.getEngine().name).toLowerCase()||"":this.getEngine().name||""},e.parseEngine=function(){var t=this;this.parsedResult.engine={};var e=a.default.find(o.default,(function(e){if("function"==typeof e.test)return e.test(t);if(e.test instanceof Array)return e.test.some((function(e){return t.test(e)}));throw new Error("Browser's test function is not valid")}));return e&&(this.parsedResult.engine=e.describe(this.getUA())),this.parsedResult.engine},e.parse=function(){return this.parseBrowser(),this.parseOS(),this.parsePlatform(),this.parseEngine(),this},e.getResult=function(){return a.default.assign({},this.parsedResult)},e.satisfies=function(t){var e=this,r={},i=0,n={},s=0;if(Object.keys(t).forEach((function(e){var o=t[e];"string"==typeof o?(n[e]=o,s+=1):"object"==typeof o&&(r[e]=o,i+=1)})),i>0){var o=Object.keys(r),u=a.default.find(o,(function(t){return e.isOS(t)}));if(u){var c=this.satisfies(r[u]);if(void 0!==c)return c}var l=a.default.find(o,(function(t){return e.isPlatform(t)}));if(l){var h=this.satisfies(r[l]);if(void 0!==h)return h}}if(s>0){var d=Object.keys(n),p=a.default.find(d,(function(t){return e.isBrowser(t,!0)}));if(void 0!==p)return this.compareVersion(n[p])}},e.isBrowser=function(t,e){void 0===e&&(e=!1);var r=this.getBrowserName().toLowerCase(),i=t.toLowerCase(),n=a.default.getBrowserTypeByAlias(i);return e&&n&&(i=n.toLowerCase()),i===r},e.compareVersion=function(t){var e=[0],r=t,i=!1,n=this.getBrowserVersion();if("string"==typeof n)return">"===t[0]||"<"===t[0]?(r=t.substr(1),"="===t[1]?(i=!0,r=t.substr(2)):e=[],">"===t[0]?e.push(1):e.push(-1)):"="===t[0]?r=t.substr(1):"~"===t[0]&&(i=!0,r=t.substr(1)),e.indexOf(a.default.compareVersions(n,r,i))>-1},e.isOS=function(t){return this.getOSName(!0)===String(t).toLowerCase()},e.isPlatform=function(t){return this.getPlatformType(!0)===String(t).toLowerCase()},e.isEngine=function(t){return this.getEngineName(!0)===String(t).toLowerCase()},e.is=function(t,e){return void 0===e&&(e=!1),this.isBrowser(t,e)||this.isOS(t)||this.isPlatform(t)},e.some=function(t){var e=this;return void 0===t&&(t=[]),t.some((function(t){return e.is(t)}))},t}();e.default=c,t.exports=e.default},92:function(t,e,r){"use strict";e.__esModule=!0,e.default=void 0;var i,n=(i=r(17))&&i.__esModule?i:{default:i},s=/version\/(\d+(\.?_?\d+)+)/i,o=[{test:[/googlebot/i],describe:function(t){var e={name:"Googlebot"},r=n.default.getFirstMatch(/googlebot\/(\d+(\.\d+))/i,t)||n.default.getFirstMatch(s,t);return r&&(e.version=r),e}},{test:[/opera/i],describe:function(t){var e={name:"Opera"},r=n.default.getFirstMatch(s,t)||n.default.getFirstMatch(/(?:opera)[\s/](\d+(\.?_?\d+)+)/i,t);return r&&(e.version=r),e}},{test:[/opr\/|opios/i],describe:function(t){var e={name:"Opera"},r=n.default.getFirstMatch(/(?:opr|opios)[\s/](\S+)/i,t)||n.default.getFirstMatch(s,t);return r&&(e.version=r),e}},{test:[/SamsungBrowser/i],describe:function(t){var e={name:"Samsung Internet for Android"},r=n.default.getFirstMatch(s,t)||n.default.getFirstMatch(/(?:SamsungBrowser)[\s/](\d+(\.?_?\d+)+)/i,t);return r&&(e.version=r),e}},{test:[/Whale/i],describe:function(t){var e={name:"NAVER Whale Browser"},r=n.default.getFirstMatch(s,t)||n.default.getFirstMatch(/(?:whale)[\s/](\d+(?:\.\d+)+)/i,t);return r&&(e.version=r),e}},{test:[/MZBrowser/i],describe:function(t){var e={name:"MZ Browser"},r=n.default.getFirstMatch(/(?:MZBrowser)[\s/](\d+(?:\.\d+)+)/i,t)||n.default.getFirstMatch(s,t);return r&&(e.version=r),e}},{test:[/focus/i],describe:function(t){var e={name:"Focus"},r=n.default.getFirstMatch(/(?:focus)[\s/](\d+(?:\.\d+)+)/i,t)||n.default.getFirstMatch(s,t);return r&&(e.version=r),e}},{test:[/swing/i],describe:function(t){var e={name:"Swing"},r=n.default.getFirstMatch(/(?:swing)[\s/](\d+(?:\.\d+)+)/i,t)||n.default.getFirstMatch(s,t);return r&&(e.version=r),e}},{test:[/coast/i],describe:function(t){var e={name:"Opera Coast"},r=n.default.getFirstMatch(s,t)||n.default.getFirstMatch(/(?:coast)[\s/](\d+(\.?_?\d+)+)/i,t);return r&&(e.version=r),e}},{test:[/opt\/\d+(?:.?_?\d+)+/i],describe:function(t){var e={name:"Opera Touch"},r=n.default.getFirstMatch(/(?:opt)[\s/](\d+(\.?_?\d+)+)/i,t)||n.default.getFirstMatch(s,t);return r&&(e.version=r),e}},{test:[/yabrowser/i],describe:function(t){var e={name:"Yandex Browser"},r=n.default.getFirstMatch(/(?:yabrowser)[\s/](\d+(\.?_?\d+)+)/i,t)||n.default.getFirstMatch(s,t);return r&&(e.version=r),e}},{test:[/ucbrowser/i],describe:function(t){var e={name:"UC Browser"},r=n.default.getFirstMatch(s,t)||n.default.getFirstMatch(/(?:ucbrowser)[\s/](\d+(\.?_?\d+)+)/i,t);return r&&(e.version=r),e}},{test:[/Maxthon|mxios/i],describe:function(t){var e={name:"Maxthon"},r=n.default.getFirstMatch(s,t)||n.default.getFirstMatch(/(?:Maxthon|mxios)[\s/](\d+(\.?_?\d+)+)/i,t);return r&&(e.version=r),e}},{test:[/epiphany/i],describe:function(t){var e={name:"Epiphany"},r=n.default.getFirstMatch(s,t)||n.default.getFirstMatch(/(?:epiphany)[\s/](\d+(\.?_?\d+)+)/i,t);return r&&(e.version=r),e}},{test:[/puffin/i],describe:function(t){var e={name:"Puffin"},r=n.default.getFirstMatch(s,t)||n.default.getFirstMatch(/(?:puffin)[\s/](\d+(\.?_?\d+)+)/i,t);return r&&(e.version=r),e}},{test:[/sleipnir/i],describe:function(t){var e={name:"Sleipnir"},r=n.default.getFirstMatch(s,t)||n.default.getFirstMatch(/(?:sleipnir)[\s/](\d+(\.?_?\d+)+)/i,t);return r&&(e.version=r),e}},{test:[/k-meleon/i],describe:function(t){var e={name:"K-Meleon"},r=n.default.getFirstMatch(s,t)||n.default.getFirstMatch(/(?:k-meleon)[\s/](\d+(\.?_?\d+)+)/i,t);return r&&(e.version=r),e}},{test:[/micromessenger/i],describe:function(t){var e={name:"WeChat"},r=n.default.getFirstMatch(/(?:micromessenger)[\s/](\d+(\.?_?\d+)+)/i,t)||n.default.getFirstMatch(s,t);return r&&(e.version=r),e}},{test:[/qqbrowser/i],describe:function(t){var e={name:/qqbrowserlite/i.test(t)?"QQ Browser Lite":"QQ Browser"},r=n.default.getFirstMatch(/(?:qqbrowserlite|qqbrowser)[/](\d+(\.?_?\d+)+)/i,t)||n.default.getFirstMatch(s,t);return r&&(e.version=r),e}},{test:[/msie|trident/i],describe:function(t){var e={name:"Internet Explorer"},r=n.default.getFirstMatch(/(?:msie |rv:)(\d+(\.?_?\d+)+)/i,t);return r&&(e.version=r),e}},{test:[/\sedg\//i],describe:function(t){var e={name:"Microsoft Edge"},r=n.default.getFirstMatch(/\sedg\/(\d+(\.?_?\d+)+)/i,t);return r&&(e.version=r),e}},{test:[/edg([ea]|ios)/i],describe:function(t){var e={name:"Microsoft Edge"},r=n.default.getSecondMatch(/edg([ea]|ios)\/(\d+(\.?_?\d+)+)/i,t);return r&&(e.version=r),e}},{test:[/vivaldi/i],describe:function(t){var e={name:"Vivaldi"},r=n.default.getFirstMatch(/vivaldi\/(\d+(\.?_?\d+)+)/i,t);return r&&(e.version=r),e}},{test:[/seamonkey/i],describe:function(t){var e={name:"SeaMonkey"},r=n.default.getFirstMatch(/seamonkey\/(\d+(\.?_?\d+)+)/i,t);return r&&(e.version=r),e}},{test:[/sailfish/i],describe:function(t){var e={name:"Sailfish"},r=n.default.getFirstMatch(/sailfish\s?browser\/(\d+(\.\d+)?)/i,t);return r&&(e.version=r),e}},{test:[/silk/i],describe:function(t){var e={name:"Amazon Silk"},r=n.default.getFirstMatch(/silk\/(\d+(\.?_?\d+)+)/i,t);return r&&(e.version=r),e}},{test:[/phantom/i],describe:function(t){var e={name:"PhantomJS"},r=n.default.getFirstMatch(/phantomjs\/(\d+(\.?_?\d+)+)/i,t);return r&&(e.version=r),e}},{test:[/slimerjs/i],describe:function(t){var e={name:"SlimerJS"},r=n.default.getFirstMatch(/slimerjs\/(\d+(\.?_?\d+)+)/i,t);return r&&(e.version=r),e}},{test:[/blackberry|\bbb\d+/i,/rim\stablet/i],describe:function(t){var e={name:"BlackBerry"},r=n.default.getFirstMatch(s,t)||n.default.getFirstMatch(/blackberry[\d]+\/(\d+(\.?_?\d+)+)/i,t);return r&&(e.version=r),e}},{test:[/(web|hpw)[o0]s/i],describe:function(t){var e={name:"WebOS Browser"},r=n.default.getFirstMatch(s,t)||n.default.getFirstMatch(/w(?:eb)?[o0]sbrowser\/(\d+(\.?_?\d+)+)/i,t);return r&&(e.version=r),e}},{test:[/bada/i],describe:function(t){var e={name:"Bada"},r=n.default.getFirstMatch(/dolfin\/(\d+(\.?_?\d+)+)/i,t);return r&&(e.version=r),e}},{test:[/tizen/i],describe:function(t){var e={name:"Tizen"},r=n.default.getFirstMatch(/(?:tizen\s?)?browser\/(\d+(\.?_?\d+)+)/i,t)||n.default.getFirstMatch(s,t);return r&&(e.version=r),e}},{test:[/qupzilla/i],describe:function(t){var e={name:"QupZilla"},r=n.default.getFirstMatch(/(?:qupzilla)[\s/](\d+(\.?_?\d+)+)/i,t)||n.default.getFirstMatch(s,t);return r&&(e.version=r),e}},{test:[/firefox|iceweasel|fxios/i],describe:function(t){var e={name:"Firefox"},r=n.default.getFirstMatch(/(?:firefox|iceweasel|fxios)[\s/](\d+(\.?_?\d+)+)/i,t);return r&&(e.version=r),e}},{test:[/electron/i],describe:function(t){var e={name:"Electron"},r=n.default.getFirstMatch(/(?:electron)\/(\d+(\.?_?\d+)+)/i,t);return r&&(e.version=r),e}},{test:[/MiuiBrowser/i],describe:function(t){var e={name:"Miui"},r=n.default.getFirstMatch(/(?:MiuiBrowser)[\s/](\d+(\.?_?\d+)+)/i,t);return r&&(e.version=r),e}},{test:[/chromium/i],describe:function(t){var e={name:"Chromium"},r=n.default.getFirstMatch(/(?:chromium)[\s/](\d+(\.?_?\d+)+)/i,t)||n.default.getFirstMatch(s,t);return r&&(e.version=r),e}},{test:[/chrome|crios|crmo/i],describe:function(t){var e={name:"Chrome"},r=n.default.getFirstMatch(/(?:chrome|crios|crmo)\/(\d+(\.?_?\d+)+)/i,t);return r&&(e.version=r),e}},{test:[/GSA/i],describe:function(t){var e={name:"Google Search"},r=n.default.getFirstMatch(/(?:GSA)\/(\d+(\.?_?\d+)+)/i,t);return r&&(e.version=r),e}},{test:function(t){var e=!t.test(/like android/i),r=t.test(/android/i);return e&&r},describe:function(t){var e={name:"Android Browser"},r=n.default.getFirstMatch(s,t);return r&&(e.version=r),e}},{test:[/playstation 4/i],describe:function(t){var e={name:"PlayStation 4"},r=n.default.getFirstMatch(s,t);return r&&(e.version=r),e}},{test:[/safari|applewebkit/i],describe:function(t){var e={name:"Safari"},r=n.default.getFirstMatch(s,t);return r&&(e.version=r),e}},{test:[/.*/i],describe:function(t){var e=-1!==t.search("\\(")?/^(.*)\/(.*)[ \t]\((.*)/:/^(.*)\/(.*) /;return{name:n.default.getFirstMatch(e,t),version:n.default.getSecondMatch(e,t)}}}];e.default=o,t.exports=e.default},93:function(t,e,r){"use strict";e.__esModule=!0,e.default=void 0;var i,n=(i=r(17))&&i.__esModule?i:{default:i},s=r(18),o=[{test:[/Roku\/DVP/],describe:function(t){var e=n.default.getFirstMatch(/Roku\/DVP-(\d+\.\d+)/i,t);return{name:s.OS_MAP.Roku,version:e}}},{test:[/windows phone/i],describe:function(t){var e=n.default.getFirstMatch(/windows phone (?:os)?\s?(\d+(\.\d+)*)/i,t);return{name:s.OS_MAP.WindowsPhone,version:e}}},{test:[/windows /i],describe:function(t){var e=n.default.getFirstMatch(/Windows ((NT|XP)( \d\d?.\d)?)/i,t),r=n.default.getWindowsVersionName(e);return{name:s.OS_MAP.Windows,version:e,versionName:r}}},{test:[/Macintosh(.*?) FxiOS(.*?)\//],describe:function(t){var e={name:s.OS_MAP.iOS},r=n.default.getSecondMatch(/(Version\/)(\d[\d.]+)/,t);return r&&(e.version=r),e}},{test:[/macintosh/i],describe:function(t){var e=n.default.getFirstMatch(/mac os x (\d+(\.?_?\d+)+)/i,t).replace(/[_\s]/g,"."),r=n.default.getMacOSVersionName(e),i={name:s.OS_MAP.MacOS,version:e};return r&&(i.versionName=r),i}},{test:[/(ipod|iphone|ipad)/i],describe:function(t){var e=n.default.getFirstMatch(/os (\d+([_\s]\d+)*) like mac os x/i,t).replace(/[_\s]/g,".");return{name:s.OS_MAP.iOS,version:e}}},{test:function(t){var e=!t.test(/like android/i),r=t.test(/android/i);return e&&r},describe:function(t){var e=n.default.getFirstMatch(/android[\s/-](\d+(\.\d+)*)/i,t),r=n.default.getAndroidVersionName(e),i={name:s.OS_MAP.Android,version:e};return r&&(i.versionName=r),i}},{test:[/(web|hpw)[o0]s/i],describe:function(t){var e=n.default.getFirstMatch(/(?:web|hpw)[o0]s\/(\d+(\.\d+)*)/i,t),r={name:s.OS_MAP.WebOS};return e&&e.length&&(r.version=e),r}},{test:[/blackberry|\bbb\d+/i,/rim\stablet/i],describe:function(t){var e=n.default.getFirstMatch(/rim\stablet\sos\s(\d+(\.\d+)*)/i,t)||n.default.getFirstMatch(/blackberry\d+\/(\d+([_\s]\d+)*)/i,t)||n.default.getFirstMatch(/\bbb(\d+)/i,t);return{name:s.OS_MAP.BlackBerry,version:e}}},{test:[/bada/i],describe:function(t){var e=n.default.getFirstMatch(/bada\/(\d+(\.\d+)*)/i,t);return{name:s.OS_MAP.Bada,version:e}}},{test:[/tizen/i],describe:function(t){var e=n.default.getFirstMatch(/tizen[/\s](\d+(\.\d+)*)/i,t);return{name:s.OS_MAP.Tizen,version:e}}},{test:[/linux/i],describe:function(){return{name:s.OS_MAP.Linux}}},{test:[/CrOS/],describe:function(){return{name:s.OS_MAP.ChromeOS}}},{test:[/PlayStation 4/],describe:function(t){var e=n.default.getFirstMatch(/PlayStation 4[/\s](\d+(\.\d+)*)/i,t);return{name:s.OS_MAP.PlayStation4,version:e}}}];e.default=o,t.exports=e.default},94:function(t,e,r){"use strict";e.__esModule=!0,e.default=void 0;var i,n=(i=r(17))&&i.__esModule?i:{default:i},s=r(18),o=[{test:[/googlebot/i],describe:function(){return{type:"bot",vendor:"Google"}}},{test:[/huawei/i],describe:function(t){var e=n.default.getFirstMatch(/(can-l01)/i,t)&&"Nova",r={type:s.PLATFORMS_MAP.mobile,vendor:"Huawei"};return e&&(r.model=e),r}},{test:[/nexus\s*(?:7|8|9|10).*/i],describe:function(){return{type:s.PLATFORMS_MAP.tablet,vendor:"Nexus"}}},{test:[/ipad/i],describe:function(){return{type:s.PLATFORMS_MAP.tablet,vendor:"Apple",model:"iPad"}}},{test:[/Macintosh(.*?) FxiOS(.*?)\//],describe:function(){return{type:s.PLATFORMS_MAP.tablet,vendor:"Apple",model:"iPad"}}},{test:[/kftt build/i],describe:function(){return{type:s.PLATFORMS_MAP.tablet,vendor:"Amazon",model:"Kindle Fire HD 7"}}},{test:[/silk/i],describe:function(){return{type:s.PLATFORMS_MAP.tablet,vendor:"Amazon"}}},{test:[/tablet(?! pc)/i],describe:function(){return{type:s.PLATFORMS_MAP.tablet}}},{test:function(t){var e=t.test(/ipod|iphone/i),r=t.test(/like (ipod|iphone)/i);return e&&!r},describe:function(t){var e=n.default.getFirstMatch(/(ipod|iphone)/i,t);return{type:s.PLATFORMS_MAP.mobile,vendor:"Apple",model:e}}},{test:[/nexus\s*[0-6].*/i,/galaxy nexus/i],describe:function(){return{type:s.PLATFORMS_MAP.mobile,vendor:"Nexus"}}},{test:[/[^-]mobi/i],describe:function(){return{type:s.PLATFORMS_MAP.mobile}}},{test:function(t){return"blackberry"===t.getBrowserName(!0)},describe:function(){return{type:s.PLATFORMS_MAP.mobile,vendor:"BlackBerry"}}},{test:function(t){return"bada"===t.getBrowserName(!0)},describe:function(){return{type:s.PLATFORMS_MAP.mobile}}},{test:function(t){return"windows phone"===t.getBrowserName()},describe:function(){return{type:s.PLATFORMS_MAP.mobile,vendor:"Microsoft"}}},{test:function(t){var e=Number(String(t.getOSVersion()).split(".")[0]);return"android"===t.getOSName(!0)&&e>=3},describe:function(){return{type:s.PLATFORMS_MAP.tablet}}},{test:function(t){return"android"===t.getOSName(!0)},describe:function(){return{type:s.PLATFORMS_MAP.mobile}}},{test:function(t){return"macos"===t.getOSName(!0)},describe:function(){return{type:s.PLATFORMS_MAP.desktop,vendor:"Apple"}}},{test:function(t){return"windows"===t.getOSName(!0)},describe:function(){return{type:s.PLATFORMS_MAP.desktop}}},{test:function(t){return"linux"===t.getOSName(!0)},describe:function(){return{type:s.PLATFORMS_MAP.desktop}}},{test:function(t){return"playstation 4"===t.getOSName(!0)},describe:function(){return{type:s.PLATFORMS_MAP.tv}}},{test:function(t){return"roku"===t.getOSName(!0)},describe:function(){return{type:s.PLATFORMS_MAP.tv}}}];e.default=o,t.exports=e.default},95:function(t,e,r){"use strict";e.__esModule=!0,e.default=void 0;var i,n=(i=r(17))&&i.__esModule?i:{default:i},s=r(18),o=[{test:function(t){return"microsoft edge"===t.getBrowserName(!0)},describe:function(t){if(/\sedg\//i.test(t))return{name:s.ENGINE_MAP.Blink};var e=n.default.getFirstMatch(/edge\/(\d+(\.?_?\d+)+)/i,t);return{name:s.ENGINE_MAP.EdgeHTML,version:e}}},{test:[/trident/i],describe:function(t){var e={name:s.ENGINE_MAP.Trident},r=n.default.getFirstMatch(/trident\/(\d+(\.?_?\d+)+)/i,t);return r&&(e.version=r),e}},{test:function(t){return t.test(/presto/i)},describe:function(t){var e={name:s.ENGINE_MAP.Presto},r=n.default.getFirstMatch(/presto\/(\d+(\.?_?\d+)+)/i,t);return r&&(e.version=r),e}},{test:function(t){var e=t.test(/gecko/i),r=t.test(/like gecko/i);return e&&!r},describe:function(t){var e={name:s.ENGINE_MAP.Gecko},r=n.default.getFirstMatch(/gecko\/(\d+(\.?_?\d+)+)/i,t);return r&&(e.version=r),e}},{test:[/(apple)?webkit\/537\.36/i],describe:function(){return{name:s.ENGINE_MAP.Blink}}},{test:[/(apple)?webkit/i],describe:function(t){var e={name:s.ENGINE_MAP.WebKit},r=n.default.getFirstMatch(/webkit\/(\d+(\.?_?\d+)+)/i,t);return r&&(e.version=r),e}}];e.default=o,t.exports=e.default}})},function(t,e,r){var i=r(1),n=r(34).f,s=r(9),o=r(13),a=r(24),u=r(67),c=r(73);t.exports=function(t,e){var r,l,h,d,p,f=t.target,m=t.global,g=t.stat;if(r=m?i:g?i[f]||a(f,{}):(i[f]||{}).prototype)for(l in e){if(d=e[l],h=t.noTargetGet?(p=n(r,l))&&p.value:r[l],!c(m?l:f+(g?".":"#")+l,t.forced)&&void 0!==h){if(typeof d==typeof h)continue;u(d,h)}(t.sham||h&&h.sham)&&s(d,"sham",!0),o(r,l,d,t)}}},function(t,e,r){var i=r(36),n=r(22);t.exports=function(t){return i(n(t))}},function(t,e){t.exports=!1},function(t,e,r){var i=r(10).f,n=r(2),s=r(3)("toStringTag");t.exports=function(t,e,r){t&&!n(t=r?t:t.prototype,s)&&i(t,s,{configurable:!0,value:e})}},function(t,e){t.exports=function(t){if(null==t)throw TypeError("Can't call method on "+t);return t}},function(t,e,r){var i=r(8);t.exports=function(t,e){if(!i(t))return t;var r,n;if(e&&"function"==typeof(r=t.toString)&&!i(n=r.call(t)))return n;if("function"==typeof(r=t.valueOf)&&!i(n=r.call(t)))return n;if(!e&&"function"==typeof(r=t.toString)&&!i(n=r.call(t)))return n;throw TypeError("Can't convert object to primitive value")}},function(t,e,r){var i=r(1),n=r(9);t.exports=function(t,e){try{n(i,t,e)}catch(r){i[t]=e}return e}},function(t,e,r){var i=r(1),n=r(24),s=i["__core-js_shared__"]||n("__core-js_shared__",{});t.exports=s},function(t,e,r){var i=r(41),n=r(42),s=i("keys");t.exports=function(t){return s[t]||(s[t]=n(t))}},function(t,e){t.exports={}},function(t,e,r){var i=r(69),n=r(1),s=function(t){return"function"==typeof t?t:void 0};t.exports=function(t,e){return arguments.length<2?s(i[t])||s(n[t]):i[t]&&i[t][e]||n[t]&&n[t][e]}},function(t,e){var r=Math.ceil,i=Math.floor;t.exports=function(t){return isNaN(t=+t)?0:(t>0?i:r)(t)}},function(t,e){t.exports=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]},function(t,e,r){var i=r(22);t.exports=function(t){return Object(i(t))}},function(t,e,r){var i,n=r(5),s=r(54),o=r(30),a=r(27),u=r(92),c=r(39),l=r(26),h=l("IE_PROTO"),d=function(){},p=function(t){return"<script>"+t+"<\/script>"},f=function(){try{i=document.domain&&new ActiveXObject("htmlfile")}catch(t){}var t,e;f=i?function(t){t.write(p("")),t.close();var e=t.parentWindow.Object;return t=null,e}(i):((e=c("iframe")).style.display="none",u.appendChild(e),e.src=String("javascript:"),(t=e.contentWindow.document).open(),t.write(p("document.F=Object")),t.close(),t.F);for(var r=o.length;r--;)delete f.prototype[o[r]];return f()};a[h]=!0,t.exports=Object.create||function(t,e){var r;return null!==t?(d.prototype=n(t),r=new d,d.prototype=null,r[h]=t):r=f(),void 0===e?r:s(r,e)}},function(t,e,r){var i=r(59),n=r(15),s=r(3)("iterator");t.exports=function(t){if(null!=t)return t[s]||t["@@iterator"]||n[i(t)]}},function(t,e,r){var i=r(7),n=r(35),s=r(12),o=r(19),a=r(23),u=r(2),c=r(38),l=Object.getOwnPropertyDescriptor;e.f=i?l:function(t,e){if(t=o(t),e=a(e,!0),c)try{return l(t,e)}catch(t){}if(u(t,e))return s(!n.f.call(t,e),t[e])}},function(t,e,r){"use strict";var i={}.propertyIsEnumerable,n=Object.getOwnPropertyDescriptor,s=n&&!i.call({1:2},1);e.f=s?function(t){var e=n(this,t);return!!e&&e.enumerable}:i},function(t,e,r){var i=r(4),n=r(37),s="".split;t.exports=i((function(){return!Object("z").propertyIsEnumerable(0)}))?function(t){return"String"==n(t)?s.call(t,""):Object(t)}:Object},function(t,e){var r={}.toString;t.exports=function(t){return r.call(t).slice(8,-1)}},function(t,e,r){var i=r(7),n=r(4),s=r(39);t.exports=!i&&!n((function(){return 7!=Object.defineProperty(s("div"),"a",{get:function(){return 7}}).a}))},function(t,e,r){var i=r(1),n=r(8),s=i.document,o=n(s)&&n(s.createElement);t.exports=function(t){return o?s.createElement(t):{}}},function(t,e,r){var i=r(25),n=Function.toString;"function"!=typeof i.inspectSource&&(i.inspectSource=function(t){return n.call(t)}),t.exports=i.inspectSource},function(t,e,r){var i=r(20),n=r(25);(t.exports=function(t,e){return n[t]||(n[t]=void 0!==e?e:{})})("versions",[]).push({version:"3.8.3",mode:i?"pure":"global",copyright:" 2021 Denis Pushkarev (zloirock.ru)"})},function(t,e){var r=0,i=Math.random();t.exports=function(t){return"Symbol("+String(void 0===t?"":t)+")_"+(++r+i).toString(36)}},function(t,e,r){var i=r(2),n=r(19),s=r(71).indexOf,o=r(27);t.exports=function(t,e){var r,a=n(t),u=0,c=[];for(r in a)!i(o,r)&&i(a,r)&&c.push(r);for(;e.length>u;)i(a,r=e[u++])&&(~s(c,r)||c.push(r));return c}},function(t,e,r){var i=r(29),n=Math.min;t.exports=function(t){return t>0?n(i(t),9007199254740991):0}},function(t,e){e.f=Object.getOwnPropertySymbols},function(t,e,r){"use strict";r.r(e),r.d(e,"get",(function(){return u})),r.d(e,"set",(function(){return c}));var i=Object.prototype.toString,n=Array.isArray||function(t){return"[object Array]"===i.call(t)};function s(t){var e=parseInt(t);return e.toString()===t?e:t}function o(t,e){return"number"==typeof e&&n(t)||function(t,e){return null!=t&&Object.prototype.hasOwnProperty.call(t,e)}(t,e)}function a(t,e){if(o(t,e))return t[e]}function u(t,e,r){if("number"==typeof e&&(e=[e]),!e||0===e.length)return t;if(null==t)return r;if("string"==typeof e)return u(t,e.split("."),r);var i=s(e[0]),n=a(t,i);return void 0===n?r:1===e.length?n:u(t[i],e.slice(1),r)}function c(t,e,r){if("number"==typeof e&&(e=[e]),!e||0===e.length)return t;if("string"==typeof e)return c(t,e.split(".").map(s),r);var i=e[0],n=a(t,i);return 1===e.length?(t[i]=r,n):(void 0===n&&(t[i]="number"==typeof e[1]?[]:{}),c(t[i],e.slice(1),r))}},function(t,e,r){t.exports=r.p+"assets/img/image_default.be0698b.png"},function(t,e,r){var i=r(29),n=r(22),s=function(t){return function(e,r){var s,o,a=String(n(e)),u=i(r),c=a.length;return u<0||u>=c?t?"":void 0:(s=a.charCodeAt(u))<55296||s>56319||u+1===c||(o=a.charCodeAt(u+1))<56320||o>57343?t?a.charAt(u):s:t?a.slice(u,u+2):o-56320+(s-55296<<10)+65536}};t.exports={codeAt:s(!1),charAt:s(!0)}},function(t,e,r){"use strict";var i=r(18),n=r(50),s=r(52),o=r(93),a=r(21),u=r(9),c=r(13),l=r(3),h=r(20),d=r(15),p=r(51),f=p.IteratorPrototype,m=p.BUGGY_SAFARI_ITERATORS,g=l("iterator"),v=function(){return this};t.exports=function(t,e,r,l,p,y,_){n(r,e,l);var b,w,k,S=function(t){if(t===p&&F)return F;if(!m&&t in A)return A[t];switch(t){case"keys":case"values":case"entries":return function(){return new r(this,t)}}return function(){return new r(this)}},x=e+" Iterator",M=!1,A=t.prototype,C=A[g]||A["@@iterator"]||p&&A[p],F=!m&&C||S(p),O="Array"==e&&A.entries||C;if(O&&(b=s(O.call(new t)),f!==Object.prototype&&b.next&&(h||s(b)===f||(o?o(b,f):"function"!=typeof b[g]&&u(b,g,v)),a(b,x,!0,!0),h&&(d[x]=v))),"values"==p&&C&&"values"!==C.name&&(M=!0,F=function(){return C.call(this)}),h&&!_||A[g]===F||u(A,g,F),d[e]=F,p)if(w={values:S("values"),keys:y?F:S("keys"),entries:S("entries")},_)for(k in w)(m||M||!(k in A))&&c(A,k,w[k]);else i({target:e,proto:!0,forced:m||M},w);return w}},function(t,e,r){"use strict";var i=r(51).IteratorPrototype,n=r(32),s=r(12),o=r(21),a=r(15),u=function(){return this};t.exports=function(t,e,r){var c=e+" Iterator";return t.prototype=n(i,{next:s(1,r)}),o(t,c,!1,!0),a[c]=u,t}},function(t,e,r){"use strict";var i,n,s,o=r(4),a=r(52),u=r(9),c=r(2),l=r(3),h=r(20),d=l("iterator"),p=!1;[].keys&&("next"in(s=[].keys())?(n=a(a(s)))!==Object.prototype&&(i=n):p=!0);var f=null==i||o((function(){var t={};return i[d].call(t)!==t}));f&&(i={}),h&&!f||c(i,d)||u(i,d,(function(){return this})),t.exports={IteratorPrototype:i,BUGGY_SAFARI_ITERATORS:p}},function(t,e,r){var i=r(2),n=r(31),s=r(26),o=r(90),a=s("IE_PROTO"),u=Object.prototype;t.exports=o?Object.getPrototypeOf:function(t){return t=n(t),i(t,a)?t[a]:"function"==typeof t.constructor&&t instanceof t.constructor?t.constructor.prototype:t instanceof Object?u:null}},function(t,e,r){var i=r(4);t.exports=!!Object.getOwnPropertySymbols&&!i((function(){return!String(Symbol())}))},function(t,e,r){var i=r(7),n=r(10),s=r(5),o=r(55);t.exports=i?Object.defineProperties:function(t,e){s(t);for(var r,i=o(e),a=i.length,u=0;a>u;)n.f(t,r=i[u++],e[r]);return t}},function(t,e,r){var i=r(43),n=r(30);t.exports=Object.keys||function(t){return i(t,n)}},function(t,e,r){var i=r(4),n=r(3),s=r(20),o=n("iterator");t.exports=!i((function(){var t=new URL("b?a=1&b=2&c=3","http://a"),e=t.searchParams,r="";return t.pathname="c%20d",e.forEach((function(t,i){e.delete("b"),r+=i+t})),s&&!t.toJSON||!e.sort||"http://a/c%20d?a=1&c=3"!==t.href||"3"!==e.get("c")||"a=1"!==String(new URLSearchParams("?a=1"))||!e[o]||"a"!==new URL("https://a@b").username||"b"!==new URLSearchParams(new URLSearchParams("a=b")).get("a")||"xn--e1aybc"!==new URL("http://").host||"#%D0%B1"!==new URL("http://a#").hash||"a1c3"!==r||"x"!==new URL("http://x",void 0).host}))},function(t,e){t.exports=function(t,e,r){if(!(t instanceof e))throw TypeError("Incorrect "+(r?r+" ":"")+"invocation");return t}},function(t,e,r){var i=r(97);t.exports=function(t,e,r){if(i(t),void 0===e)return t;switch(r){case 0:return function(){return t.call(e)};case 1:return function(r){return t.call(e,r)};case 2:return function(r,i){return t.call(e,r,i)};case 3:return function(r,i,n){return t.call(e,r,i,n)}}return function(){return t.apply(e,arguments)}}},function(t,e,r){var i=r(102),n=r(37),s=r(3)("toStringTag"),o="Arguments"==n(function(){return arguments}());t.exports=i?n:function(t){var e,r,i;return void 0===t?"Undefined":null===t?"Null":"string"==typeof(r=function(t,e){try{return t[e]}catch(t){}}(e=Object(t),s))?r:o?n(e):"Object"==(i=n(e))&&"function"==typeof e.callee?"Arguments":i}},function(t,e,r){var i=r(109),n=r(61),s=r(110),o=r(112);t.exports={sleep:i,loop:n,map:s,batch:o}},function(t,e){t.exports=function t(e){var r=e();if(!r||!r.then){var i=r;r={then:function(t){t(i)}}}return r.then((function(r){return r?t(e):Promise.resolve()}))}},function(t,e,r){"use strict";r.r(e);var i={},n={};i.length=0,i.getItem=function(t){return t in n?n[t]:null},i.setItem=function(t,e){void 0===e?i.removeItem(t):n[t]=""+e,i.length=Object.keys(n).length},i.removeItem=function(t){Object.prototype.hasOwnProperty.call(n,t)&&(delete n[t],i.length=Object.keys(n).length)},i.key=function(t){return Object.keys(n)[t]||null},i.clear=function(){n={},i.length=0},e.default=i},function(t,e,r){var i=r(116);function n(t,e){return Object.assign(t.clone(),e)}var s=function(t,e){var r=i.stringify(t.query);r&&(r="?"+r);var n=new h.XMLHttpRequest;for(var s in n.onreadystatechange=function(t){4===n.readyState&&(0===n.status?e("network_error",n.responseText,n.status):e(void 0,n.responseText,n.status))},n.open(t.method,t.baseurl+r),t.headers)n.setRequestHeader(s,t.headers[s]);t.content_type&&n.setRequestHeader("Content-Type",t.content_type),n.send(t.body)};function o(t){return(t||"").trim()}function a(t){return t&&"[object Function]"==={}.toString.call(t)}function u(t,e,r){if(!t||0===t.length)return r(e);var i=t.shift();if(!a(i))return u(t,e,r);i(e,(function(i){return!1===i?r(e):u(t,e,r)}))}var c,l=(c={parser:"",beforehooks:[],afterhooks:[],baseurl:"",query:{},meta:{},clone:function(){return Object.assign({},this,{query:Object.assign({},this.query),meta:Object.assign({},this.meta)})},addQuery:function(t,e){var r=this.clone();return r.query[t]=e,r},removeQuery:function(t){var e=this.clone();return void 0!==e.query[t]&&(e.query[t]=void 0),e},setQuery:function(t){return n(this,{query:t})},clearHooks:function(){return n(this,{beforehooks:[],afterhooks:[]})},beforeHook:function(t){var e=this.beforehooks.slice();return e.push(t),n(this,{beforehooks:e})},afterHook:function(t){var e=this.afterhooks.slice();return e.push(t),n(this,{afterhooks:e})},setHeader:function(t){return(t=Object.assign({},this.headers,t))["Content-Type"]=void 0,n(this,{headers:t})}},["put","head","patch","delete","post","get"].map((function(t){c[t]=function(e,r,c){return function(t,e,r){r=r||function(){},a(e)&&(r=e,e=void 0);var n,o=new Promise((function(t){n=function(e){try{r(e.error,e.body,e.code)}catch(t){}t(e)}}));return e&&((t=t.clone()).body=e,"application/json; charset=utf-8"===t.content_type&&(t.body=h.Jsonify(e)),"application/x-www-form-urlencoded"===t.content_type&&(t.body=i.stringify(e))),u(t.beforehooks.slice(),{request:t},(function(e){if(e.error)return n({body:void 0,code:0,error:e.error});s(e.request,(function(e,r,i){u(t.afterhooks.slice(),{request:t,code:i,body:r,err:e},(function(e){var r=e.body;if("json"==t.parser&&e.body)try{r=h.ParseJson(e.body)}catch(t){e.err=e.err||"invalid json"}var s=e.err;200!==i&&(s="not 200"),n({body:r,code:e.code,error:s})}))}))})),o}(n(this,{method:t,baseurl:(l=this.baseurl,d=e,l=o(l),(d=o(d))&&l?d.startsWith("http://")||d.startsWith("https://")||d.startsWith("//")?d:(l.endsWith("/")||(l+="/"),d.startsWith("/")&&(d=d.substring(1)),l+d):l+d)}),r,c);var l,d}})),c.setBaseUrl=function(t){return n(this,{baseurl:t})},c.contentTypeJson=function(){return n(this,{content_type:"application/json; charset=utf-8"})},c.contentTypeForm=function(){return n(this,{content_type:"application/x-www-form-urlencoded"})},c.setContentType=function(t){return n(this,{content_type:o(t)})},c.setParser=function(t){return n(this,{parser:o(t)})},c.setBody=function(t){return n(this,{body:t})},c.setMeta=function(t,e){var r=this.clone();return r.meta[t]=e,r},c),h={XMLHttpRequest:{},Jsonify:JSON.stringify,ParseJson:JSON.parse};l.env=h,l.waterfall=u,t.exports=l},function(t,e,r){"use strict";r(18)({target:"URL",proto:!0,enumerable:!0},{toJSON:function(){return URL.prototype.toString.call(this)}})},function(t,e){var r;r=function(){return this}();try{r=r||new Function("return this")()}catch(t){"object"==typeof window&&(r=window)}t.exports=r},function(t,e,r){var i=r(1),n=r(40),s=i.WeakMap;t.exports="function"==typeof s&&/native code/.test(n(s))},function(t,e,r){var i=r(2),n=r(68),s=r(34),o=r(10);t.exports=function(t,e){for(var r=n(e),a=o.f,u=s.f,c=0;c<r.length;c++){var l=r[c];i(t,l)||a(t,l,u(e,l))}}},function(t,e,r){var i=r(28),n=r(70),s=r(45),o=r(5);t.exports=i("Reflect","ownKeys")||function(t){var e=n.f(o(t)),r=s.f;return r?e.concat(r(t)):e}},function(t,e,r){var i=r(1);t.exports=i},function(t,e,r){var i=r(43),n=r(30).concat("length","prototype");e.f=Object.getOwnPropertyNames||function(t){return i(t,n)}},function(t,e,r){var i=r(19),n=r(44),s=r(72),o=function(t){return function(e,r,o){var a,u=i(e),c=n(u.length),l=s(o,c);if(t&&r!=r){for(;c>l;)if((a=u[l++])!=a)return!0}else for(;c>l;l++)if((t||l in u)&&u[l]===r)return t||l||0;return!t&&-1}};t.exports={includes:o(!0),indexOf:o(!1)}},function(t,e,r){var i=r(29),n=Math.max,s=Math.min;t.exports=function(t,e){var r=i(t);return r<0?n(r+e,0):s(r,e)}},function(t,e,r){var i=r(4),n=/#|\.prototype\./,s=function(t,e){var r=a[o(t)];return r==c||r!=u&&("function"==typeof e?i(e):!!e)},o=s.normalize=function(t){return String(t).replace(n,".").toLowerCase()},a=s.data={},u=s.NATIVE="N",c=s.POLYFILL="P";t.exports=s},function(t,e,r){"use strict";r.r(e),r.d(e,"default",(function(){return i}));class i{constructor(t){this.isOpen=!0===t,this.cbs=[]}open(){this.isOpen=!0;let t=[];this.cbs.forEach(e=>{this.isOpen?e():t.push(e)}),this.cbs=t}close(){this.isOpen=!1}entry(t,e){return this.isOpen?(e&&(this.isOpen=!1),t&&t(),Promise.resolve()):new Promise(r=>{this.cbs.push(()=>{e&&(this.isOpen=!1),t&&t(),r()})})}}},function(t,e,r){"use strict";r.r(e),r.d(e,"default",(function(){return s}));var{filter:i,map:n}=r(16);class s{constructor(){this.listeners={}}publish(t,e,r,s){this.listeners[t]=i(this.listeners[t],t=>t.obj._isMounted),n(this.listeners[t],({cb:t})=>t(e,r,s))}on2(t,e,r){this.listeners[e]||(this.listeners[e]=[]),this.listeners[e].push({obj:t,cb:r})}}},function(t,e,r){t.exports=r.p+"assets/img/bubble_default.7d5e4ab.svg"},function(t,e,r){t.exports=r.p+"assets/img/subiz-mono.877e9f5.svg"},function(t,e,r){t.exports=r.p+"assets/img/send.6db52a9.svg"},function(t,e,r){t.exports=r.p+"assets/img/check-circle.130937b.svg"},function(t,e,r){t.exports=r.p+"assets/img/empty.29bed2d.svg"},function(t,e,r){t.exports=function(){"use strict";return function(t,e,r){t=t||{};var i=e.prototype,n={future:"in %s",past:"%s ago",s:"a few seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"};r.en.relativeTime=n;var s=function(e,i,s,o){for(var a,u,c,l=s.$locale().relativeTime||n,h=t.thresholds||[{l:"s",r:44,d:"second"},{l:"m",r:89},{l:"mm",r:44,d:"minute"},{l:"h",r:89},{l:"hh",r:21,d:"hour"},{l:"d",r:35},{l:"dd",r:25,d:"day"},{l:"M",r:45},{l:"MM",r:10,d:"month"},{l:"y",r:17},{l:"yy",d:"year"}],d=h.length,p=0;p<d;p+=1){var f=h[p];f.d&&(a=o?r(e).diff(s,f.d,!0):s.diff(e,f.d,!0));var m=(t.rounding||Math.round)(Math.abs(a));if(c=a>0,m<=f.r||!f.r){m<=1&&p>0&&(f=h[p-1]);var g=l[f.l];u="string"==typeof g?g.replace("%d",m):g(m,i,f.l,c);break}}if(i)return u;var v=c?l.future:l.past;return"function"==typeof v?v(u):v.replace("%s",u)};i.to=function(t,e){return s(t,e,this,!0)},i.from=function(t,e){return s(t,e,this)};var o=function(t){return t.$u?r.utc():r()};i.toNow=function(t){return this.to(o(this),t)},i.fromNow=function(t){return this.from(o(this),t)}}}()},function(t,e,r){t.exports=r.p+"assets/img/convos_empty.2353007.svg"},function(t,e,r){t.exports=r.p+"assets/img/loading_static.8f403ae.svg"},function(t,e){function r(t,e){return Math.abs(t-e)<=.001}t.exports=class{constructor(t){this.duration=t.duration||100,this.breakingV=t.breakingV||7,this.maxY=t.maxY||500,this.minY=t.minY||0}play(t,e,r){var i;this.stop();var n=s=>{s||(s=(new Date).getTime());var o=s-i,[a,u]=this.calcY(t,e,o);if(r(a),u)return this.stop();this.animationframe=window.requestAnimationFrame(n)};this.animationframe=window.requestAnimationFrame(t=>{i=t||(new Date).getTime(),n(i)})}calcY(t,e,i){var n,s=function(t,e,i,n){if(r(t,e))return t;var s=t+(e-t)/n*i;(t<e&&s>e||e<t&&s<e)&&(s=e);return s}(e,n=e>this.maxY?this.maxY:e<this.minY?this.minY:Math.abs(t)<this.breakingV?Math.abs(this.maxY-e)<Math.abs(this.minY-e)?this.maxY:this.minY:t<0?this.maxY:this.minY,i,this.duration);return[s,r(s,n)]}stop(){window.cancelAnimationFrame(this.animationframe)}}},function(t,e,r){t.exports=r.p+"assets/img/rating--poor.2938a25.svg"},function(t,e,r){t.exports=r.p+"assets/img/rating--average.1ea492c.svg"},function(t,e,r){t.exports=r.p+"assets/img/rating--great.e3d712e.svg"},function(t,e,r){"use strict";r(89);var i,n=r(18),s=r(7),o=r(56),a=r(1),u=r(54),c=r(13),l=r(57),h=r(2),d=r(95),p=r(96),f=r(48).codeAt,m=r(103),g=r(21),v=r(104),y=r(14),_=a.URL,b=v.URLSearchParams,w=v.getState,k=y.set,S=y.getterFor("URL"),x=Math.floor,M=Math.pow,A=/[A-Za-z]/,C=/[\d+-.A-Za-z]/,F=/\d/,O=/^(0x|0X)/,P=/^[0-7]+$/,E=/^\d+$/,j=/^[\dA-Fa-f]+$/,T=/[\u0000\u0009\u000A\u000D #%/:?@[\\]]/,R=/[\u0000\u0009\u000A\u000D #/:?@[\\]]/,D=/^[\u0000-\u001F ]+|[\u0000-\u001F ]+$/g,L=/[\u0009\u000A\u000D]/g,I=function(t,e){var r,i,n;if("["==e.charAt(0)){if("]"!=e.charAt(e.length-1))return"Invalid host";if(!(r=$(e.slice(1,-1))))return"Invalid host";t.host=r}else if(Y(t)){if(e=m(e),T.test(e))return"Invalid host";if(null===(r=U(e)))return"Invalid host";t.host=r}else{if(R.test(e))return"Invalid host";for(r="",i=p(e),n=0;n<i.length;n++)r+=G(i[n],B);t.host=r}},U=function(t){var e,r,i,n,s,o,a,u=t.split(".");if(u.length&&""==u[u.length-1]&&u.pop(),(e=u.length)>4)return t;for(r=[],i=0;i<e;i++){if(""==(n=u[i]))return t;if(s=10,n.length>1&&"0"==n.charAt(0)&&(s=O.test(n)?16:8,n=n.slice(8==s?1:2)),""===n)o=0;else{if(!(10==s?E:8==s?P:j).test(n))return t;o=parseInt(n,s)}r.push(o)}for(i=0;i<e;i++)if(o=r[i],i==e-1){if(o>=M(256,5-e))return null}else if(o>255)return null;for(a=r.pop(),i=0;i<r.length;i++)a+=r[i]*M(256,3-i);return a},$=function(t){var e,r,i,n,s,o,a,u=[0,0,0,0,0,0,0,0],c=0,l=null,h=0,d=function(){return t.charAt(h)};if(":"==d()){if(":"!=t.charAt(1))return;h+=2,l=++c}for(;d();){if(8==c)return;if(":"!=d()){for(e=r=0;r<4&&j.test(d());)e=16*e+parseInt(d(),16),h++,r++;if("."==d()){if(0==r)return;if(h-=r,c>6)return;for(i=0;d();){if(n=null,i>0){if(!("."==d()&&i<4))return;h++}if(!F.test(d()))return;for(;F.test(d());){if(s=parseInt(d(),10),null===n)n=s;else{if(0==n)return;n=10*n+s}if(n>255)return;h++}u[c]=256*u[c]+n,2!=++i&&4!=i||c++}if(4!=i)return;break}if(":"==d()){if(h++,!d())return}else if(d())return;u[c++]=e}else{if(null!==l)return;h++,l=++c}}if(null!==l)for(o=c-l,c=7;0!=c&&o>0;)a=u[c],u[c--]=u[l+o-1],u[l+--o]=a;else if(8!=c)return;return u},z=function(t){var e,r,i,n;if("number"==typeof t){for(e=[],r=0;r<4;r++)e.unshift(t%256),t=x(t/256);return e.join(".")}if("object"==typeof t){for(e="",i=function(t){for(var e=null,r=1,i=null,n=0,s=0;s<8;s++)0!==t[s]?(n>r&&(e=i,r=n),i=null,n=0):(null===i&&(i=s),++n);return n>r&&(e=i,r=n),e}(t),r=0;r<8;r++)n&&0===t[r]||(n&&(n=!1),i===r?(e+=r?":":"::",n=!0):(e+=t[r].toString(16),r<7&&(e+=":")));return"["+e+"]"}return t},B={},q=d({},B,{" ":1,'"':1,"<":1,">":1,"`":1}),N=d({},q,{"#":1,"?":1,"{":1,"}":1}),W=d({},N,{"/":1,":":1,";":1,"=":1,"@":1,"[":1,"\\":1,"]":1,"^":1,"|":1}),G=function(t,e){var r=f(t,0);return r>32&&r<127&&!h(e,t)?t:encodeURIComponent(t)},H={ftp:21,file:null,http:80,https:443,ws:80,wss:443},Y=function(t){return h(H,t.scheme)},V=function(t){return""!=t.username||""!=t.password},J=function(t){return!t.host||t.cannotBeABaseURL||"file"==t.scheme},Q=function(t,e){var r;return 2==t.length&&A.test(t.charAt(0))&&(":"==(r=t.charAt(1))||!e&&"|"==r)},Z=function(t){var e;return t.length>1&&Q(t.slice(0,2))&&(2==t.length||"/"===(e=t.charAt(2))||"\\"===e||"?"===e||"#"===e)},K=function(t){var e=t.path,r=e.length;!r||"file"==t.scheme&&1==r&&Q(e[0],!0)||e.pop()},X=function(t){return"."===t||"%2e"===t.toLowerCase()},tt={},et={},rt={},it={},nt={},st={},ot={},at={},ut={},ct={},lt={},ht={},dt={},pt={},ft={},mt={},gt={},vt={},yt={},_t={},bt={},wt=function(t,e,r,n){var s,o,a,u,c,l=r||tt,d=0,f="",m=!1,g=!1,v=!1;for(r||(t.scheme="",t.username="",t.password="",t.host=null,t.port=null,t.path=[],t.query=null,t.fragment=null,t.cannotBeABaseURL=!1,e=e.replace(D,"")),e=e.replace(L,""),s=p(e);d<=s.length;){switch(o=s[d],l){case tt:if(!o||!A.test(o)){if(r)return"Invalid scheme";l=rt;continue}f+=o.toLowerCase(),l=et;break;case et:if(o&&(C.test(o)||"+"==o||"-"==o||"."==o))f+=o.toLowerCase();else{if(":"!=o){if(r)return"Invalid scheme";f="",l=rt,d=0;continue}if(r&&(Y(t)!=h(H,f)||"file"==f&&(V(t)||null!==t.port)||"file"==t.scheme&&!t.host))return;if(t.scheme=f,r)return void(Y(t)&&H[t.scheme]==t.port&&(t.port=null));f="","file"==t.scheme?l=pt:Y(t)&&n&&n.scheme==t.scheme?l=it:Y(t)?l=at:"/"==s[d+1]?(l=nt,d++):(t.cannotBeABaseURL=!0,t.path.push(""),l=yt)}break;case rt:if(!n||n.cannotBeABaseURL&&"#"!=o)return"Invalid scheme";if(n.cannotBeABaseURL&&"#"==o){t.scheme=n.scheme,t.path=n.path.slice(),t.query=n.query,t.fragment="",t.cannotBeABaseURL=!0,l=bt;break}l="file"==n.scheme?pt:st;continue;case it:if("/"!=o||"/"!=s[d+1]){l=st;continue}l=ut,d++;break;case nt:if("/"==o){l=ct;break}l=vt;continue;case st:if(t.scheme=n.scheme,o==i)t.username=n.username,t.password=n.password,t.host=n.host,t.port=n.port,t.path=n.path.slice(),t.query=n.query;else if("/"==o||"\\"==o&&Y(t))l=ot;else if("?"==o)t.username=n.username,t.password=n.password,t.host=n.host,t.port=n.port,t.path=n.path.slice(),t.query="",l=_t;else{if("#"!=o){t.username=n.username,t.password=n.password,t.host=n.host,t.port=n.port,t.path=n.path.slice(),t.path.pop(),l=vt;continue}t.username=n.username,t.password=n.password,t.host=n.host,t.port=n.port,t.path=n.path.slice(),t.query=n.query,t.fragment="",l=bt}break;case ot:if(!Y(t)||"/"!=o&&"\\"!=o){if("/"!=o){t.username=n.username,t.password=n.password,t.host=n.host,t.port=n.port,l=vt;continue}l=ct}else l=ut;break;case at:if(l=ut,"/"!=o||"/"!=f.charAt(d+1))continue;d++;break;case ut:if("/"!=o&&"\\"!=o){l=ct;continue}break;case ct:if("@"==o){m&&(f="%40"+f),m=!0,a=p(f);for(var y=0;y<a.length;y++){var _=a[y];if(":"!=_||v){var b=G(_,W);v?t.password+=b:t.username+=b}else v=!0}f=""}else if(o==i||"/"==o||"?"==o||"#"==o||"\\"==o&&Y(t)){if(m&&""==f)return"Invalid authority";d-=p(f).length+1,f="",l=lt}else f+=o;break;case lt:case ht:if(r&&"file"==t.scheme){l=mt;continue}if(":"!=o||g){if(o==i||"/"==o||"?"==o||"#"==o||"\\"==o&&Y(t)){if(Y(t)&&""==f)return"Invalid host";if(r&&""==f&&(V(t)||null!==t.port))return;if(u=I(t,f))return u;if(f="",l=gt,r)return;continue}"["==o?g=!0:"]"==o&&(g=!1),f+=o}else{if(""==f)return"Invalid host";if(u=I(t,f))return u;if(f="",l=dt,r==ht)return}break;case dt:if(!F.test(o)){if(o==i||"/"==o||"?"==o||"#"==o||"\\"==o&&Y(t)||r){if(""!=f){var w=parseInt(f,10);if(w>65535)return"Invalid port";t.port=Y(t)&&w===H[t.scheme]?null:w,f=""}if(r)return;l=gt;continue}return"Invalid port"}f+=o;break;case pt:if(t.scheme="file","/"==o||"\\"==o)l=ft;else{if(!n||"file"!=n.scheme){l=vt;continue}if(o==i)t.host=n.host,t.path=n.path.slice(),t.query=n.query;else if("?"==o)t.host=n.host,t.path=n.path.slice(),t.query="",l=_t;else{if("#"!=o){Z(s.slice(d).join(""))||(t.host=n.host,t.path=n.path.slice(),K(t)),l=vt;continue}t.host=n.host,t.path=n.path.slice(),t.query=n.query,t.fragment="",l=bt}}break;case ft:if("/"==o||"\\"==o){l=mt;break}n&&"file"==n.scheme&&!Z(s.slice(d).join(""))&&(Q(n.path[0],!0)?t.path.push(n.path[0]):t.host=n.host),l=vt;continue;case mt:if(o==i||"/"==o||"\\"==o||"?"==o||"#"==o){if(!r&&Q(f))l=vt;else if(""==f){if(t.host="",r)return;l=gt}else{if(u=I(t,f))return u;if("localhost"==t.host&&(t.host=""),r)return;f="",l=gt}continue}f+=o;break;case gt:if(Y(t)){if(l=vt,"/"!=o&&"\\"!=o)continue}else if(r||"?"!=o)if(r||"#"!=o){if(o!=i&&(l=vt,"/"!=o))continue}else t.fragment="",l=bt;else t.query="",l=_t;break;case vt:if(o==i||"/"==o||"\\"==o&&Y(t)||!r&&("?"==o||"#"==o)){if(".."===(c=(c=f).toLowerCase())||"%2e."===c||".%2e"===c||"%2e%2e"===c?(K(t),"/"==o||"\\"==o&&Y(t)||t.path.push("")):X(f)?"/"==o||"\\"==o&&Y(t)||t.path.push(""):("file"==t.scheme&&!t.path.length&&Q(f)&&(t.host&&(t.host=""),f=f.charAt(0)+":"),t.path.push(f)),f="","file"==t.scheme&&(o==i||"?"==o||"#"==o))for(;t.path.length>1&&""===t.path[0];)t.path.shift();"?"==o?(t.query="",l=_t):"#"==o&&(t.fragment="",l=bt)}else f+=G(o,N);break;case yt:"?"==o?(t.query="",l=_t):"#"==o?(t.fragment="",l=bt):o!=i&&(t.path[0]+=G(o,B));break;case _t:r||"#"!=o?o!=i&&("'"==o&&Y(t)?t.query+="%27":t.query+="#"==o?"%23":G(o,B)):(t.fragment="",l=bt);break;case bt:o!=i&&(t.fragment+=G(o,q))}d++}},kt=function(t){var e,r,i=l(this,kt,"URL"),n=arguments.length>1?arguments[1]:void 0,o=String(t),a=k(i,{type:"URL"});if(void 0!==n)if(n instanceof kt)e=S(n);else if(r=wt(e={},String(n)))throw TypeError(r);if(r=wt(a,o,null,e))throw TypeError(r);var u=a.searchParams=new b,c=w(u);c.updateSearchParams(a.query),c.updateURL=function(){a.query=String(u)||null},s||(i.href=xt.call(i),i.origin=Mt.call(i),i.protocol=At.call(i),i.username=Ct.call(i),i.password=Ft.call(i),i.host=Ot.call(i),i.hostname=Pt.call(i),i.port=Et.call(i),i.pathname=jt.call(i),i.search=Tt.call(i),i.searchParams=Rt.call(i),i.hash=Dt.call(i))},St=kt.prototype,xt=function(){var t=S(this),e=t.scheme,r=t.username,i=t.password,n=t.host,s=t.port,o=t.path,a=t.query,u=t.fragment,c=e+":";return null!==n?(c+="//",V(t)&&(c+=r+(i?":"+i:"")+"@"),c+=z(n),null!==s&&(c+=":"+s)):"file"==e&&(c+="//"),c+=t.cannotBeABaseURL?o[0]:o.length?"/"+o.join("/"):"",null!==a&&(c+="?"+a),null!==u&&(c+="#"+u),c},Mt=function(){var t=S(this),e=t.scheme,r=t.port;if("blob"==e)try{return new URL(e.path[0]).origin}catch(t){return"null"}return"file"!=e&&Y(t)?e+"://"+z(t.host)+(null!==r?":"+r:""):"null"},At=function(){return S(this).scheme+":"},Ct=function(){return S(this).username},Ft=function(){return S(this).password},Ot=function(){var t=S(this),e=t.host,r=t.port;return null===e?"":null===r?z(e):z(e)+":"+r},Pt=function(){var t=S(this).host;return null===t?"":z(t)},Et=function(){var t=S(this).port;return null===t?"":String(t)},jt=function(){var t=S(this),e=t.path;return t.cannotBeABaseURL?e[0]:e.length?"/"+e.join("/"):""},Tt=function(){var t=S(this).query;return t?"?"+t:""},Rt=function(){return S(this).searchParams},Dt=function(){var t=S(this).fragment;return t?"#"+t:""},Lt=function(t,e){return{get:t,set:e,configurable:!0,enumerable:!0}};if(s&&u(St,{href:Lt(xt,(function(t){var e=S(this),r=String(t),i=wt(e,r);if(i)throw TypeError(i);w(e.searchParams).updateSearchParams(e.query)})),origin:Lt(Mt),protocol:Lt(At,(function(t){var e=S(this);wt(e,String(t)+":",tt)})),username:Lt(Ct,(function(t){var e=S(this),r=p(String(t));if(!J(e)){e.username="";for(var i=0;i<r.length;i++)e.username+=G(r[i],W)}})),password:Lt(Ft,(function(t){var e=S(this),r=p(String(t));if(!J(e)){e.password="";for(var i=0;i<r.length;i++)e.password+=G(r[i],W)}})),host:Lt(Ot,(function(t){var e=S(this);e.cannotBeABaseURL||wt(e,String(t),lt)})),hostname:Lt(Pt,(function(t){var e=S(this);e.cannotBeABaseURL||wt(e,String(t),ht)})),port:Lt(Et,(function(t){var e=S(this);J(e)||(""==(t=String(t))?e.port=null:wt(e,t,dt))})),pathname:Lt(jt,(function(t){var e=S(this);e.cannotBeABaseURL||(e.path=[],wt(e,t+"",gt))})),search:Lt(Tt,(function(t){var e=S(this);""==(t=String(t))?e.query=null:("?"==t.charAt(0)&&(t=t.slice(1)),e.query="",wt(e,t,_t)),w(e.searchParams).updateSearchParams(e.query)})),searchParams:Lt(Rt),hash:Lt(Dt,(function(t){var e=S(this);""!=(t=String(t))?("#"==t.charAt(0)&&(t=t.slice(1)),e.fragment="",wt(e,t,bt)):e.fragment=null}))}),c(St,"toJSON",(function(){return xt.call(this)}),{enumerable:!0}),c(St,"toString",(function(){return xt.call(this)}),{enumerable:!0}),_){var It=_.createObjectURL,Ut=_.revokeObjectURL;It&&c(kt,"createObjectURL",(function(t){return It.apply(_,arguments)})),Ut&&c(kt,"revokeObjectURL",(function(t){return Ut.apply(_,arguments)}))}g(kt,"URL"),n({global:!0,forced:!o,sham:!s},{URL:kt})},function(t,e,r){"use strict";var i=r(48).charAt,n=r(14),s=r(49),o=n.set,a=n.getterFor("String Iterator");s(String,"String",(function(t){o(this,{type:"String Iterator",string:String(t),index:0})}),(function(){var t,e=a(this),r=e.string,n=e.index;return n>=r.length?{value:void 0,done:!0}:(t=i(r,n),e.index+=t.length,{value:t,done:!1})}))},function(t,e,r){var i=r(4);t.exports=!i((function(){function t(){}return t.prototype.constructor=null,Object.getPrototypeOf(new t)!==t.prototype}))},function(t,e,r){var i=r(53);t.exports=i&&!Symbol.sham&&"symbol"==typeof Symbol.iterator},function(t,e,r){var i=r(28);t.exports=i("document","documentElement")},function(t,e,r){var i=r(5),n=r(94);t.exports=Object.setPrototypeOf||("__proto__"in{}?function(){var t,e=!1,r={};try{(t=Object.getOwnPropertyDescriptor(Object.prototype,"__proto__").set).call(r,[]),e=r instanceof Array}catch(t){}return function(r,s){return i(r),n(s),e?t.call(r,s):r.__proto__=s,r}}():void 0)},function(t,e,r){var i=r(8);t.exports=function(t){if(!i(t)&&null!==t)throw TypeError("Can't set "+String(t)+" as a prototype");return t}},function(t,e,r){"use strict";var i=r(7),n=r(4),s=r(55),o=r(45),a=r(35),u=r(31),c=r(36),l=Object.assign,h=Object.defineProperty;t.exports=!l||n((function(){if(i&&1!==l({b:1},l(h({},"a",{enumerable:!0,get:function(){h(this,"b",{value:3,enumerable:!1})}}),{b:2})).b)return!0;var t={},e={},r=Symbol();return t[r]=7,"abcdefghijklmnopqrst".split("").forEach((function(t){e[t]=t})),7!=l({},t)[r]||"abcdefghijklmnopqrst"!=s(l({},e)).join("")}))?function(t,e){for(var r=u(t),n=arguments.length,l=1,h=o.f,d=a.f;n>l;)for(var p,f=c(arguments[l++]),m=h?s(f).concat(h(f)):s(f),g=m.length,v=0;g>v;)p=m[v++],i&&!d.call(f,p)||(r[p]=f[p]);return r}:l},function(t,e,r){"use strict";var i=r(58),n=r(31),s=r(98),o=r(100),a=r(44),u=r(101),c=r(33);t.exports=function(t){var e,r,l,h,d,p,f=n(t),m="function"==typeof this?this:Array,g=arguments.length,v=g>1?arguments[1]:void 0,y=void 0!==v,_=c(f),b=0;if(y&&(v=i(v,g>2?arguments[2]:void 0,2)),null==_||m==Array&&o(_))for(r=new m(e=a(f.length));e>b;b++)p=y?v(f[b],b):f[b],u(r,b,p);else for(d=(h=_.call(f)).next,r=new m;!(l=d.call(h)).done;b++)p=y?s(h,v,[l.value,b],!0):l.value,u(r,b,p);return r.length=b,r}},function(t,e){t.exports=function(t){if("function"!=typeof t)throw TypeError(String(t)+" is not a function");return t}},function(t,e,r){var i=r(5),n=r(99);t.exports=function(t,e,r,s){try{return s?e(i(r)[0],r[1]):e(r)}catch(e){throw n(t),e}}},function(t,e,r){var i=r(5);t.exports=function(t){var e=t.return;if(void 0!==e)return i(e.call(t)).value}},function(t,e,r){var i=r(3),n=r(15),s=i("iterator"),o=Array.prototype;t.exports=function(t){return void 0!==t&&(n.Array===t||o[s]===t)}},function(t,e,r){"use strict";var i=r(23),n=r(10),s=r(12);t.exports=function(t,e,r){var o=i(e);o in t?n.f(t,o,s(0,r)):t[o]=r}},function(t,e,r){var i={};i[r(3)("toStringTag")]="z",t.exports="[object z]"===String(i)},function(t,e,r){"use strict";var i=/[^\0-\u007E]/,n=/[.\u3002\uFF0E\uFF61]/g,s="Overflow: input needs wider integers to process",o=Math.floor,a=String.fromCharCode,u=function(t){return t+22+75*(t<26)},c=function(t,e,r){var i=0;for(t=r?o(t/700):t>>1,t+=o(t/e);t>455;i+=36)t=o(t/35);return o(i+36*t/(t+38))},l=function(t){var e,r,i=[],n=(t=function(t){for(var e=[],r=0,i=t.length;r<i;){var n=t.charCodeAt(r++);if(n>=55296&&n<=56319&&r<i){var s=t.charCodeAt(r++);56320==(64512&s)?e.push(((1023&n)<<10)+(1023&s)+65536):(e.push(n),r--)}else e.push(n)}return e}(t)).length,l=128,h=0,d=72;for(e=0;e<t.length;e++)(r=t[e])<128&&i.push(a(r));var p=i.length,f=p;for(p&&i.push("-");f<n;){var m=2147483647;for(e=0;e<t.length;e++)(r=t[e])>=l&&r<m&&(m=r);var g=f+1;if(m-l>o((2147483647-h)/g))throw RangeError(s);for(h+=(m-l)*g,l=m,e=0;e<t.length;e++){if((r=t[e])<l&&++h>2147483647)throw RangeError(s);if(r==l){for(var v=h,y=36;;y+=36){var _=y<=d?1:y>=d+26?26:y-d;if(v<_)break;var b=v-_,w=36-_;i.push(a(u(_+b%w))),v=o(b/w)}i.push(a(u(v))),d=c(h,g,f==p),h=0,++f}}++h,++l}return i.join("")};t.exports=function(t){var e,r,s=[],o=t.toLowerCase().replace(n,".").split(".");for(e=0;e<o.length;e++)r=o[e],s.push(i.test(r)?"xn--"+l(r):r);return s.join(".")}},function(t,e,r){"use strict";r(105);var i=r(18),n=r(28),s=r(56),o=r(13),a=r(107),u=r(21),c=r(50),l=r(14),h=r(57),d=r(2),p=r(58),f=r(59),m=r(5),g=r(8),v=r(32),y=r(12),_=r(108),b=r(33),w=r(3),k=n("fetch"),S=n("Headers"),x=w("iterator"),M=l.set,A=l.getterFor("URLSearchParams"),C=l.getterFor("URLSearchParamsIterator"),F=/\+/g,O=Array(4),P=function(t){return O[t-1]||(O[t-1]=RegExp("((?:%[\\da-f]{2}){"+t+"})","gi"))},E=function(t){try{return decodeURIComponent(t)}catch(e){return t}},j=function(t){var e=t.replace(F," "),r=4;try{return decodeURIComponent(e)}catch(t){for(;r;)e=e.replace(P(r--),E);return e}},T=/[!'()~]|%20/g,R={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+"},D=function(t){return R[t]},L=function(t){return encodeURIComponent(t).replace(T,D)},I=function(t,e){if(e)for(var r,i,n=e.split("&"),s=0;s<n.length;)(r=n[s++]).length&&(i=r.split("="),t.push({key:j(i.shift()),value:j(i.join("="))}))},U=function(t){this.entries.length=0,I(this.entries,t)},$=function(t,e){if(t<e)throw TypeError("Not enough arguments")},z=c((function(t,e){M(this,{type:"URLSearchParamsIterator",iterator:_(A(t).entries),kind:e})}),"Iterator",(function(){var t=C(this),e=t.kind,r=t.iterator.next(),i=r.value;return r.done||(r.value="keys"===e?i.key:"values"===e?i.value:[i.key,i.value]),r})),B=function(){h(this,B,"URLSearchParams");var t,e,r,i,n,s,o,a,u,c=arguments.length>0?arguments[0]:void 0,l=this,p=[];if(M(l,{type:"URLSearchParams",entries:p,updateURL:function(){},updateSearchParams:U}),void 0!==c)if(g(c))if("function"==typeof(t=b(c)))for(r=(e=t.call(c)).next;!(i=r.call(e)).done;){if((o=(s=(n=_(m(i.value))).next).call(n)).done||(a=s.call(n)).done||!s.call(n).done)throw TypeError("Expected sequence with length 2");p.push({key:o.value+"",value:a.value+""})}else for(u in c)d(c,u)&&p.push({key:u,value:c[u]+""});else I(p,"string"==typeof c?"?"===c.charAt(0)?c.slice(1):c:c+"")},q=B.prototype;a(q,{append:function(t,e){$(arguments.length,2);var r=A(this);r.entries.push({key:t+"",value:e+""}),r.updateURL()},delete:function(t){$(arguments.length,1);for(var e=A(this),r=e.entries,i=t+"",n=0;n<r.length;)r[n].key===i?r.splice(n,1):n++;e.updateURL()},get:function(t){$(arguments.length,1);for(var e=A(this).entries,r=t+"",i=0;i<e.length;i++)if(e[i].key===r)return e[i].value;return null},getAll:function(t){$(arguments.length,1);for(var e=A(this).entries,r=t+"",i=[],n=0;n<e.length;n++)e[n].key===r&&i.push(e[n].value);return i},has:function(t){$(arguments.length,1);for(var e=A(this).entries,r=t+"",i=0;i<e.length;)if(e[i++].key===r)return!0;return!1},set:function(t,e){$(arguments.length,1);for(var r,i=A(this),n=i.entries,s=!1,o=t+"",a=e+"",u=0;u<n.length;u++)(r=n[u]).key===o&&(s?n.splice(u--,1):(s=!0,r.value=a));s||n.push({key:o,value:a}),i.updateURL()},sort:function(){var t,e,r,i=A(this),n=i.entries,s=n.slice();for(n.length=0,r=0;r<s.length;r++){for(t=s[r],e=0;e<r;e++)if(n[e].key>t.key){n.splice(e,0,t);break}e===r&&n.push(t)}i.updateURL()},forEach:function(t){for(var e,r=A(this).entries,i=p(t,arguments.length>1?arguments[1]:void 0,3),n=0;n<r.length;)i((e=r[n++]).value,e.key,this)},keys:function(){return new z(this,"keys")},values:function(){return new z(this,"values")},entries:function(){return new z(this,"entries")}},{enumerable:!0}),o(q,x,q.entries),o(q,"toString",(function(){for(var t,e=A(this).entries,r=[],i=0;i<e.length;)t=e[i++],r.push(L(t.key)+"="+L(t.value));return r.join("&")}),{enumerable:!0}),u(B,"URLSearchParams"),i({global:!0,forced:!s},{URLSearchParams:B}),s||"function"!=typeof k||"function"!=typeof S||i({global:!0,enumerable:!0,forced:!0},{fetch:function(t){var e,r,i,n=[t];return arguments.length>1&&(g(e=arguments[1])&&(r=e.body,"URLSearchParams"===f(r)&&((i=e.headers?new S(e.headers):new S).has("content-type")||i.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"),e=v(e,{body:y(0,String(r)),headers:y(0,i)}))),n.push(e)),k.apply(this,n)}}),t.exports={URLSearchParams:B,getState:A}},function(t,e,r){"use strict";var i=r(19),n=r(106),s=r(15),o=r(14),a=r(49),u=o.set,c=o.getterFor("Array Iterator");t.exports=a(Array,"Array",(function(t,e){u(this,{type:"Array Iterator",target:i(t),index:0,kind:e})}),(function(){var t=c(this),e=t.target,r=t.kind,i=t.index++;return!e||i>=e.length?(t.target=void 0,{value:void 0,done:!0}):"keys"==r?{value:i,done:!1}:"values"==r?{value:e[i],done:!1}:{value:[i,e[i]],done:!1}}),"values"),s.Arguments=s.Array,n("keys"),n("values"),n("entries")},function(t,e,r){var i=r(3),n=r(32),s=r(10),o=i("unscopables"),a=Array.prototype;null==a[o]&&s.f(a,o,{configurable:!0,value:n(null)}),t.exports=function(t){a[o][t]=!0}},function(t,e,r){var i=r(13);t.exports=function(t,e,r){for(var n in e)i(t,n,e[n],r);return t}},function(t,e,r){var i=r(5),n=r(33);t.exports=function(t){var e=n(t);if("function"!=typeof e)throw TypeError(String(t)+" is not iterable");return i(e.call(t))}},function(t,e){t.exports=function(t){return new Promise((function(e){setTimeout(e,t)}))}},function(t,e,r){var i=r(111);t.exports=function(t,e,r){"number"==typeof e||r||(r=e,e=1);var n={};if(i.map(t,(function(t,e){n[e]=t})),e<=0&&(e=1),0===Object.keys(n).length)return Promise.resolve([]);Object.keys(n).length<e&&(e=Object.keys(n).length);var s={};return new Promise((function(t){let o=Object.keys(n).length;for(var a=function(){var e=Object.keys(n);if(0!==e.length){var u=e.pop(),c=n[u];delete n[u];var l=r(c,u);l&&l.then||(l=Promise.resolve(l)),l.then((function(e){if(s[u]=e,Object.keys(s).length===o)return t(i.map(s));a()}))}},u=0;u<e;u++)setTimeout(a,1)}))}},function(t,e){t.exports={map:function(t,e){if(!t)return[];e||(e=function(t){return t});var r=[];if(Array.isArray(t)){for(var i=0;i<t.length;i++)r.push(e(t[i],i));return r}if("object"==typeof t){var n=Object.keys(t);for(i=0;i<n.length;i++){var s=n[i];r.push(e(t[s],s))}return r}return r}}},function(t,e,r){var i=r(61);t.exports=function(t,e,r){var n=[],s="idle",o=function(t){var e=t.map((function(t){return t.payload})),i=r(e);i&&i.then||(i=Promise.resolve(i));var n=t.map((function(t){return t.rs}));return new Promise((function(t){i.then((function(e){n.map((function(t,r){t(e&&e[r])})),t()}))}))},a=function(){"executing"!==s&&(s="executing",i((function(){if(n.length<=t)return Promise.resolve(!1);var e=n.splice(0,t);return o(e).then((function(){return!0}))})).then((function(){if(0!==n.length){var t=e-(Date.now()-n[0].created);if(t>=1){if(s="idle",n[0].settedTimeout)return;return n[0].settedTimeout=!0,void setTimeout(a,t)}var r=n;n=[],o(r).then((function(){s="idle",a()}))}else s="idle"})))};return this.push=function(t,e){return new Promise((function(r){n.push({payload:t,priority:e,created:Date.now(),rs:r}),a()}))},this}},function(t,e,r){"use strict";r.r(e);e.default=class{constructor(t,e){this.name=e,e+="_kv",this.dead=!1,this.db=t,this.cache={},this.initialized=!1,this.init()}refreshCache(){if(this.dead)return;let t={};this.db.all("items").forEach((function(e){t[e.key]=e.value})),this.cache=t}init(){if(this.initialized)return;let t={};console.time("KV"+this.name),this.db.all("items").forEach((function(e){t[e.key]=e.value})),this.cache=t;let e=Object.keys(this.cache);if(e.length>500){let t=250/e.lenth,i=[];for(var r=0;r<500;r++){if(Math.random()<=t)continue;let n=e[r];delete this.cache[n],i.push(n)}this.db.removes("items",[i])}this.initialized=!0,console.timeEnd("KV"+this.name)}all(){return this.dead?[]:this.initialized?this.cache:[]}match(t){if(!this.dead&&this.initialized&&t)return this.cache[t]}put(t,e){if(t){if(this.dead)return[];if(!this.initialized)throw new Error("uninitialized");this.cache[t]=e,this.db.put("items",t,{key:t,value:e})}}del(t){if(!this.dead){if(!this.initialized)throw new Error("uninitialized");delete this.cache[t],this.db.removes("items",[t])}}destroy(){this.db.clear("items"),this.dead=!0,this.db=void 0,this.cache=void 0,this.initialized=!1}}},function(t,e,r){"use strict";r.r(e),r.d(e,"default",(function(){return i}));class i{constructor(t,e,r){this.schema=e+"_chain",this.dead=!1,this.db=t,this.anchorCache={},this.cache={},this.init()}init(){let t={};this.db.all("items").map(e=>{t[e.chain]=t[e.chain]||{},t[e.chain][e.id]={id:e.id,chain:e.chain,full_id:e.full_id,index:e.index,value:e.value}}),s(t,(e,r)=>{if(((i=e)?void 0!==i.length?i.length:Object.keys(i).length:0)<50)return;var i;let n=(o=s(e),a=["index"],u="desc",c=[],s(o,t=>c.push(t)),c.sort((t,e)=>{if(t[a]===e[a])return 0;var r=t[a]<e[a]?-1:1;return"desc"===u?-r:r}),c);var o,a,u,c;let l=[];for(var h=50;h<n.length;h++)l.push(n[h].full_id),delete e[n[h].id];this.db.removes("items",l),t[r]=e}),this.cache=t}destroy(){this.db.clear("items"),this.dead=!0,this.cache={},this.anchorCache={},this.db=void 0}put(t,e,r,i){if(this.dead)return;let s=this.cache[t]||{},o=(n(s)||{}).index||"z",a={id:e,index:r,value:i,chain:t,full_id:t+":"+e};delete s[a.id],o>a.index+""||(s[a.id]=a,this.cache[t]=s,this.db.put("items",a.full_id,a))}listM(t){if(this.dead)return{};let e=this.cache[t]||{},r={};return s(e,(t,e)=>{r[e]=t.value}),r}async fetchMore(t,e=20,r){if(this.dead)return{error:"dead"};if(!r)return{error:"no api"};let i=this.anchorCache[t]||"";var[n,s,o]=await r(t,i,e);if(o)return{error:o};if(this.dead)return{error:"dead"};let a=this.cache[t]||{};return 0===n.length?{end:!0}:(n.forEach(e=>{e.chain=t,e.full_id=t+":"+e.id,a[e.id]=e,this.db.put("items",e.full_id,e)}),this.anchorCache[t]=s,this.cache[t]=a,{})}del(t,e){if(this.dead)return;let r=t+":"+e;delete(this.cache[t]||{})[e],this.db.removes("items",[r])}match(t,e){return this.listM(t)[e]}async reload(t,e){if(this.dead)return;let r=(function(t){if(!t)return;let e=Object.keys(t);if(!e.length)return;let r=-1/0,i=Object.keys(t)[0];for(var n=0;n<e.length;n++){let s=t[e[n]]&&t[e[n]].index||-1/0;s>r&&(r=s,i=e[n])}return t[e[i]]}(this.listM(t))||{}).index;r||(r=Date.now());for(var i="",o={};;){if(this.dead)return;let[a,u,c]=await e(t,i,50);if(c)return;if(this.dead)return;if(a.map(e=>{o[e.id]=Object.assign({},e,{chain:t,full_id:t+":"+e.id})}),0===a.length||u===i)break;if(o.length>=200){let e=this.cache[t]||{},r=[];s(e,e=>{e.chain===t&&r.push(e.full_id)}),this.db.removes("items",r),this.cache[t]={};break}if((n(o)||{}).index<=r){i=this.anchorCache[t]||u;break}i=u}for(var a=0;a<Object.keys(o).length;a++){let t=o[Object.keys(o)[a]];this.db.put("items",t.full_id,t),this.cache[t.chain]=this.cache[t.chain]||{},this.cache[t.chain][t.id]=t}this.anchorCache[t]=i}}function n(t){if(!t)return;let e=Object.keys(t);if(!e.length)return;let r=1/0,i=Object.keys(t)[0];for(var n=0;n<e.length;n++){let s=t[e[n]]&&t[e[n]].index||1/0;s<r&&(r=s,i=e[n])}return t[i]}function s(t,e){if(!t)return[];if(!e)return t;var r=[];if(Array.isArray(t)){for(let i=0;i<t.length;i++)r.push(e(t[i],i));return r}if("object"==typeof t){var i=Object.keys(t);for(let s=0;s<i.length;s++){var n=i[s];r.push(e(t[n],n))}return r}return r}},function(t,e,r){"use strict";r.r(e);let i=r(62).default,n=window.requestIdleCallback||(t=>t());e.default=class{constructor(t,e){if(this.localStorage=i,this.allkeys={},!e)try{window.localStorage.setItem("sbzstore1029","?"),window.localStorage.removeItem("sbzstore1029"),this.localStorage=window.localStorage}catch(t){}this.schema=t}all(t){let e=[];for(var r=0;r<this.localStorage.length;r++){let i=this.localStorage.key(r);i.startsWith(this.schema+"#"+t+"#")&&(this.allkeys[i]=!0,e.push(JSON.parse(this.localStorage.getItem(i))))}return e}removes(t,e){for(var r=0;r<e.length;r++)delete this.allkeys[this.schema+"#"+t+"#"+e[r]],this.localStorage.removeItem(this.schema+"#"+t+"#"+e[r])}clear(t){let e=[];for(var r=0;r<this.localStorage.length;r++){let i=this.localStorage.key(r);i.startsWith(this.schema+"#"+t+"#")&&e.push(i)}for(r=0;r<e.length;r++)this.localStorage.removeItem(e[r]);this.allkeys={}}put(t,e,r){this.allkeys[this.schema+"#"+t+"#"+e]=!0,Object.keys(this.allkeys).length>80&&this.clear(t),n(()=>{try{this.localStorage.setItem(this.schema+"#"+t+"#"+e,void 0===(i=r)?"null":JSON.stringify(i))}catch(e){this.clear(t)}var i})}}},function(t,e){function r(t){return encodeURIComponent(t).replace(/[!'()*]/g,(function(t){return"%"+t.charCodeAt(0).toString(16)}))}function i(t,e){return null===e?r(t):[r(t),"=",r(e)].join("")}t.exports={stringify:function(t){if(!t)return"";for(var e=Object.keys(t),n=[],s=0;s<e.length;s++){var o=e[s],a="",u=t[o];if(void 0!==u){if(null===u)a=r(o);else if(Array.isArray(u)){for(var c=[],l=0;l<u.length;l++)void 0!==u[l]&&c.push(i(o,u[l],c.length));a=c.join("&")}else a=r(o)+"="+r(u);a.length>0&&n.push(a)}}return n.join("&")}}},function(t,e,r){t.exports=r(118)},function(t,e,r){var i=r(60);function n(t,e,r,n,a){a=a||s,e=e||{};var d=!1,p="";this.kill=function(){d=!0};var f=function(e){d||a("get",t+"poll?token="+p,void 0,(function(i,s){if(!d){if(c(s))return setTimeout(f,u(e),e+1);if(200!==s)return d=!0,r("poll");(i=o(i)||{}).host&&(t=h(i.host));var a=i.sequential_token;return a?(p=a,n(i.events||[]),f(0)):setTimeout(f,u(e),e+1)}}))},m=i.batch(50,100,(function(n){if(d)return["dead"];if(n.length<=0)return[];var s=[];return i.loop((function(){return new Promise((function(i){var u="?token="+p;e.getAccessToken().then((function(m){e.user_mask?u+="&user-mask="+encodeURIComponent(e.user_mask):m&&(u+="&access-token="+m),a("post",t+"subs"+u,JSON.stringify({events:n}),(function(e,a){if(d)return s=l("dead",n.length),i(!1);if(c(a))return setTimeout(i,3e3,!0);if(200!==a)return d=!0,r("subscribe",e,a),s=l("dead",n.length),i(!1);if(p)return i(!1);var u=(e=o(e)||{}).initial_token;return u?(e.host&&(t=h(e.host)),p=u,f(0),i(!1)):setTimeout(i,3e3,!0)}))}))}))})).then((function(){return s}))}));this.subscribe=m.push.bind(m)}function s(t,e,r,i){var n=new XMLHttpRequest;n.onreadystatechange=function(t){4===n.readyState&&(i&&i(n.responseText,n.status),i=void 0)},n.onerror=function(){i&&i(n.responseText,-1),i=void 0},n.open(t,e),r&&n.setRequestHeader("content-type","text/plain"),n.send(r)}function o(t){try{return JSON.parse(t)}catch(t){}}function a(){var t={};this.emit=function(e){for(var r=[],i=1;i<arguments.length;i++)r.push(arguments[i]);var n=t[e];if(n)for(i=0;i<n.length;i++)n[i].apply(void 0,r)},this.on=function(e,r){t[e]||(t[e]=[]),t[e].push(r)}}function u(t){if(!t||-1===t)return 0;var e=1e3*Math.pow(1.5,t);return Math.min(1e4,e)}function c(t){return t>=500&&t<600||0===t||-1===t||429===t}function l(t,e){for(var r=[],i=0;i<e;i++)r.push(t);return r}function h(t){return(t=t||"").startsWith("//")?"https:"+t:t}t.exports=function(t,e,r){("string"==typeof t||t instanceof String)&&(t=[t]),(e=e||{}).getAccessToken||(e.getAccessToken=function(){return Promise.resolve("")});var i,s=new a,o={},u=!1;this.stop=function(){u||(u=!0,i.kill())},this.onEvent=function(t){return s.on("event",t)},this.onInterrupted=function(t){return s.on("interrupted",t)},this.subscribe=function(t){if(u)return Promise.resolve({});if("string"==typeof t&&(t=[t]),!Array.isArray(t))return Promise.resolve({error:"param should be an array or string"});for(var e=[],r=0;r<t.length;r++){var n=t[r];n&&("online"!==o[n]&&e.push(i.subscribe(n)))}return 0===e.length?Promise.resolve({}):Promise.all(e).then((function(e){for(var r=0;r<e.length;r++)if(e[r])return{error:e[r]};for(var i=0;i<t.length;i++)o[t[i]]=!0;return{}}))};var c=function(){if(!u){for(var a=Object.keys(o),l=0;l<a.length;l++)o[a[l]]=!1;var h=t[Math.floor(Math.random()*t.length)];i=new n(h,e,(function(t,e,r){u||(s.emit("interrupted",t,e,r),setTimeout(c,2e3))}),(function(t){if(!u)for(var e=0;e<t.length;e++)s.emit("event",t[e])}),r);var d=Object.keys(o);for(l=0;l<d.length;l++)i.subscribe(d[l])}};c()}},function(t,e,r){t.exports=function(){"use strict";var t=function(){return t.get.apply(t,arguments)},e=t.utils={isArray:Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)},isPlainObject:function(t){return!!t&&"[object Object]"===Object.prototype.toString.call(t)},toArray:function(t){return Array.prototype.slice.call(t)},getKeys:Object.keys||function(t){var e=[],r="";for(r in t)t.hasOwnProperty(r)&&e.push(r);return e},encode:function(t){return String(t).replace(/[,;"\\=\s%]/g,(function(t){return encodeURIComponent(t)}))},decode:function(t){return decodeURIComponent(t)},retrieve:function(t,e){return null==t?e:t}};return t.defaults={},t.expiresMultiplier=86400,t.set=function(t,r,i){if(e.isPlainObject(t))for(var n in t)t.hasOwnProperty(n)&&this.set(n,t[n],r);else{var s=void 0!==(i=e.isPlainObject(i)?i:{expires:i}).expires?i.expires:this.defaults.expires||"",o=typeof s;"string"===o&&""!==s?s=new Date(s):"number"===o&&(s=new Date(+new Date+1e3*this.expiresMultiplier*s)),""!==s&&"toUTCString"in s&&(s=";expires="+s.toUTCString());var a=i.path||this.defaults.path;a=a?";path="+a:"";var u=i.domain||this.defaults.domain;u=u?";domain="+u:"";var c=i.secure||this.defaults.secure?";secure":"";!1===i.secure&&(c="");var l=i.sameSite||this.defaults.sameSite;l=l?";SameSite="+l:"",null===i.sameSite&&(l=""),document.cookie=e.encode(t)+"="+e.encode(r)+s+a+u+c+l}return this},t.setDefault=function(r,i,n){if(e.isPlainObject(r)){for(var s in r)void 0===this.get(s)&&this.set(s,r[s],i);return t}if(void 0===this.get(r))return this.set.apply(this,arguments)},t.remove=function(t){for(var r=0,i=(t=e.isArray(t)?t:e.toArray(arguments)).length;r<i;r++)this.set(t[r],"",-1);return this},t.removeSpecific=function(t,r){if(!r)return this.remove(t);t=e.isArray(t)?t:[t],r.expires=-1;for(var i=0,n=t.length;i<n;i++)this.set(t[i],"",r);return this},t.empty=function(){return this.remove(e.getKeys(this.all()))},t.get=function(t,r){var i=this.all();if(e.isArray(t)){for(var n={},s=0,o=t.length;s<o;s++){var a=t[s];n[a]=e.retrieve(i[a],r)}return n}return e.retrieve(i[t],r)},t.all=function(){if(""===document.cookie)return{};for(var t=document.cookie.split("; "),r={},i=0,n=t.length;i<n;i++){var s=t[i].split("="),o=e.decode(s.shift()),a=e.decode(s.join("="));r[o]=a}return r},t.enabled=function(){if(navigator.cookieEnabled)return!0;var e="_"===t.set("_","_").get("_");return t.remove("_"),e},t}()},function(t,e,r){"use strict";r.r(e),r.d(e,"getDeviceInfo",(function(){return s})),r.d(e,"sendEventToThirdParty",(function(){return o}));const i=r(17).getParser(window.navigator.userAgent).parsedResult;const n=()=>!(!window.ga||!window.ga.getAll);function s(){let t={user_agent:window.navigator.userAgent,screen_resolution:window.screen.width+"x"+window.screen.height,source_referrer:document.referrer,platform:window.navigator.platform,referrer:document.URL,type:"mobile"===i.platform.type?"mobile":"desktop",language:navigator.language||navigator.userLanguage},e=(r="",n()?((window.ga.getAll()||[]).forEach((function(t){r=t.get("clientId")})),r):r);var r;e&&(t.ga_client_id=e);let s=(o=[],n()?((window.ga.getAll()||[]).forEach((function(t){var e=t.get("trackingId");e&&o.push(e)})),o):o);var o;return s.length>0&&(t.ga_tracking_ids=s),t}function o(t,e,r){document.dispatchEvent(new CustomEvent("subiz",{detail:{category:t,action:e,label:r}})),function(t,e,r){if(!n())return;(window.ga.getAll()||[]).forEach((function(i){const n=i.get("name");window.ga(n+".send","event",t,e,r)}))}(t,e,r),function(t,e,r){window.fbq&&window.fbq("trackCustom",t,{action:e,label:r})}(t,e,r)}},function(t,e,r){"use strict";r.r(e),r.d(e,"onVisibilityChange",(function(){return n})),r.d(e,"replaceCssVariable",(function(){return o})),r.d(e,"inmemCookie",(function(){return c}));var i=r(0);function n(t){var e="hidden";function r(r){var i="visible",n="hidden",s={focus:i,focusin:i,pageshow:i,blur:n,focusout:n,pagehide:n};(r=r||window.event).type in s?t(s[r.type]):t(this[e]?"hidden":"visible")}e in document?document.addEventListener("visibilitychange",r):(e="mozHidden")in document?document.addEventListener("mozvisibilitychange",r):(e="webkitHidden")in document?document.addEventListener("webkitvisibilitychange",r):(e="msHidden")in document?document.addEventListener("msvisibilitychange",r):"onfocusin"in document?document.onfocusin=document.onfocusout=r:window.onpageshow=window.onpagehide=window.onfocus=window.onblur=r,void 0!==document[e]&&r({type:document[e]?"blur":"focus"})}const s={primary_color:"#0265FF",secondary_color:"#555555",background:"linear-gradient(280.16deg, #0053d3 22.03%, #0265ff 78.2%)",text_color:"white",width:375,height:705,window_mode:"mini",desktop_button:{width:.3,height:.3,border_radius:"100%",background_mask_url:"https://file-subiz.com/bubble_11.svg",margin_x:.3,margin_y:.3},mobile_button:{width:.3,height:.3,border_radius:"100%",background_mask_url:"https://file-subiz.com/bubble_11.svg",margin_x:.3,margin_y:.3},widget_position:"fixed"};function o(t,e){var r=[t];r=a(r,"'@primary_color'"),r=a(r,"@esc-primary-color-esc"),r=a(r,"'@secondary_color'"),r=a(r,"'@background'"),r=a(r,"'@text_color'"),r=a(r,"'@width'"),r=a(r,"'@height'"),r=a(r,"'@desktop_button.width'"),r=a(r,"'@desktop_button.height'"),r=a(r,"'@desktop_button.background'"),r=a(r,"'@desktop_button.border_radius'"),r=a(r,"'@desktop_button.margin_x'"),r=a(r,"'@desktop_button.margin_y'"),r=a(r,"'@mobile_button.width'"),r=a(r,"'@mobile_button.height'"),r=a(r,"'@mobile_button.background'"),r=a(r,"'@mobile_button.border_radius'"),r=a(r,"'@mobile_button.margin_x'"),r=a(r,"'@mobile_button.margin_y'"),r=a(r,"'@widget_position'");for(var n=[],o=0;o<r.length;o++){var c=r[o];if("string"!=typeof c)if("@esc-primary-color-esc"!==c.type){var l=c.type.substr(2,c.type.length-3);h=u(h=i.a.get(e,l)||i.a.get(s,l)||""),["mobile_button.width","mobile_button.height","mobile_button.margin_x","mobile_button.margin_y","desktop_button.width","desktop_button.height","desktop_button.margin_x","desktop_button.margin_y","width","height"].includes(l)&&(h+="px"),"height"!==l||"full"!==i.a.get(e,"window_mode")?n.push(h):n.push("100%")}else{var h=i.a.get(e,"primary_color")||i.a.get(s,"primary_color");n.push(encodeURIComponent(u(h)))}else n.push(c)}return n.join("")}function a(t,e){if(!t||!t.length)return[];var r=[];for(let s=0;s<t.length;s++){var i=t[s];if("string"==typeof i){var n=i.split(e);for(let t=0;t<n.length;t++)r.push(n[t]),r.push({type:e});r.pop()}else r.push(i)}return r}function u(t){return("string"==typeof t||t instanceof String)&&(t=t.trim().replace(/;+$/,"")),t}const c={data:{},get(t,e){return this.data[t]||e},set(t,e){return this.data[t]=t},all(){return this.data},remove(t){delete this.data[t]}}},function(t,e,r){t.exports=function(t){"use strict";t=t&&t.hasOwnProperty("default")?t.default:t;var e={name:"vi",weekdays:"ch nht_th hai_th ba_th t_th nm_th su_th by".split("_"),months:"thng 1_thng 2_thng 3_thng 4_thng 5_thng 6_thng 7_thng 8_thng 9_thng 10_thng 11_thng 12".split("_"),weekStart:1,weekdaysShort:"CN_T2_T3_T4_T5_T6_T7".split("_"),monthsShort:"Th01_Th02_Th03_Th04_Th05_Th06_Th07_Th08_Th09_Th10_Th11_Th12".split("_"),weekdaysMin:"CN_T2_T3_T4_T5_T6_T7".split("_"),ordinal:function(t){return t},formats:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM [nm] YYYY",LLL:"D MMMM [nm] YYYY HH:mm",LLLL:"dddd, D MMMM [nm] YYYY HH:mm",l:"DD/M/YYYY",ll:"D MMM YYYY",lll:"D MMM YYYY HH:mm",llll:"ddd, D MMM YYYY HH:mm"},relativeTime:{future:"%s ti",past:"%s trc",s:"vi giy",m:"mt pht",mm:"%d pht",h:"mt gi",hh:"%d gi",d:"mt ngy",dd:"%d ngy",M:"mt thng",MM:"%d thng",y:"mt nm",yy:"%d nm"}};return t.locale(e,null,!0),e}(r(11))},function(t,e){t.exports={ApiURL:"https://api.sbz.vn/4.0",RealtimeURL:"https://rt-0.sbz.vn/",FileURL:"https://file-subiz.com",BaseURL:"https://widget.sbz.vn"}},function(t,e,r){"use strict";r.r(e);var i,n,s,o,a=r(0),u={},c=[],l=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i;function h(t,e){for(var r in e)t[r]=e[r];return t}function d(t){var e=t.parentNode;e&&e.removeChild(t)}function p(t,e,r){var i,n,s,o=arguments,a={};for(s in e)"key"==s?i=e[s]:"ref"==s?n=e[s]:a[s]=e[s];if(arguments.length>3)for(r=[r],s=3;s<arguments.length;s++)r.push(o[s]);if(null!=r&&(a.children=r),"function"==typeof t&&null!=t.defaultProps)for(s in t.defaultProps)void 0===a[s]&&(a[s]=t.defaultProps[s]);return f(t,a,i,n,null)}function f(t,e,r,n,s){var o={type:t,props:e,key:r,ref:n,__k:null,__:null,__b:0,__e:null,__d:void 0,__c:null,__h:null,constructor:void 0,__v:null==s?++i.__v:s};return null!=i.vnode&&i.vnode(o),o}function m(t){return t.children}function g(t,e){this.props=t,this.context=e}function v(t,e){if(null==e)return t.__?v(t.__,t.__.__k.indexOf(t)+1):null;for(var r;e<t.__k.length;e++)if(null!=(r=t.__k[e])&&null!=r.__e)return r.__e;return"function"==typeof t.type?v(t):null}function y(t){var e,r;if(null!=(t=t.__)&&null!=t.__c){for(t.__e=t.__c.base=null,e=0;e<t.__k.length;e++)if(null!=(r=t.__k[e])&&null!=r.__e){t.__e=t.__c.base=r.__e;break}return y(t)}}function _(t){(!t.__d&&(t.__d=!0)&&n.push(t)&&!b.__r++||o!==i.debounceRendering)&&((o=i.debounceRendering)||s)(b)}function b(){for(var t;b.__r=n.length;)t=n.sort((function(t,e){return t.__v.__b-e.__v.__b})),n=[],t.some((function(t){var e,r,i,n,s,o;t.__d&&(s=(n=(e=t).__v).__e,(o=e.__P)&&(r=[],(i=h({},n)).__v=n.__v+1,F(o,n,i,e.__n,void 0!==o.ownerSVGElement,null!=n.__h?[s]:null,r,null==s?v(n):s,n.__h),O(r,n),n.__e!=s&&y(n)))}))}function w(t,e,r,i,n,s,o,a,l,h){var d,p,g,y,_,b,w,x=i&&i.__k||c,M=x.length;for(r.__k=[],d=0;d<e.length;d++)if(null!=(y=r.__k[d]=null==(y=e[d])||"boolean"==typeof y?null:"string"==typeof y||"number"==typeof y?f(null,y,null,null,y):Array.isArray(y)?f(m,{children:y},null,null,null):y.__b>0?f(y.type,y.props,y.key,null,y.__v):y)){if(y.__=r,y.__b=r.__b+1,null===(g=x[d])||g&&y.key==g.key&&y.type===g.type)x[d]=void 0;else for(p=0;p<M;p++){if((g=x[p])&&y.key==g.key&&y.type===g.type){x[p]=void 0;break}g=null}F(t,y,g=g||u,n,s,o,a,l,h),_=y.__e,(p=y.ref)&&g.ref!=p&&(w||(w=[]),g.ref&&w.push(g.ref,null,y),w.push(p,y.__c||_,y)),null!=_?(null==b&&(b=_),"function"==typeof y.type&&null!=y.__k&&y.__k===g.__k?y.__d=l=k(y,l,t):l=S(t,y,g,x,_,l),h||"option"!==r.type?"function"==typeof r.type&&(r.__d=l):t.value=""):l&&g.__e==l&&l.parentNode!=t&&(l=v(g))}for(r.__e=b,d=M;d--;)null!=x[d]&&("function"==typeof r.type&&null!=x[d].__e&&x[d].__e==r.__d&&(r.__d=v(i,d+1)),j(x[d],x[d]));if(w)for(d=0;d<w.length;d++)E(w[d],w[++d],w[++d])}function k(t,e,r){var i,n;for(i=0;i<t.__k.length;i++)(n=t.__k[i])&&(n.__=t,e="function"==typeof n.type?k(n,e,r):S(r,n,n,t.__k,n.__e,e));return e}function S(t,e,r,i,n,s){var o,a,u;if(void 0!==e.__d)o=e.__d,e.__d=void 0;else if(null==r||n!=s||null==n.parentNode)t:if(null==s||s.parentNode!==t)t.appendChild(n),o=null;else{for(a=s,u=0;(a=a.nextSibling)&&u<i.length;u+=2)if(a==n)break t;t.insertBefore(n,s),o=s}return void 0!==o?o:n.nextSibling}function x(t,e,r){"-"===e[0]?t.setProperty(e,r):t[e]=null==r?"":"number"!=typeof r||l.test(e)?r:r+"px"}function M(t,e,r,i,n){var s;t:if("style"===e)if("string"==typeof r)t.style.cssText=r;else{if("string"==typeof i&&(t.style.cssText=i=""),i)for(e in i)r&&e in r||x(t.style,e,"");if(r)for(e in r)i&&r[e]===i[e]||x(t.style,e,r[e])}else if("o"===e[0]&&"n"===e[1])s=e!==(e=e.replace(/Capture$/,"")),e=e.toLowerCase()in t?e.toLowerCase().slice(2):e.slice(2),t.l||(t.l={}),t.l[e+s]=r,r?i||t.addEventListener(e,s?C:A,s):t.removeEventListener(e,s?C:A,s);else if("dangerouslySetInnerHTML"!==e){if(n)e=e.replace(/xlink[H:h]/,"h").replace(/sName$/,"s");else if("href"!==e&&"list"!==e&&"form"!==e&&"download"!==e&&e in t)try{t[e]=null==r?"":r;break t}catch(t){}"function"==typeof r||(null!=r&&(!1!==r||"a"===e[0]&&"r"===e[1])?t.setAttribute(e,r):t.removeAttribute(e))}}function A(t){this.l[t.type+!1](i.event?i.event(t):t)}function C(t){this.l[t.type+!0](i.event?i.event(t):t)}function F(t,e,r,n,s,o,a,u,c){var l,d,p,f,v,y,_,b,k,S,x,M=e.type;if(void 0!==e.constructor)return null;null!=r.__h&&(c=r.__h,u=e.__e=r.__e,e.__h=null,o=[u]),(l=i.__b)&&l(e);try{t:if("function"==typeof M){if(b=e.props,k=(l=M.contextType)&&n[l.__c],S=l?k?k.props.value:l.__:n,r.__c?_=(d=e.__c=r.__c).__=d.__E:("prototype"in M&&M.prototype.render?e.__c=d=new M(b,S):(e.__c=d=new g(b,S),d.constructor=M,d.render=T),k&&k.sub(d),d.props=b,d.state||(d.state={}),d.context=S,d.__n=n,p=d.__d=!0,d.__h=[]),null==d.__s&&(d.__s=d.state),null!=M.getDerivedStateFromProps&&(d.__s==d.state&&(d.__s=h({},d.__s)),h(d.__s,M.getDerivedStateFromProps(b,d.__s))),f=d.props,v=d.state,p)null==M.getDerivedStateFromProps&&null!=d.componentWillMount&&d.componentWillMount(),null!=d.componentDidMount&&d.__h.push(d.componentDidMount);else{if(null==M.getDerivedStateFromProps&&b!==f&&null!=d.componentWillReceiveProps&&d.componentWillReceiveProps(b,S),!d.__e&&null!=d.shouldComponentUpdate&&!1===d.shouldComponentUpdate(b,d.__s,S)||e.__v===r.__v){d.props=b,d.state=d.__s,e.__v!==r.__v&&(d.__d=!1),d.__v=e,e.__e=r.__e,e.__k=r.__k,d.__h.length&&a.push(d);break t}null!=d.componentWillUpdate&&d.componentWillUpdate(b,d.__s,S),null!=d.componentDidUpdate&&d.__h.push((function(){d.componentDidUpdate(f,v,y)}))}d.context=S,d.props=b,d.state=d.__s,(l=i.__r)&&l(e),d.__d=!1,d.__v=e,d.__P=t,l=d.render(d.props,d.state,d.context),d.state=d.__s,null!=d.getChildContext&&(n=h(h({},n),d.getChildContext())),p||null==d.getSnapshotBeforeUpdate||(y=d.getSnapshotBeforeUpdate(f,v)),x=null!=l&&l.type===m&&null==l.key?l.props.children:l,w(t,Array.isArray(x)?x:[x],e,r,n,s,o,a,u,c),d.base=e.__e,e.__h=null,d.__h.length&&a.push(d),_&&(d.__E=d.__=null),d.__e=!1}else null==o&&e.__v===r.__v?(e.__k=r.__k,e.__e=r.__e):e.__e=P(r.__e,e,r,n,s,o,a,c);(l=i.diffed)&&l(e)}catch(t){e.__v=null,(c||null!=o)&&(e.__e=u,e.__h=!!c,o[o.indexOf(u)]=null),i.__e(t,e,r)}}function O(t,e){i.__c&&i.__c(e,t),t.some((function(e){try{t=e.__h,e.__h=[],t.some((function(t){t.call(e)}))}catch(t){i.__e(t,e.__v)}}))}function P(t,e,r,i,n,s,o,a){var l,h,p,f,m=r.props,g=e.props,v=e.type,y=0;if("svg"===v&&(n=!0),null!=s)for(;y<s.length;y++)if((l=s[y])&&(l===t||(v?l.localName==v:3==l.nodeType))){t=l,s[y]=null;break}if(null==t){if(null===v)return document.createTextNode(g);t=n?document.createElementNS("http://www.w3.org/2000/svg",v):document.createElement(v,g.is&&g),s=null,a=!1}if(null===v)m===g||a&&t.data===g||(t.data=g);else{if(s=s&&c.slice.call(t.childNodes),h=(m=r.props||u).dangerouslySetInnerHTML,p=g.dangerouslySetInnerHTML,!a){if(null!=s)for(m={},f=0;f<t.attributes.length;f++)m[t.attributes[f].name]=t.attributes[f].value;(p||h)&&(p&&(h&&p.__html==h.__html||p.__html===t.innerHTML)||(t.innerHTML=p&&p.__html||""))}if(function(t,e,r,i,n){var s;for(s in r)"children"===s||"key"===s||s in e||M(t,s,null,r[s],i);for(s in e)n&&"function"!=typeof e[s]||"children"===s||"key"===s||"value"===s||"checked"===s||r[s]===e[s]||M(t,s,e[s],r[s],i)}(t,g,m,n,a),p)e.__k=[];else if(y=e.props.children,w(t,Array.isArray(y)?y:[y],e,r,i,n&&"foreignObject"!==v,s,o,t.firstChild,a),null!=s)for(y=s.length;y--;)null!=s[y]&&d(s[y]);a||("value"in g&&void 0!==(y=g.value)&&(y!==t.value||"progress"===v&&!y)&&M(t,"value",y,m.value,!1),"checked"in g&&void 0!==(y=g.checked)&&y!==t.checked&&M(t,"checked",y,m.checked,!1))}return t}function E(t,e,r){try{"function"==typeof t?t(e):t.current=e}catch(t){i.__e(t,r)}}function j(t,e,r){var n,s,o;if(i.unmount&&i.unmount(t),(n=t.ref)&&(n.current&&n.current!==t.__e||E(n,null,e)),r||"function"==typeof t.type||(r=null!=(s=t.__e)),t.__e=t.__d=void 0,null!=(n=t.__c)){if(n.componentWillUnmount)try{n.componentWillUnmount()}catch(t){i.__e(t,e)}n.base=n.__P=null}if(n=t.__k)for(o=0;o<n.length;o++)n[o]&&j(n[o],e,r);null!=s&&d(s)}function T(t,e,r){return this.constructor(t,r)}function R(t,e,r){var n,s,o;i.__&&i.__(t,e),s=(n="function"==typeof r)?null:r&&r.__k||e.__k,o=[],F(e,t=(!n&&r||e).__k=p(m,null,[t]),s||u,u,void 0!==e.ownerSVGElement,!n&&r?[r]:s?null:e.firstChild?c.slice.call(e.childNodes):null,o,!n&&r?r:s?s.__e:e.firstChild,n),O(o,t)}i={__e:function(t,e){for(var r,i,n;e=e.__;)if((r=e.__c)&&!r.__)try{if((i=r.constructor)&&null!=i.getDerivedStateFromError&&(r.setState(i.getDerivedStateFromError(t)),n=r.__d),null!=r.componentDidCatch&&(r.componentDidCatch(t),n=r.__d),n)return r.__E=r}catch(e){t=e}throw t},__v:0},g.prototype.setState=function(t,e){var r;r=null!=this.__s&&this.__s!==this.state?this.__s:this.__s=h({},this.state),"function"==typeof t&&(t=t(h({},r),this.props)),t&&h(r,t),null!=t&&this.__v&&(e&&this.__h.push(e),_(this))},g.prototype.forceUpdate=function(t){this.__v&&(this.__e=!0,t&&this.__h.push(t),_(this))},g.prototype.render=m,n=[],s="function"==typeof Promise?Promise.prototype.then.bind(Promise.resolve()):setTimeout,b.__r=0;class D extends g{constructor(t){super(t),this._isMounted=!0,setTimeout(()=>{if(this.componentWillUnmount){let t=this.componentWillUnmount.bind(this);this.componentWillUnmount=()=>{t(),this._isMounted=!1}}},10)}$t(t){return this.props.store.$t(t)}}class L extends D{render(){var t=this.props.emojiCode;if(a.a.size(t)<3)return null;var e=t.replace(/:/g,"");return p("i",{"data-tooltip":t,class:"emoji emoji--"+e})}}const I=r(17).getParser(window.navigator.userAgent).parsedResult;var U=r(76);class $ extends D{constructor(t){super(t),this.setState({previewEvent:{},displayPreview:!1}),this.loadGreeting(),this.props.store.onUpdate(this,t=>this.forceUpdate()),this.props.store.onConvoEvent(this,t=>{if("message_sent"!==a.a.get(t,"type"))return;let e=a.a.get(t,"by.type");"system"!==e&&"agent"!==e||this.setState({displayPreview:!0,previewEvent:t})})}render(){let t=this.props.store.matchAccountSetting(),e=a.a.get(t,"desktop_button.position")||"right";if("mobile"===I.platform.type){if(e=a.a.get(t,"mobile_button.position")||e,a.a.get(t,"mobile_button.hidden"))return null}if(a.a.get(t,"desktop_button.hidden"))return null;let r="widget-layout widget-layout--"+e;return this.props.isShow||(r+=" widget-layout--hidden"),p("div",{class:r},this.renderPreview(),this.renderButton())}clearPreview(){this.setState({previewEvent:{}})}loadGreeting(){let t=this.props.store.matchAccountSetting();if((new Date).getTime()-this.props.store.matchClosePreviewAt()<z)return;let e=a.a.get(t,"greeting",{});if(!e.message)return void this.setState({previewEvent:{}});let r=this.props.store.matchAgent("*"),i=e.agent_id;i||(i=function(t){var e=a.a.filter(t,t=>"agent"===t.type);return e[Math.floor(Math.random()*a.a.size(e))]||{}}(r).id),this.setState({previewEvent:{by:{id:i,type:"agent"},data:{message:{text:e.message,format:"plaintext"}}},displayPreview:!0})}onClick(){let t=this.props.store.matchLastview();return a.a.get(t,"view")&&("list"!==t.view||a.a.size(this.props.store.matchConvo("*"))>0)?this.props.onClick&&this.props.onClick(Object.assign({},t.opts,{view:t.view})):this.onPreviewClick()}onPreviewClick(t){let e=a.a.convoOfEv(this.state.previewEvent);this.closePreview(t),this.props.onClick&&this.props.onClick({view:"chat",cid:e})}renderUnread(){let t=this.props.store.matchUser(),e=this.props.store.matchConvo("*"),r=0;return a.a.map(e,e=>{let i=this.props.store.listEvents(e.id);a.a.isConvoSeen(t.id,i)||r++}),0===r?null:p("div",{class:"chat-button--unread"},r)}renderPreview(){let t=this.props.store.matchAccount(),e=this.props.store.matchAccountSetting(),i=a.a.get(this.state.previewEvent,"by.display_id",a.a.get(this.state.previewEvent,"by.id")),n=a.a.cloneDeep(this.props.store.matchAgent(i))||{};n.fullname=n.fullname||a.a.get(t,"name")||this.$t("agent"),n.avatar_url=n.avatar_url||a.a.get(t,"logo_url")||r(6);let s=a.a.get(e,"desktop_button.position")||"right";"mobile"===I.platform.type&&(s=a.a.get(e,"mobile_button.position")||s);let o="widget-preview widget-preview--"+s;this.state.displayPreview||(o+=" widget-preview--hidden");var u=this.renderMessagePreview(this.state.previewEvent,this.$t("sent_you_a_message"));return 0===a.a.size(u)&&(o+=" widget-preview--hidden"),p("div",{class:o},p("div",{class:"d-flex flex-row pl-3 pt-3 pr-3 pb-3"},p("img",{class:"widget-preview--avatar",src:this.props.store.replaceFileUrl(n.avatar_url)}),p("div",{class:"widget-preview--content",onClick:t=>this.onPreviewClick(t)},p("h5",{class:"widget-preview--title"},n.fullname),p("p",{class:"widget-preview--message"},u)),p("div",{class:"widget-preview--btn-close",onClick:t=>this.closePreview(t)})),p("div",{class:"widget-preview--action",onClick:t=>this.onPreviewClick(t)},p("h5",{class:"widget-preview--action-text"},this.$t("chat_now"))))}renderButton(){let t=this.props.store.matchAccountSetting(),e=a.a.get(t,"desktop_button.background_image_url")||a.a.get(t,"desktop_button.background_mask_url")||U,r=a.a.get(t,"background")||q,i=a.a.get(t,"desktop_button.position")||"right",n=a.a.get(t,"desktop_button.background_image_url"),s=a.a.get(t,"desktop_button.background_mask_url");if("mobile"===I.platform.type){e=a.a.get(t,"mobile_button.background_image_url")||a.a.get(t,"mobile_button.background_mask_url")||e,i=a.a.get(t,"mobile_button.position")||i;let r=a.a.get(t,"mobile_button.background_image_url"),o=a.a.get(t,"mobile_button.background_mask_url");(r||o)&&(n=r,s=o)}let o="chat-button--white-bg";!n&&s&&(o+=" chat-button--white-bg--mask-only");let u="";return n=this.props.store.replaceFileUrl(n),s=this.props.store.replaceFileUrl(s),n||s||(o+=" chat-button--white-bg--mask-only",u=`\n\t\t\t\t-webkit-mask-image: url(${B}) !important;\n\t\t\t\t-o-mask-image: url(${B}) !important;\n\t\t\t\t-moz-mask-image: url(${B}) !important;\n\t\t\t\tmask-image: url(${B}) !important;\n\t\t\t\theight: 70px !important;\n\t\t\t\twidth: 70px !important;\n\t\t\t\tbackground: ${r} !important;\n\t\t\t`),n&&s&&(u=`\n\t\t\t\t-webkit-mask-image: url(${s}) !important;\n\t\t\t\t-o-mask-image: url(${s}) !important;\n\t\t\t\t-moz-mask-image: url(${s}) !important;\n\t\t\t\tmask-image: url(${s}) !important;\n\t\t\t\tbackground-image: url(${n}) !important;\n\t\t\t\tbackground-repeat: no-repeat !important;\n\t\t\t`),n&&!s&&(u=`\n\t\t\t\tbackground-image: url(${n}) !important;\n\t\t\t\tbackground-repeat: no-repeat !important;\n\t\t\t`),!n&&s&&(u=`\n\t\t\t\t-webkit-mask-image: url(${s}) !important;\n\t\t\t\t-o-mask-image: url(${s}) !important;\n\t\t\t\t-moz-mask-image: url(${s}) !important;\n\t\t\t\tmask-image: url(${s}) !important;\n\t\t\t\theight: 70px !important;\n\t\t\t\twidth: 70px !important;\n\t\t\t\tbackground: ${r} !important;\n\t\t\t`),p("div",{class:"chat-button chat-button--"+i,onClick:t=>this.onClick(t)},p("div",{class:o}),p("div",{class:"chat-button--img-container",style:u},p("img",{class:"chat-button--img",src:e,onError:t=>this.onChatButtonError(t)})),this.renderUnread())}onChatButtonError(t){this._onChatButtonErrorExecuted||(this._onChatButtonErrorExecuted=!0,t.target.src=U)}renderMessagePreview(t,e){e=e||"Sent you a message";let r=a.a.get(t,"data.message.text");var i=a.a.get(t,"data.message.format");if(i&&"plaintext"!==i&&(r=e),!r&&a.a.size(a.a.get(t,"data.message.attachments"))>0&&(r=e),!r)return null;let n=a.a.get(t,"by.type");return a.a.extractText(r).map(t=>"emoji"===t.type?p(L,{emojiCode:t.text,byType:n}):t.text)}closePreview(t){t&&(t.preventDefault(),t.stopPropagation()),this.setState({displayPreview:!1}),this.props.store.closePreview(),this.forceUpdate()}}const z=18e5,B="https://file-subiz.com/bubble_11.svg",q="linear-gradient(280.16deg, #0053d3 22.03%, #0265ff 78.2%)";var N=r(77);class W extends D{constructor(t){super(t)}render(){return p("div",{class:"poweredby"},p("a",{href:`https://subiz.com.vn/?utm_source=id-${this.props.store.matchUser().account_id}&utm_medium=widget&utm_campaign=widget_referral`,class:"poweredby--text",target:"_blank"},p("img",{class:"poweredby--subiz-logo",src:N,alt:!0})," Subiz"))}}class G extends D{constructor(t){super(t)}render(){let t=this.props.store.matchAccountSetting(),e=this.props.store.matchAgent("*");var i=a.a.map(this.props.agent_ids,t=>e[t]);if(void 0===this.props.agent_ids||0===a.a.size(this.props.agent_ids)){var n=a.a.get(t,"header.agent_ids",[]);i=0!==(n=a.a.filter(n,t=>!!e[t])).length?a.a.map(n,t=>e[t]):a.a.filter(e,t=>"agent"===t.type)}i=a.a.filter(i,t=>!!t);let s=this.props.store.matchAccount();var o=this.props.tooltipPos||"bottom",u=this.props.mode||"primary";if(0===i.length)return p("div",{class:"group-avatar group-avatar--"+u},p("div",{class:"d-inline-block pos-relative","data-tooltip":s.name,"data-tooltip-position":o},p("img",{class:"avatar group-avatar--agent-left",src:this.props.store.replaceFileUrl(s.logo_url)||r(47)})));if(1===i.length){var c=i[0],l="primary"===u?"group-avatar--agent-middle":"group-avatar--agent-left";return p("div",{class:"group-avatar group-avatar--"+u},p("div",{class:"d-inline-block pos-relative","data-tooltip":c.fullname||s.name,"data-tooltip-position":o},p("img",{class:"avatar "+l,src:this.props.store.replaceFileUrl(c.avatar_url)||r(6)})))}if(2===i.length){let t=i[0],e=i[1];return p("div",{class:"group-avatar group-avatar--"+u},p("div",{class:"d-inline-block pos-relative","data-tooltip":t.fullname||s.name,"data-tooltip-position":o},p("img",{class:"avatar group-avatar--agent-left",src:this.props.store.replaceFileUrl(t.avatar_url)||r(6)})),p("div",{class:"d-inline-block pos-relative","data-tooltip":e.fullname||s.name,"data-tooltip-position":o},p("img",{class:"avatar group-avatar--agent-right",src:this.props.store.replaceFileUrl(e.avatar_url)||r(6)})))}let h=i[0],d=i[1],f=i[2];return p("div",{class:"group-avatar group-avatar--"+u},p("div",{class:"d-inline-block pos-relative","data-tooltip":h.fullname||s.name,"data-tooltip-position":o},p("img",{class:"avatar group-avatar--agent-left",src:this.props.store.replaceFileUrl(h.avatar_url)||r(6)})),p("div",{class:"d-inline-block pos-relative","data-tooltip":d.fullname||s.name,"data-tooltip-position":o},p("img",{class:"avatar group-avatar--agent-middle",src:this.props.store.replaceFileUrl(d.avatar_url)||r(6)})),p("div",{class:"d-inline-block pos-relative","data-tooltip":f.fullname||s.name,"data-tooltip-position":o},p("img",{class:"avatar group-avatar--agent-right",src:this.props.store.replaceFileUrl(f.avatar_url)||r(6)})))}}class H extends D{constructor(t){super(t)}render(){let t="widget-header",e=!1,r=!1,i="list"!==this.props.view&&!0,n=this.props.store.matchAccountSetting()||{},s=a.a.get(n,"header.layout");return i?t+=" widget-header--collapsed":(t+=" widget-header--convo-expanded",e="social"!==s,r=!e),p("div",{class:t},this.renderCollapsedHeader(i),this.renderSocial(e),this.renderTeam(r))}renderCollapsedHeader(t){let e=this.props.store.matchAccountSetting()||{},r=e.is_online?this.$t("agent_online"):this.$t("agent_offline"),i=e.introduction||r,n=a.a.map(this.getAgentJoined(this.props.cid),t=>t.id),s="widget-header--inner widget-header--inner--collapsed";return t||(s+=" widget-header--inner--hidden"),p("div",{class:s},this.renderBackButton(),p(G,{store:this.props.store,mode:"secondary",agent_ids:n}),p("div",{class:"widget-header--title-container"},p("div",{class:"widget-header--title"},this.getTitle()),p("div",{class:"widget-header--description"},i)),this.renderCloseButton())}renderSocial(t){let e=this.props.store.matchAccountSetting()||{},r=this.props.store.matchAccount(),i=a.a.get(e,"header.links")||[],n=a.a.map(i,t=>t.url&&t.type&&"subiz"!==t.type?"email"===t.type?p("div",null,p("a",{href:"mailto:"+t.url,title:t.url},p("i",{class:"social__links-logo social__links-logo--"+t.type}))):p("div",null,p("a",{href:t.url,target:"_blank",title:t.url},p("i",{class:"social__links-logo social__links-logo--"+t.type}))):null);var s=a.a.get(this,"accountSetting.introduction")||this.$t("team_intro")||"Chng ti sn sng tr gip :wave:.\nVui lng hi chng ti bt c iu g hoc chia s phn hi ca bn",o=a.a.extractText(s).map(t=>"emoji"===t.type?p(L,{emojiCode:t.text}):t.text);let u="widget-header--inner widget-header--inner--expanded";return t||(u+=" widget-header--inner--hidden"),p("div",{class:u},p("div",{class:"widget-header-expand-container"},p("div",{class:"widget-header--top-wrapper"},p("div",{class:"widget-header--title"},this.getTitle()),this.renderCloseButton()),p("div",{class:"widget_header__body widget_header__body__social"},p("img",{class:"social__account_logo",src:this.props.store.replaceFileUrl(a.a.get(r,"logo_url"))}),p("div",null,p("div",{class:"social__introduction"},o),p("div",{class:"social__links"},n)))))}renderTeam(t){var e=(this.props.store.matchAccountSetting()||{}).introduction||this.$t("team_intro")||"Chng ti sn sng tr gip :wave:.\nVui lng hi chng ti bt c iu g hoc chia s phn hi ca bn",r=a.a.extractText(e).map(t=>"emoji"===t.type?p(L,{emojiCode:t.text}):t.text);let i="widget-header--inner widget-header--inner--expanded";return t||(i+=" widget-header--inner--hidden"),p("div",{class:i},p("div",{class:"widget-header-expand-container"},p("div",{class:"widget-header--top-wrapper"},p("div",{class:"widget-header--title"},this.getTitle()),this.renderCloseButton()),p("div",{class:"widget_header__body"},p("div",{class:"widget-header--avatar-wrapper"},p(G,{store:this.props.store,mode:"primary"})),p("div",{class:"widget-header--title-container"},p("div",{class:"widget-header--description"},r)))))}getTitle(){let t=this.props.store.matchAccountSetting()||{},e=this.props.store.matchAccount(),r=this.getAgentJoined(this.props.cid);return Y(r)||t.title||e.name||this.$t("widget_title")}renderBackButton(){let t=this.props.store.matchConvo("*");if(0===a.a.size(t))return null;var e=null;let r=this.props.store.matchUser(),i=0;return a.a.map(t,t=>{if(t.id===this.props.cid)return;let e=this.props.store.listEvents(t.id);a.a.isConvoSeen(r.id,e)||i++}),0!==i&&(e=p("span",{class:"widget-header--total-unread-convo"},i)),p("div",{class:"widget-header--wrap-button-back "+(i?"widget-header--has-convo-unred":""),onClick:t=>this.onBackClick(t)},p("div",{class:"widget-header--button-back","data-tooltip":this.$t("menu_back")}),e)}renderCloseButton(){return p("div",{class:"widget-header--button widget-header--button-close","data-tooltip":this.$t("close"),"data-tooltip-position":"bottom",onClick:t=>this.onCloseClick(t)},p("span",{class:"widget-header--button-close-icon"}))}onBackClick(t){t.stopPropagation(),t.preventDefault(),this.props.onGotoList&&this.props.onGotoList()}onCloseClick(t){t.stopPropagation(),t.preventDefault(),this.props.onClose&&this.props.onClose()}getAgentJoined(t){var e=this.props.store.matchConvo(t)||{};return a.a.filter(e.members,t=>"agent"===t.type&&"active"===t.membership)}}let Y=t=>a.a.map(t,t=>t.name).join(", ");var V=r(11);class J extends D{constructor(t){super(t),this._forceUpdate=a.a.throttle((function(){this.forceUpdate()}),500),this.resizeInput=a.a.throttle((function(){const t=this.refMessageInput.current;t.style.setProperty("height","1em","important");const e=Math.min(200,t.scrollHeight);t.style.setProperty("height",e+"px","important")}),5),this.onEnter=a.a.throttle((function(){this.submitMessage()}),50),this.refFileInput={current:null},this.refMessageInput={current:null},this.props.store.onUpdate(this,t=>this.forceUpdate()),this.props.store.onConvoEvent(this,t=>{a.a.convoOfEv(t)===this.props.cid&&this.forceUpdate()}),this.focus()}render(){var t=p("div",{class:"d-flex flex-row align-self-end"},this.renderEmoji(),p("div",{"data-tooltip-poasition":"top-left",class:"message-input--button message-input--attachment-button",onClick:t=>this.selectFile(t)}));a.a.trim(this.refMessageInput.current&&this.refMessageInput.current.value).length>0&&(t=p("div",{class:"d-flex flex-row align-self-end"},this.renderEmoji(),p("div",{"data-tooltip-position":"top-left",class:"message-input--button message-input--send-button",onClick:()=>this.submitMessage()})));var e="",r=this.hasUnfinishRequiredFormOrLock()||this.props.disabled;return r&&(e="message-input--disabled"),p("div",{class:"message-input "+e,onClick:t=>{this.refMessageInput.current&&this.refMessageInput.current.focus()}},p("input",{class:"d-none",ref:this.refFileInput,type:"file",onChange:t=>this.sendFile(t),multiple:!0}),p("textarea",{disabled:r,class:"message-input--input",maxlength:"1024",placeholder:this.$t("message_input_help"),ref:this.refMessageInput,rows:"1",onPaste:t=>this.pasteImage(t),"data-emojiable":"true",onKeydown:t=>this.onKeydown(t),onKeyup:t=>this.onKeyup(t)}),t)}hasUnfinishRequiredFormOrLock(){let t=this.props.store.matchConvo(this.props.cid);if("ended"===a.a.get(t,"state"))return!1;let e=this.props.store.listEvents(this.props.cid);e=a.a.orderBy(e,"created","desc").filter(t=>"message_sent"===t.type);let r=a.a.get(e[0],"data.message.attachments",[]);if(a.a.find(r,t=>a.a.get(t,"lock_input")))return!0;var i;for(let t of e)if("user"!==a.a.get(t,"by.type")){i=t;break}r=a.a.get(i,"data.message.attachments",[]);let n=a.a.filter(r,t=>{if(!t)return!1;if("form"!==t.type&&"ask_info_form"!==t.type)return!1;var e=t.form;return!!e&&(!(!(a.a.parseJSON(e.state)||{}).require_finished&&"ask_info_form"!==t.type)&&!function(t){let e=a.a.get(t,"fields")||[];return a.a.find(e,t=>!!t.answered)}(t.form))});return a.a.size(n)>0}renderEmojiPopup(){return this.state.openEmoji?p("div",{class:"emoji-picker","v-clickaway":t=>this.setState({openEmoji:!1})},p("div",{class:"emoji-picker-background-item"},p("div",{onClick:()=>this.emojiPick(":like:"),"data-tooltip":":like:",class:"emoji-picker--item emoji--like"})),p("div",{class:"emoji-picker-background-item"},p("div",{onClick:()=>this.emojiPick(":unlike:"),"data-tooltip":":unlike:",class:"emoji-picker--item emoji--unlike"})),p("div",{class:"emoji-picker-background-item"},p("div",{onClick:()=>this.emojiPick(":angry:"),"data-tooltip":":angry:",class:"emoji-picker--item emoji--angry"})),p("div",{class:"emoji-picker-background-item"},p("div",{onClick:()=>this.emojiPick(":confused:"),"data-tooltip":":confused:",class:"emoji-picker--item emoji--confused"})),p("div",{class:"emoji-picker-background-item"},p("div",{onClick:()=>this.emojiPick(":crying:"),"data-tooltip":":crying:",class:"emoji-picker--item emoji--crying"})),p("div",{class:"emoji-picker-background-item"},p("div",{onClick:()=>this.emojiPick(":grinning:"),"data-tooltip":":grinning:",class:"emoji-picker--item emoji--grinning"})),p("div",{class:"emoji-picker-background-item"},p("div",{onClick:()=>this.emojiPick(":heart-eyes:"),"data-tooltip":":heart-eyes:",class:"emoji-picker--item emoji--heart-eyes"})),p("div",{class:"emoji-picker-background-item"},p("div",{onClick:()=>this.emojiPick(":neutral:"),"data-tooltip":":neutral:",class:"emoji-picker--item emoji--neutral"})),p("div",{class:"emoji-picker-background-item"},p("div",{onClick:()=>this.emojiPick(":sad:"),"data-tooltip":":sad:",class:"emoji-picker--item emoji--sad"})),p("div",{class:"emoji-picker-background-item"},p("div",{onClick:()=>this.emojiPick(":sleepy:"),"data-tooltip":":sleepy:",class:"emoji-picker--item emoji--sleepy"})),p("div",{class:"emoji-picker-background-item"},p("div",{onClick:()=>this.emojiPick(":smiling:"),"data-tooltip":":smiling:",class:"emoji-picker--item emoji--smiling"})),p("div",{class:"emoji-picker-background-item"},p("div",{onClick:()=>this.emojiPick(":surprised:"),"data-tooltip":":surprised:",class:"emoji-picker--item emoji--surprised"})),p("div",{class:"emoji-picker-background-item"},p("div",{onClick:()=>this.emojiPick(":tired:"),"data-tooltip":":tired:",class:"emoji-picker--item emoji--tired"})),p("div",{class:"emoji-picker-background-item"},p("div",{onClick:()=>this.emojiPick(":tongue-out:"),"data-tooltip":":tongue-out:",class:"emoji-picker--item emoji--tongue-out"})),p("div",{class:"emoji-picker-background-item"},p("div",{onClick:()=>this.emojiPick(":wink:"),"data-tooltip":":wink:",class:"emoji-picker--item emoji--wink"}))):null}focus(){this.props.disabled||(this.refMessageInput.current&&this.refMessageInput.current.focus(),setTimeout(()=>{this.refMessageInput.current&&this.refMessageInput.current.focus()}),setTimeout(()=>{this.refMessageInput.current&&this.refMessageInput.current.focus()},100))}renderEmoji(){return p("div",null,this.renderEmojiPopup(),p("div",{class:"message-input--button message-input--emoji-button",onClick:t=>this.toggleEmoji(t)}))}toggleEmoji(t){t.stopPropagation(),this.focus(),this.props.disabled||this.setState({openEmoji:!this.state.openEmoji})}emojiPick(t){const e=this.refMessageInput.current,r=e.selectionStart,i=this.refMessageInput.current.value;this.setState({openEmoji:!1}),this.refMessageInput.current.value=[i.slice(0,r),t,i.slice(r)].join(""),this.resizeInput(),e.focus()}onKeyup(t){13===t.keyCode&&!1===t.shiftKey&&this.onEnter(),this._forceUpdate(),this.sendTyping()}onKeydown(t){this.resizeInput(),13===t.keyCode&&!1===t.shiftKey&&t.preventDefault()}selectFile(){this.props.disabled||this.refFileInput.current.click()}sendFile(){let t=this.refFileInput.current;this._sendFile(t.files),t.value=""}_sendFile(t){if(0===a.a.size(t))return;if(this.props.disabled)return;let e=a.a.map(t,t=>({type:"file",mimetype:t.type,name:t.name,_file:t,size:t.size}));this.props.onSend&&this.props.onSend({attachments:e})}async submitMessage(t){(t=t||a.a.trim(this.refMessageInput.current.value)||"")&&(this.props.disabled||(this.refMessageInput.current.value="",this.resizeInput(),this.setState({openEmoji:!1}),this.props.onSend&&this.props.onSend({text:t,format:"plaintext"})))}sendTyping(){if(this.props.cid)return this.props.store.typing(this.props.cid)}pasteImage(t){if(!(window.File&&window.FileReader&&window.FileList&&window.Blob))return;const e="Paste-image-"+V(new Date).format("YYYY-MM-DD-HH-mm-ss");let r=null;const i=t.clipboardData.items[0];if(0===i.type.indexOf("image")&&(r=i.getAsFile()),!r)return;const n=[r,new ArrayBuffer],s=new File(n,e+".png",{type:"image/png"});this._sendFile([s])}}class Q extends D{constructor(t){super(t)}render(){var t=a.a.get(this.props.ev,"data.message.attachments",[]),e=[];let r=a.a.get(this.props.ev,"by.type");if(a.a.each(t,(t,r)=>{if(t&&a.a.includes(t.mimetype,"image")&&t.url){var i=t.url;i.startsWith("https://")||i.startsWith("http://")||i.startsWith("content://")||i.startsWith("data:")||(t.url=this.props.store.FileURL+i),e.push(t)}}),0===e.length)return null;var i=a.a.map(e,(t,e)=>p("div",{class:"image-attachment image-attachment--"+r},p("a",{href:this.props.store.replaceFileUrl(t.thumbnail_url||t.url),target:"_blank"},p("img",{class:"image-attachment__img",src:this.props.store.replaceFileUrl(t.thumbnail_url||t.url),onload:t=>this.props.onLoad&&this.props.onLoad()}))));return p("div","agent"===r?{class:"message-agent"}:{class:"message-user"},i)}}class Z extends D{constructor(t){super(t)}render(){let t=a.a.get(this.props.ev,"by.type");var e=a.a.get(this.props.ev,"data.message.attachments",[]),r=[];if(a.a.each(e,(t,e)=>{t&&a.a.includes(t.mimetype,"audio")&&r.push(t)}),0===r.length)return null;var i=a.a.map(r,(e,r)=>p("div",{key:r,class:"audio-attachment audio-attachment--"+t},p("audio",{class:"audio-attachment__audio",controls:!0},p("source",{src:this.props.store.replaceFileUrl(e.url),type:e.mimetype}))));return p("div",{class:"message-"+t},i)}}class K extends D{constructor(t){super(t)}render(){var t=a.a.get(this.props.ev,"by.type","agent"),e=a.a.get(this.props.ev,"data.message.attachments",[]),r=[];if(a.a.each(e,t=>{t&&(t.url||t._file)&&(a.a.includes(t.mimetype,"video")||a.a.includes(t.mimetype,"audio")||a.a.includes(t.mimetype,"image")||"button"===t.type||"quick_replies"===t.type||"form"===t.type||"form_submit"===t.type||r.push(t))}),0===r.length)return null;var i=a.a.map(r,(e,r)=>p("div",{key:r,class:"file-attachment file-attachment--"+t},p("a",{class:"file-attachment--link",href:this.props.store.replaceFileUrl(e.url),target:"_blank"},p("span",{class:"file-attachment--download mr-2"}),p("span",{class:"file-attachment--filename"},e.name))));return p("div",{class:"message-"+t},i)}}class X extends D{constructor(t){super(t)}render(){if(0===a.a.size(this.props.buttons))return null;var t=a.a.map(this.props.buttons,(t,e)=>"call_button"===t.type?p("a",{class:"url-button-attachment",href:"tel:"+t.phone_number,key:e,title:t.title},t.title):"url_button"===t.type?p("a",{class:"url-button-attachment",href:t.url,target:"_blank",key:e,title:t.title},t.title||t.url):"postback_button"===t.type?p("a",{class:"url-button-attachment",href:"javascript:;",onClick:e=>this.props.onSelect(t)},t.title):("widget_ask_desktop_notify_button"===t.type||t.type,null));return p("div",{class:"button-attachments"},t)}}class tt extends D{constructor(t){super(t)}render(){if("user"===a.a.get(this.props.ev,"by.type"))return null;let t=[],e=a.a.get(this.props.ev,"data.message.attachments",[]);return a.a.each(e,(e,r)=>{e&&"button"===a.a.get(e,"type")&&a.a.each(a.a.get(e,"buttons")||[],e=>t.push(e))}),p(X,{store:this.props.store,buttons:t})}}class et extends D{constructor(t){super(t)}render(){if("user"===a.a.get(this.props.ev,"by.type"))return null;let t=[];if(a.a.map(a.a.get(this.props.ev,"data.message.attachments",[]),e=>{e&&"quick_replies"===e.type&&(t=a.a.get(e,"quick_replies",[]))}),t=a.a.filter(t,t=>t.title),0===t.length)return null;let e=a.a.convoOfEv(this.props.ev),r=this.props.store.matchConvo(e);if("ended"===a.a.get(r,"state"))return null;let i=a.a.map(this.props.store.listEvents(e));i=a.a.orderBy(i,"created","asc").filter(t=>"message_sent"===t.type);let n=0;for(var s=0;s<i.length;s++)if(i[s].id===this.props.ev.id){n=s;break}for(s=n+1;s<i.length;s++)if("user"===a.a.get(i[s],"by.type"))return null;let o=a.a.map(t,t=>p("div",{class:"message_quick_reply",onClick:e=>this.props.onSelect(t)},t.title));return p("div",{class:"message_quick_replies"},o)}}class rt extends D{constructor(t){super(t),this.setWrapperRef=this.setWrapperRef.bind(this),this.onClick=this.onClick.bind(this)}componentDidMount(){document.addEventListener("mousedown",this.onClick)}componentWillUnmount(){document.removeEventListener("mousedown",this.onClick)}setWrapperRef(t){this.wrapperRef=t}onClick(t){this.wrapperRef&&!this.wrapperRef.contains(t.target)&&this.props.onClickaway&&this.props.onClickaway()}render(){return p("div",{ref:this.setWrapperRef},this.props.children)}}class it extends D{constructor(t){super(t),this.setState({search:"",isShow:!1})}render(){let t=a.a.filter(this.props.items,t=>{let e=this.state.search.toLowerCase();return(t||"").toLowerCase().indexOf(e)>-1}),e=a.a.map(t,t=>p("li",{class:"custom-select--item-options",onClick:()=>this.add(t)},t)),r=a.a.map(this.props.selected,(t,e)=>p("div",{class:"custom-select--selected-item",onClick:t=>this.remove(t,e)},t,p("i",{class:"icn-delete delete-tag"}))),i=p("div",{class:"custom-select--wrap-options"},p("input",{onClick:t=>{t.preventDefault(),t.stopPropagation(),this.setState({isShow:!0})},type:"text",onInput:t=>this.setState({search:t.target.value}),value:this.state.search,placeholder:"Tm kim",class:"custom-select--input-search"}),p("ul",{class:"custom-select--items-options"},e));return this.state.isShow||(i=null),p("div",{class:"form-control custom-select"},p(rt,{onClickaway:t=>this.clickaway()},p("div",{class:"custom-select--wrap-selected",onClick:()=>this.setState({isShow:!this.state.isShow})},p("div",{class:"custom-select--selected-items"},r),i,p("div",{class:"custom-select--icon-dropdown"},p("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},p("g",{opacity:"0.6"},p("path",{d:"M7 9.5L12 14.5L17 9.5H7Z",fill:"black"})))))))}clickaway(){this.setState({isShow:!1})}add(t){this.props.onAddItem&&this.props.onAddItem(t)}remove(t,e){t.preventDefault(),t.stopPropagation(),this.props.onRemoveItem&&this.props.onRemoveItem(e)}}class nt extends D{constructor(t){super(t),this.props.store.onUpdate(this,t=>this.forceUpdate());let e=this.props.store.matchUser(),r=a.a.get(this.props.form,"fields")||[],i=a.a.map(r,t=>{let r=t.is_required||!1;var i=a.a.parseJSON(t.state)||{};r||(r=i.require||!1);var n=a.a.getUserAttr(e,t.name,i.type||"text");return{name:t.name,items:t.items,value:a.a.parseJSON(t.answer)||a.a.parseJSON(t.default_answer)||n,is_required:r,label:t.title,type:t.input_type}});this.setState({formData:i})}isSummited(){return!!a.a.find(this.state.formData,t=>!!t.answered)||"ended"===this.props.store.matchConvo(a.a.convoOfEv(this.props.ev)).state}render(){if(0===a.a.size(this.state.formData))return null;let t=this.renderFields(),e=null;return this.isSummited()||(e=p("div",{class:"mt-2"},p("button",{onClick:t=>this.submit(),type:"button",class:"form-attachment--submit-btn"},this.$t("btn_submit_form_attachment")))),p("div",{class:"form-attachment",onClick:t=>t.stopPropagation()},this.$t(this.props.form.title)||this.$t("capture_lead_title"),t,e)}focus(){if(this.props.store.isPreview)return;if(0===a.a.size(this.state.formData))return;let t;if(this.isFormFilled()){var e=Object.keys(this.state.formData),r=e[a.a.size(e)-1];t=this["field."+st(this.state.formData[r].name)]}else{var i=this.firstUnfilledField();if(!i)return;t=this["field."+st(i.name)]}t&&t.focus()}firstUnfilledField(){return a.a.find(this.state.formData,t=>null==t.value||""===t.value)}isFormFilled(){return!a.a.find(this.state.formData,t=>null==t.value||""===t.value)}onInputChange(t,e){let r=a.a.cloneDeep(this.state.formData);r[t].value=e,this.setState({formData:r})}onListAddItem(t,e){let r=a.a.cloneDeep(this.state.formData),i=r[t];i.value=i.value||[],i.value.push(e),this.setState({formData:r})}onListRemoveItem(t,e){let r=a.a.cloneDeep(this.state.formData),i=r[t];i.value=i.value||[],i.value.splice(e,1),this.setState({formData:r})}renderFields(){if(0===a.a.size(this.state.formData))return null;let t=null;return t=a.a.map(this.state.formData,(t,e)=>{let r=null;var i=t.error?"input--error":"";if("text"===t.type)r=this.isSummited()?p("div",{class:"form-control--container"},p("input",{disabled:!0,ref:e=>{this["field."+st(t.name)]=e},value:t.value,onInput:t=>this.onInputChange(e,t.target.value),class:"form-control "+i,type:"text"}),p("i",{class:"form-control--check"})):p("input",{ref:e=>{this["field."+st(t.name)]=e},value:t.value,onInput:t=>this.onInputChange(e,t.target.value),class:"form-control "+i,type:"text"});else if("number"===t.type)r=this.isSummited()?p("div",{class:"form-control--container"},p("input",{disabled:!0,ref:e=>{this["field."+st(t.name)]=e},value:t.value,onInput:t=>this.onInputChange(e,t.target.value),class:"form-control "+i,type:"number"}),p("i",{class:"form-control--check"})):p("input",{ref:e=>{this["field."+st(t.name)]=e},value:t.value,onInput:t=>this.onInputChange(e,t.target.value),class:"form-control "+i,type:"number"});else if("boolean"===t.type)r=p("div",{class:"checkbox"},p("input",{ref:e=>{this["field."+st(t.name)]=e},type:"checkbox",id:"checkbox."+this.props.ev.id+"."+t.name,onChange:t=>this.onInputChange(e,ev.target.checked),checked:t.value}),p("label",{class:"checkbox--label",for:"checkbox."+this.props.ev.id+"."+t.name},t.label),p("div",{class:"checkbox--check"},p("div",null)));else if("list"===t.type){let i=t.value||[],n=a.a.filter(a.a.get(t,"items",[]),t=>!i.includes(t));r=p(it,{selected:i,items:n,onAddItem:t=>onListRemoveItem(e,t),onRemoveItem:t=>this.onListRemoveItem(e,t)})}else"datetime"===t.type&&(r=p("input",{ref:e=>{this["field."+st(t.name)]=e},value:t.value,onInput:t=>this.onInputChange(e,t.target.value),class:"form-control "+i,type:"date"}));let n=t.label;return"fullname"===t.name?n=this.$t("fullname"):"emails"===t.name?n=this.$t("email"):"phones"===t.name&&(n=this.$t("phones")),p("div",null,p("p",{class:"label mt-3"},n,t.is_required?p("span",{class:"ml-1 red"},"*"):""),t.error?p("div",{class:"form-control--valid-input--error"},t.error):"",r)}),p("div",null,t)}async submit(){var t=!1;if(a.a.map(this.state.formData,e=>{e.is_required&&(void 0===e.value||""===e.value||0===a.a.size(e.value)&&Array.isArray(e.value))?(e.error=this.$t("error_empty"),t=!0):e.error="","emails"===e.name&&e.value&&(a.a.isEmail(e.value)||(e.error=this.$t("error_email_invalid"),t=!0))}),this.forceUpdate(),t)return;let e={},r=a.a.cloneDeep(this.state.formData);a.a.map(r,t=>{var r={key:t.name};t.answered=(new Date).getTime(),"number"===t.type&&(r.number=parseInt(t.value),t.answer=a.a.stringify(r.number)),"datetime"===t.type&&(r.datetime=new Date(t.value).toISOString(),t.answer=a.a.stringify(r.datetime)),"list"===t.type&&(r.list=t.value,t.answer=a.a.stringify(r.list)),"text"!==t.type&&"boolean"!==t.type||(r[t.type]=t.value,t.answer=a.a.stringify(t.value)),a.a.setUserAttr(e,r)}),a.a.map(r,t=>{let e=a.a.find(this.props.form.fields,e=>e.name===t.name);e&&(e.answered=t.answered)}),this.setState({formData:r}),this.props.store.setUser(e);let i={attachments:[{type:"form_submit",form_submit:{state:'{"user_id":"'+this.props.store.matchUser().id+'"}',form_message_id:a.a.get(this.props.ev,"id"),fields:r}}]},n=a.a.convoOfEv(this.props.ev);this.props.store.sendConvoEvent(n,"message_sent",{message:i}),this.props.onSubmit&&this.props.onSubmit()}}function st(t){return btoa(t).split("=").join("")}class ot extends D{constructor(t){super(t)}render(){if("user"===a.a.get(this.props.ev,"by.type"))return;let t=[],e=a.a.get(this.props.ev,"data.message.attachments")||[];a.a.each(e,e=>{e&&("form"!==e.type&&"ask_info_form"!==e.type||(e.form._type=e.type,t.push(e.form)))});let r=a.a.map(t,(t,e)=>p(nt,{store:this.props.store,onSubmit:this.props.onSubmit,ref:t=>{this["form."+e]=t},key:e,form:t,ev:this.props.ev}));return 0===r.length?null:p("div",{class:"message-agent"},r)}focus(){var t=this["form.0"];t&&t.focus()}}class at extends D{constructor(t){super(t)}render(){return null}}function ut(t){return t.touches&&t.touches.length?t.touches[0]:{}}class ct extends D{constructor(t){super(t),this.state={focusing:0},this.galleryRef={current:null}}componentDidMount(){this.bindDrag()}focus(t){this.setState({focusing:t}),this.galleryRef.current.scrollTo({left:190*t-20,behavior:"smooth"})}render(){if("user"===a.a.get(this.props.ev,"by.type"))return null;let t=a.a.get(this.props.ev,"data.message.attachments",[]),e=a.a.filter(t,t=>"generic"===a.a.get(t,"type"));return 0===e.length?null:a.a.map(e,(e,r)=>{var i=a.a.map(e.elements,t=>{let e=t.title?p("div",{class:"generic-attachment--element-title"},t.title):null,r=t.subtitle?p("div",{class:"generic-attachment--element-subtitle"},t.subtitle):null;return p("div",{class:"generic-attachment--element swiper-slide"},p("div",null,p("img",{class:"generic-attachment--element-img",src:this.props.store.replaceFileUrl(t.image_url)})),e,r,p(X,{buttons:t.buttons,onSelect:t=>this.props.onSelect(t)}))});let n=a.a.get(t,"0.elements",[]),s="generic-attachment-navigator generic-attachment-navigator--left",o="generic-attachment-navigator generic-attachment-navigator--right";return 0===this.state.focusing&&(s+=" generic-attachment-navigator--disabled"),this.state.focusing===n.length-1&&(o+=" generic-attachment-navigator--disabled"),p("div",{class:"generic-attachment-container"},p("div",{class:"generic-attachment",ref:this.galleryRef},i),!a.a.isMobile()&&p(m,null,p("div",{class:s,onClick:t=>this.focus(this.state.focusing-1)},p("span",{class:"generic-attachment-navigator-icon"},"")),p("div",{class:o,onClick:t=>this.focus(this.state.focusing+1)},p("span",{class:"generic-attachment-navigator-icon"},""))))})}bindDrag(){if(!a.a.isMobile())return;let t=document.getElementsByClassName("generic-attachment");a.a.map(t,t=>{var e,r,i;(e=t)&&(e.removeEventListener("touchstart",e.md,0),window.removeEventListener("touchend",e.mu,0),window.removeEventListener("touchmove",e.mm,0),e.md=function(t){let n=ut(t);e.hasAttribute("nochilddrag")&&document.elementFromPoint(n.pageX,n.pageY)||(i=1,r=n.clientX,t.preventDefault())},e.mu=()=>{i=0},e.mm=function(t){if(!i)return;let n=ut(t);e.scrollLeft-=-r+n.clientX,r=n.clientX},e.addEventListener("touchstart",e.md,0),window.addEventListener("touchend",e.mu,0),window.addEventListener("touchmove",e.mm,0))})}}class lt extends D{constructor(t){super(t)}render(){let t=a.a.get(this.props.ev,"by.type");var e=a.a.get(this.props.ev,"data.message.attachments",[]),r=[];if(a.a.each(e,(t,e)=>{t&&a.a.includes(t.mimetype,"video")&&r.push(t)}),0===r.length)return null;var i=a.a.map(r,(e,r)=>p("div",{class:"video-attachment video-attachment--"+t},p("video",{class:"video-attachment__video",src:this.props.store.replaceFileUrl(e.url),width:"100%",height:"",poster:this.props.store.replaceFileUrl(e.thumbnail_url),controls:"controls",preload:"metadata",onclick:"this.play()"})));return p("div",{class:"message-"+t},i)}}class ht extends D{constructor(t){super(t),this.ref={current:null}}componentDidMount(){this.shadowRoot=this.ref.current.attachShadow({mode:"open"}),this.update(this.props.html)}update(t){this.shadowRoot.innerHTML=`<style type="text/css">\nbody { font-family: 'Roboto', sans-serif!important; font-size: 14px!important; line-height: 20px; overflow-y: hidden; margin:0 }\nh{ font-size: 14/18px!important; }\na { text-decoration: none;}\nimg { max-width: 100%; display: block; margin: 10px auto; }\n* { white-space: normal }\nul > li { margin-bottom: 5px }\nul:last-child { margin-bottom: 0 }\np:first-child { margin-top: 0;}\np:last-child { margin-bottom: 0;}\n</style>\n<div>${t}</div>`;let e=this.shadowRoot.querySelectorAll("a");for(var r=0;r<e.length;r++)e[r].target="_blank"}render(){return p("div",{ref:this.ref,style:"white-space: normal !important"})}}let dt=[],pt=(t,e)=>(dt.push(t),"");(async()=>{let t=(await r.e(71).then(r.t.bind(null,261,7))).default;pt=(e,r)=>t(r),a.a.map(dt,t=>t.forceUpdate()),dt=[]})();class ft extends D{render(){if("markdown"===a.a.get(this.props.ev,"data.message.format","plaintext"))return this.renderMarkdown();var t=a.a.get(this.props.ev,"data.message.text");if(t=a.a.trim(t),0===a.a.size(t))return null;let e=a.a.get(this.props.ev,"by.type");var r=a.a.extractText(t).map(t=>"emoji"===t.type?p(L,{emojiCode:t.text,byType:e}):"link"===t.type?p("a",{href:t.text,target:"_blank"},t.text):"phone"===t.type?p("a",{href:"tel:"+t.text},t.text):"email"===t.type?p("a",{href:"mailto:"+t.text},t.text):t.text);return 0===a.a.size(r)?null:p("div","agent"===e?{class:"message-agent message-text--agent"}:{class:"message-user message-text--user"},r)}renderMarkdown(){var t=a.a.get(this.props.ev,"data.message.text");if(0===a.a.size(t))return null;let e=a.a.get(this.props.ev,"by.type");return t=a.a.trim(t),0===a.a.size(t)?null:"agent"===e?p("div",{class:"markdown-message message-agent message-text--agent"},p(ht,{html:pt(this,t)})):p("div",{class:"d-flex flex-column align-items-end"},p("div",{class:"markdown-message message-user message-text--user"},p(ht,{html:pt(this,t)})))}}var mt=r(11),gt=r(81);mt.extend(gt);var vt=new a.a.Pubsub;setInterval(()=>vt.publish("time"),2e4);class yt extends D{constructor(t){super(t),this.setState({t:"",langCode:"en_US"})}updateTime(){var t="";t=this.props.ago?this.props.time>0?mt(this.props.time).fromNow():"":a.a.shortTime(this.props.time,this.props.tzoffset),this.props.uppercase&&(t=t.toUpperCase()),t!==this.state.t&&this.setState({t:t})}componentDidMount(){vt.on2(this,"time",()=>this.updateTime()),this.updateTime()}render(){return p("span",null,this.state.t)}}class _t extends D{render(){let t=this.props.ev.ev;var e=null;if(this.props.ev.show_time&&(e=p("div",{class:"convo-event-time"},p(yt,{time:t.created}))),"conversation_rated"===t.type){var r=a.a.get(t,"data.conversation.ratings.0",{no_rating:!0,rating:0});return r.no_rating?null:p("div",{class:"convo-event"},e,p("div",{class:"info-message"},this.$t("rated_as")+" "+this.$t(function(t){return t?t<2?"poor":t<4?"average":"great":"poor"}(r.rating)).toLowerCase()))}return"conversation_state_updated"===t.type&&"ended"===a.a.get(t,"data.conversation.state")?p("div",{class:"convo-event"},e,p("div",{class:"info-message"},this.$t("conversation_ended"))):null}}class bt extends D{constructor(t){super(t),this.refForm={current:null}}render(){var t=a.a.get(this.props.event,"ev",{});switch(t.type){case"conversation_joined":break;case"message_sent":return this.renderMessageSent();case"conversation_state_updated":case"conversation_rating_requested":case"conversation_rated":return a.a.startsWith(t.id,"ev")?p(_t,{store:this.props.store,ev:this.props.event}):null}return null}focus(){this.refForm.current&&this.refForm.current.focus()}chooseQuickReply(t){let e=a.a.get(this.props.event,"ev",{}),r={text:t.title,format:"plaintext"};t.payload&&(r.attachments=[{type:"postback",postback:{event_id:e.id,payload:t.payload}}]),this.props.onSend(r)}choosePostbackBtn(t){let e=a.a.get(this.props.event,"ev",{}),r={text:t.title,format:"plaintext"};t.payload&&(r.attachments=[{type:"postback",postback:{event_id:e.id,payload:t.payload}}]),this.props.onSend(r)}renderAgentAvatar(t){let e=a.a.get(t,"by.type"),i=a.a.get(t,"by.display_id",a.a.get(t,"by.id"));if("user"===e)return null;var n=this.getSenderName(t);let s=this.props.store.matchAccount();var o=s.logo_url||r(47);let u=this.props.store.matchAgent("*");return"system"===i&&"dummy"===e||(o=a.a.get(u[i],"avatar_url")||s.logo_url||r(6)),p("div",{class:"message-sender"},p("img",{class:"message-sender-avatar",src:this.props.store.replaceFileUrl(o)}),p("p",{class:"message-sender-name"},n))}renderMessageSent(){let t=this.props.event.ev;var e=null;if(this.props.event.show_time&&(e=p("div",{class:"convo-event-time"},p(yt,{time:t.created}))),"user"!==a.a.get(t,"by.type")){let r=null;return"lead"===this.props.event.mode&&(r=this.renderAgentAvatar(t)),p("div",{class:"convo-event agent-message"},e,r,p(ft,{store:this.props.store,ev:t}),p(Q,{store:this.props.store,ev:t}),p(Z,{store:this.props.store,ev:t}),p(lt,{store:this.props.store,ev:t}),p(K,{store:this.props.store,ev:t}),p(tt,{store:this.props.store,ev:t}),p(ot,{store:this.props.store,onSubmit:this.props.onFormSubmit,ref:this.refForm,ev:t}),p(at,{store:this.props.store,ev:t}),p(ct,{store:this.props.store,ev:t,onSelect:t=>this.choosePostbackBtn(t)}),p(et,{store:this.props.store,ev:t,onSelect:t=>this.chooseQuickReply(t)}))}a.a.getMsgField(t,"idempotency")===t.id&&this.props.store.now()-t.created<900&&setTimeout(()=>this.setState({refresh:this.state.refresh}),1e3);let r=p("div",{class:"sending_dot"});(this.props.store.now()-t.created<900||a.a.getMsgField(t,"idempotency")!==t.id)&&(r=p("div",{class:"sending_dot sending_dot__hide"}));let i=null;"lead"===this.props.event.mode&&(i=p("div",{class:"pt-3"}));let n=null;return t._error&&"message_sent"===t.type&&(n=p("a",{class:"message_error",src:"javascript:;",onClick:t=>this.resendMessage()},p("div",{class:"message_error__text"},this.$t("error_send_message")),p("div",{class:"message_error__icon"}))),p("div",{class:"convo-event user-message"},e,i,p("div",{class:"message-user__container"},r,p(ft,{store:this.props.store,ev:t,refresh:this.state.refresh}),p(Q,{store:this.props.store,ev:t}),p(Z,{store:this.props.store,ev:t}),p(lt,{store:this.props.store,ev:t}),p(K,{store:this.props.store,ev:t}),p(tt,{store:this.props.store,ev:t}),p(ot,{store:this.props.store,onSubmit:this.props.onFormSubmit,ref:this.refForm,ev:t}),p(at,{store:this.props.store,ev:t})),n)}renderUpdateConvo(t){var e=a.a.get(t,"data.conversation.state");return"active"===e||"pending"===e?null:p("div",{class:"message-system"},this.$t("conversation_state_updated",{state:e}))}resendMessage(){let t=a.a.convoOfEv(this.props.event.ev);const e=a.a.get(this.props.event,"ev.data.message");this.props.store.sendConvoEvent(t,"message_sent",{message:e})}getSenderName(t){let e=a.a.get(t,"by.type"),r=a.a.get(t,"by.display_id",a.a.get(t,"by.id"));if("system"===r||"dummy"===e)return"system";let i=this.props.store.matchUser(),n=this.props.store.matchAccount();return"user"===e?a.a.getUserDisplayName(i):"agent"===e?a.a.getAgentDisplayName(n,this.props.store.matchAgent(r)):""}}const wt=r(83);class kt extends D{render(){let t=(this.props.mode+"").toLowerCase(),e="dark"===t?"#000000dd":"blue"===t?"rgba(52, 152, 220, .8)":"#ffffffdd",r="dark"===t?"#00000055":"blue"===t?"rgba(52, 152, 220, .15)":"#ffffff55",i=this.props.size||14,n=`width: ${i}px !important;height: ${i}px!important;color: ${r} !important;border-width: ${Math.ceil(i/14)}px !important;\n    border-left-color: ${r} !important;border-top-color: ${r} !important;\n    border-bottom-color: ${r} !important;border-right-color: ${e} !important;`;if(this.props.static){let t=`width: ${i}px;height: ${i}px;`;return i<40?p(LoaderIcon,{size:i+"",style:"stroke:"+e}):this.props.center?p("div",{class:"loading"},p("img",{style:t,src:wt})):p("img",{style:t,src:wt})}return p("div",{class:"spinner1",style:n})}}const St=r(82);class xt extends D{constructor(t){super(t),this.props.store.onUpdate(this,t=>this.forceUpdate()),this.props.store.onConvoEvent(this,t=>this.onEvent(t)),this.loadConvo(),this.refBody=null,this.checkAndSeen=a.a.throttle(()=>{this.props.isShow&&this.isBottom()&&"visible"===this.props.store.browserVisibility&&document.hasFocus()&&this.props.store.seenConvo(this.props.cid)},500)}componentDidUpdate(t){t.cid!==this.props.cid&&this.loadConvo()}render(){if(this.state.error)return this.renderError();if(this.state.loading||this.props.creating)return p(kt,{static:!0,mode:"blue",size:"120",center:!0});let t=a.a.map(this.props.store.listEvents(this.props.cid));if(t=a.a.orderBy(t,"created","asc"),0===a.a.size(t))return p("div",{ref:t=>this.refBody=t,class:"widget-body--events-container"},p("div",{class:"widget-body--empty"},p("div",{class:"widget-body--empty-icon"}),p("div",{class:"widget-body--empty-text"},this.$t("empty_convo_text"))),p(W,{store:this.props.store}));let e=this.props.store.matchConvo(this.props.cid);t=a.a.map(t,t=>({ev:t})),function(t,e){if((e=e.filter(t=>Mt(t.ev))).length<1)return;for(var r=1;r<e.length;r++){let t=e[r],i=e[r-1];if(Mt(t.ev)){a.a.unixSec(t.ev.created)-a.a.unixSec(i.ev.created)>120&&(t.show_time=!0)}}for(r=0;r<e.length;r++){let t=e[r];if("message_sent"===a.a.get(t,"ev.type")){t.show_time=!0;break}}for(r=0;r<e.length;r++){let t=e[r],i=e[r-1];"message_sent"!==t.ev.type||(t.mode="lead","message_sent"===a.a.get(i,"ev.type")&&a.a.get(i,"ev.by.id")===a.a.get(t,"ev.by.id")&&(t.mode="follow"))}let i=a.a.usersOfConvo(t),n=0;for(r=e.length-1;r>=0&&(n=r,!i.includes(a.a.get(e[r],"ev.by.id")));r--){if(a.a.find(a.a.get(e[r],"ev.data.message.pongs"),t=>"seen"===t.type&&i.includes(t.member_id)))break}}(e,t);let r=a.a.map(t,t=>p(bt,{store:this.props.store,onFormSubmit:this.props.onFormSubmit,onSend:this.props.onSend,onPostback:this.props.onPostback,event:t,key:t.ev.id}));return p("div",{ref:t=>this.refBody=t,class:"widget-body--events-container",onMouseOver:this.checkAndSeen},p("div",{class:"widget-body--events"},r),p(W,{store:this.props.store}))}renderError(){let t=p("a",{href:"#",onclick:t=>this.loadConvo()},this.$t("try_again"));return this.state.loading&&(t=p(kt,{size:"16",mode:"blue"})),p("div",{class:"widget-body--events-container widget-body--events-container__error"},p("img",{src:St}),p("div",{class:"widget_body__events__error_msg"},this.$t("load_convo_error")),p("div",{class:"widget_body__events__error_retry"},t))}focus(){let t=this.props.store.listEvents(this.props.cid);var e;t=a.a.orderBy(a.a.map(t),"created","desc");for(let r of t)if("message_sent"===a.a.get(r,"type")&&"user"!==a.a.get(r,"by.type")){e=r;break}"user"===a.a.get(e,"by.type")&&(e=null);let r=a.a.get(e,"data.message.attachments",[]),i=this.props.store.matchConvo(this.props.cid);a.a.filter(r,t=>{if(!t)return!1;if("form"!==t.type&&"ask_info_form"!==t.type)return!1;var e=t.form;return!!e&&(!(!(a.a.parseJSON(e.state)||{}).require_finished&&"ask_info_form"!==t.type)&&(!function(t){let e=a.a.get(t,"fields")||[];return a.a.find(e,t=>!!t.answered)}(t.form)&&"ended"!==i.state))})}onEvent(t){if(a.a.convoOfEv(t)!==this.props.cid)return;let e=this.isBottom();var r=!1;"message_sent"===a.a.get(t,"type")&&t.id===a.a.getMsgField(t,"idempotency")&&(r=!0),(r||e)&&this.scrollToBottom()}async loadConvo(){if(!this.props.cid)return;this.lastContentOffsetY=0;let t=this.props.store.listEvents(this.props.cid);if(0===a.a.size(t)){let t=this.props.cid;this.setState({loading:!0});let{error:e}=await this.props.store.fetchMoreEvents(t);if(this.setState({loading:!1}),t!==this.props.cid)return;if(e)return void this.setState({error:!0})}this.props.store.fetchMoreEvents(this.props.cid),this.setState({error:!1}),this.scrollToBottom()}isBottom(){let t=this.refBody;return!!t&&t.scrollHeight<t.scrollTop+t.offsetHeight+50}scrollToBottom(){setTimeout(()=>{setTimeout(()=>{const t=this.refBody;t&&t.scrollTo({top:t.scrollHeight})})}),setTimeout(()=>{const t=this.refBody;t&&t.scrollTo({top:t.scrollHeight,behavior:"smooth"})},200),this.props.isShow&&"visible"===this.props.store.browserVisibility&&document.hasFocus()&&this.props.store.seenConvo(this.props.cid)}}function Mt(t){let e=a.a.get(t,"type");return"message_sent"===e||"conversation_state_updated"===e}class At extends D{constructor(t){super(t)}componentDidMount(){this.setState({isShow:!1,ev:{}}),this.props.store.onConvoEvent(this,t=>{if(a.a.convoOfEv(t)!==this.props.cid)return;let e=this.props.store.matchUser();if(a.a.get(t,"by.id")===e.id)return;let r=a.a.get(this.state.ev,"by.id");return r&&a.a.get(t,"by.id")!==r?void 0:"message_sent"===a.a.get(t,"type")?(this.timer&&clearTimeout(this.timer),this.timer=null,void this.setState({isShow:!1})):void("conversation_typing"===a.a.get(t,"type")&&(this.setState({ev:t,isShow:!0}),this.timer&&clearTimeout(this.timer),this.timer=setTimeout(()=>{a.a.convoOfEv(t)===this.props.cid&&(this.timer=null,this.setState({isShow:!1}))},1e4)))})}render(){let t=this.props.store.matchAccount();var e=this.state.isShow?"":"typing--hidden";let r=a.a.get(this.state.ev,"by.display_id",a.a.get(this.state.ev,"by.id"));return p("div",{class:"typing "+e},a.a.getAgentDisplayName(t,this.props.store.matchAgent(r))," ",this.$t("typing"))}}var Ct=r(84);class Ft extends D{constructor(t){super(t),this.refComment={current:null},this.refRating={current:null},this.refHandle={current:null}}componentDidMount(){this.setState({hide:!0,ratingHeight:0,overlayOpacity:.3,comment:""}),this.props.store.onUpdate(this,()=>{this.shoudDisplay()&&this.open()}),this.props.store.onConvoEvent(this,t=>{a.a.convoOfEv(t)===this.props.cid&&this.shoudDisplay()&&this.open()}),this.mouseUp=t=>this.onMouseUp(t),this.mouseMove=t=>this.onMouseMove(t),this.mouseDown=t=>this.onMouseDown(t);var t=this.refHandle.current;t.addEventListener("mousedown",this.mouseDown,0),t.addEventListener("touchstart",this.mouseDown,0),window.addEventListener("mouseup",this.mouseUp,0),window.addEventListener("touchend",this.mouseUp,0),window.addEventListener("mousemove",this.mouseMove,0),window.addEventListener("touchmove",this.mouseMove,0),this.animation=new Ct({maxY:400,minY:0,duration:150}),this.close(),this.shoudDisplay()&&this.open()}componentWillUnmount(){var t=this.refHandle.current;t.removeEventListener("mousedown",this.mouseDown,0),t.removeEventListener("touchstart",this.mouseDown,0),window.removeEventListener("mouseup",this.mouseUp,0),window.removeEventListener("touchend",this.mouseUp,0),window.removeEventListener("mousemove",this.mouseMove,0),window.removeEventListener("touchmove",this.mouseMove,0)}render(){return p("div",{class:this.state.hide?"d-none":""},p("div",{class:"rating--overlay",style:`opacity: ${.5*this.state.overlayOpacity} !important;`}),p("div",{class:"rating",ref:this.refRating,style:`color:red; height: ${this.state.ratingHeight}px !important;`},p("div",{class:"rating--handle",ref:this.refHandle},p("div",{class:"rating--thumb"})),p("div",{class:"rating--content"},p("div",{class:"rating--heading"},this.$t("rating_title"),p("div",{class:"rating--close-btn",onClick:t=>this.onCloseRating(t)})),p("div",{class:"rating--description"},this.$t("rating_description")),p("textarea",{ref:this.refComment,type:"text",class:"rating--comment"}),p("div",{class:"rating-faces-container"},p("div",{class:"rating-face-container",onClick:t=>this.onRatingPoor(t)},p("img",{src:r(85)}),p("p",{class:"rating-face--text"},this.$t("poor"))),p("div",{class:"rating-face-container",onClick:t=>this.onRatingAverage(t)},p("img",{src:r(86)}),p("p",{class:"rating-face--text"},this.$t("average"))),p("div",{class:"rating-face-container",onClick:t=>this.onRatingGreat(t)},p("img",{src:r(87)}),p("p",{class:"rating-face--text"},this.$t("great")))),p("div",{class:"rating-no-thanks",onClick:t=>this.onCloseRating(t)},this.$t("no_thanks")))))}shoudDisplay(){if(!this.props.cid)return!1;var t,e,r;let i=this.props.store.matchUser();if(a.a.map(this.props.store.listEvents(this.props.cid),n=>{"conversation_state_updated"===a.a.get(n,"type")&&"ended"===a.a.get(n,"data.conversation.state")&&(r=n),"conversation_rating_requested"===a.a.get(n,"type")&&(t=n),"conversation_rated"===a.a.get(n,"type")&&a.a.get(n,"by.id")===i.id&&(e=n)}),e)return!1;var n=this.props.store.matchAccountSetting().auto_request_rating&&r;return t||n}onCloseRating(){this.props.onRate&&this.props.onRate({no_rating:!0,comment:this.refComment.current.value}),this.close()}onRatingPoor(){this.props.onRate&&this.props.onRate({rating:1,comment:this.refComment.current.value}),this.close()}onRatingAverage(){this.props.onRate&&this.props.onRate({rating:3,comment:this.refComment.current.value}),this.close()}onRatingGreat(){this.props.onRate&&this.props.onRate({rating:5,comment:this.refComment.current.value}),this.close()}open(){if(this.state.hide&&(this.setState({hide:!1}),this.refRating.current)){setTimeout(()=>{this.refComment.current&&this.refComment.current.focus()},400),this.refComment.current.value="";var t=this.refRating.current.currentStyle||window.getComputedStyle(this.refRating.current),e=parseFloat(t.height);this.animation.play(-20,e,t=>{this.setState({ratingHeight:t,overlayOpacity:Math.min(1,(t-0)/500)})})}}close(){if(!this.state.hide&&this.refRating.current){var t=this.refRating.current.currentStyle||window.getComputedStyle(this.refRating.current),e=parseFloat(t.height);this.animation.play(20,e,t=>{this.setState({ratingHeight:t,overlayOpacity:Math.min(1,(t-0)/500)}),t<10&&(this.state.hide||this.setState({hide:!0}))})}}onMouseDown(t){this.mousePushed=!0,this.animation.stop(),t.preventDefault(),t.touches&&t.touches[0]&&(t=t.touches[0]),this.mousePushedDy=t.pageY-window.pageYOffset-this.refRating.current.getBoundingClientRect().y}onMouseUp(t){if(this.mousePushed){t.touches&&t.touches[0]&&(t=t.touches[0]),this.mousePushed=!1;var e=this.refRating.current.currentStyle||window.getComputedStyle(this.refRating.current),r=parseFloat(e.height);this.animation.play(this.mouseVelocity,r,t=>{this.setState({ratingHeight:t,overlayOpacity:Math.min(1,(t-0)/500)}),t<10&&(this.state.hide||(this.setState({hide:!0}),this.props.onRate&&this.props.onRate({no_rating:!0})))})}}onMouseMove(t){if(this.mousePushed){t.touches&&t.touches[0]&&(t=t.touches[0]);var e=t.pageY;this.mouseVelocity=e-this.lastMouseY,this.lastMouseY=e,e-=this.mousePushedDy;var r=this.refRating.current.getBoundingClientRect().bottom-e;if(r>400){r=500-1e4/(r+-300)}this.setState({ratingHeight:r,overlayOpacity:Math.min(1,(r-0)/500)})}}}var Ot=r(78),Pt=r(79),Et=r(80);const jt=r(17).getParser(window.navigator.userAgent).parsedResult;class Tt extends D{constructor(t){super(t),this.setState({creating:!1,clickedJoin:!1,formData:{}}),this.props.store.onUpdate(this,t=>this.forceUpdate())}componentDidMount(){"mobile"!==jt.platform.type&&this.focusInput()}componentDidUpdate(t){t.isShow!==this.props.isShow&&(this.props.isShow&&"mobile"!==jt.platform.type&&this.focusInput(),this.props.isShow&&"mobile"===jt.platform.type&&this.blur()),t.cid!==this.props.cid&&(this.setState({clickedJoin:!1}),setTimeout(()=>{this.events&&this.events.focus(),"mobile"!==jt.platform.type&&this.focusInput()},100))}shouldShowForm(){let t=this.isFormRequired();return t&&!this.props.cid||t&&this.props.cid&&this.state.clickedJoin}render(){this.isFormRequired();let t,e=this.shouldShowForm(),r=this.props.store.matchAccountSetting()||{},i=this.$t("prechat_form_btn");a.a.get(r,"prechat_form.enabled")&&(t=r.prechat_form);let n=a.a.get(r,"offline_form.enabled");!r.is_online&&n&&(t=r.offline_form,i=this.$t("offline_form_btn"));let s=null;s="list"===this.props.view?this.renderConvoList():e?this.renderForm(t,i):this.renderChat();let o=a.a.get(r,"desktop_button.position")||"right";"mobile"===jt.platform.type&&(o=a.a.get(r,"mobile_button.position",o));let u="widget-container widget-container--"+o;return this.props.isShow||(u+=" widget-container--hide"),p("div",{class:u},p(H,{store:this.props.store,cid:this.props.cid,view:this.props.view,onClose:this.props.onClose,onGotoList:()=>this.props.onGo({view:"list"})}),s)}async submitPrechatForm(t){var e=!1;if(a.a.map(this.state.formData,(t,r)=>{t.is_required&&(void 0===t.value||""===t.value||0===a.a.size(t.value)&&Array.isArray(t.value))?(t.error=this.$t("error_empty"),e=!0):t.error="","emails"===r.substr(5)&&!a.a.isEmail(t.value)&&t.is_required&&(t.error=this.$t("error_email_invalid"),e=!0)}),e)return this.forceUpdate();let r=a.a.cloneDeep(this.state.formData),i=a.a.cloneDeep(this.props.store.matchUser());a.a.map(r,(t,e)=>{if(e.startsWith("attr:")){var r={key:e.substr(5)};"number"===t.type&&(r.number=parseInt(t.value)),"datetime"===t.type&&(r.datetime=new Date(t.value).toISOString()),"list"===t.type&&(r.list=t.value),"text"!==t.type&&"boolean"!==t.type||(r[t.type]=t.value),a.a.setUserAttr(i,r)}});let n=a.a.get(r,"question.value"),s=a.a.get(r,"group.value","");if(this.props.cid)return this.props.store.setUser(i),this.setState({clickedJoin:!1}),await this.props.store.sendConvoEvent(this.props.cid,"message_sent",{message:{text:n,format:"plaintext",fields:[{key:"to_agent_group",value:JSON.stringify(s)}]}}),void(t.end_conversation_after_submit&&await this.props.store.endConvo(this.props.cid));this.setState({creating:!0});let o={text:n,format:"plaintext"},u={group_id:s,message:n};this.setState({creatingError:null});const{error:c,convo:l}=await this.props.store.startConvo(u);if(this.props.store.setUser(i),c)return void this.setState({creating:!1,creatingError:c});let h=l.id;this.props.onGo({view:"chat",cid:h}),this.props.store.sendConvoEvent(h,"message_sent",{message:o}),this.setState({creating:!1,clickedJoin:!1}),"mobile"!==jt.platform.type&&this.focusInput()}formMounted(t){let e=this.fillForm(t);e.question={key:"question",is_required:!0,label:t.question_label||this.$t("your_question"),type:"text"},this.setState({formData:e}),"mobile"!==jt.platform.type&&this.focusInput()}onBooleanChange(t,e){let r=a.a.cloneDeep(this.state.formData),i=a.a.find(r,(e,r)=>r===t);i&&(i.value=e.target.value,this.setState({formData:r}))}onInputChange(t,e){let r=a.a.cloneDeep(this.state.formData),i=a.a.find(r,(e,r)=>r===t);i&&(i.value=e,this.setState({formData:r}))}onListAddItem(t,e){let r=a.a.cloneDeep(this.state.formData),i=a.a.find(r,(e,r)=>r===t);i&&(i.value=i.value||[],i.value.push(e),this.setState({formData:r}))}onListRemoveItem(t,e){let r=a.a.cloneDeep(this.state.formData),i=a.a.find(r,(e,r)=>r===t);i&&(i.value=i.value||[],i.value.splice(e,1),this.setState({formData:r}))}renderFields(){if(0===a.a.size(this.state.formData))return null;let t=a.a.map(this.state.formData,(t,e)=>{let r=null;var i=t.error?"input--error":"";if("text"===t.type)r="question"===e?p("textarea",{class:"form-control",ref:t=>{this["form_"+Dt(e)]=t},value:t.value,onInput:t=>this.onInputChange(e,t.target.value),row:"4",class:"form-control"}):p("input",{value:t.value,onInput:t=>this.onInputChange(e,t.target.value),ref:t=>{this["form_"+Dt(e)]=t},class:"form-control "+i,type:"text"});else if("number"===t.type)r=p("input",{value:t.value,onInput:t=>this.onInputChange(e,t.target.value),ref:t=>{this["form_"+Dt(e)]=t},class:"form-control "+i,type:"number"});else if("boolean"===t.type)r=p("div",{class:"checkbox"},p("input",{type:"checkbox",id:"form-checkbox"+Dt(e),onInput:t=>this.onBooleanChange(e,t),checked:t.value}),p("label",{class:"checkbox--label",for:"form-checkbox"+Dt(e)},t.label),p("div",{class:"checkbox--check"},p("div",null)));else if("group"===t.type)r=a.a.map(t.list,r=>p("div",{class:"radio"},p("input",{type:"radio",id:"form-radio"+Dt(e)+Dt(r.value),checked:t.value===r.value,onInput:t=>this.onInputChange(e,r.value)}),p("label",{class:"radio--label",for:"form-radio"+Dt(e)+Dt(r.value)},r.label),p("div",{class:"radio--check"},p("div",{class:"inside"}))));else if("list"===t.type){let i=this.state.formData[e].value||[],n=a.a.filter(a.a.get(t,"list",[]),t=>!a.a.includes(i,t));r=p(it,{selected:i,items:n,onAddItem:t=>this.onListAddItem(e,t),onRemoveItem:t=>this.onListRemoveItem(e,t)})}else"datetime"===t.type&&(r=p("input",{value:t.value,onInput:t=>this.onInputChange(e,t.target.value),class:"form-control "+i,type:"date"}));let n=t.label;return"fullname"===t.key?n=this.$t("fullname"):"emails"===t.key?n=this.$t("email"):"phones"===t.key&&(n=this.$t("phones")),p("div",null,p("div",{class:"label"},n,t.is_required?p("span",{class:"ml-1 red"},"*"):""),t.error?p("div",{class:"form-control--valid-input--error"},t.error):"",r)});return p("div",{class:"pt-2"},t)}renderForm(t,e){let r=null;return this.state.creating&&(r=p(kt,{size:"16",mode:"white"})),p("div",{class:"widget-body"},p(Rt,{form:t,onMount:t=>this.formMounted(t)}),p("div",{class:"widget-body--content flex-grow-1 pl-3 pr-3 d-flex flex-column"},p("div",{class:"flex-grow-1"},p("div",{class:"form mt-3 pl-3 pr-3 pt-3 pb-3 d-flex flex-column"},p("div",null,a.a.get(t,"title",this.$t("capture_lead_title"))),this.renderFields())),p(W,{store:this.props.store})),p("div",{class:"message-input message-input--preform"},p("button",{class:"btn--start-convo",onClick:e=>this.submitPrechatForm(t)},e,"  ",r)))}goToConvo(t){this.props.onGo({view:"chat",cid:t})}renderConvoList(){let t=this.props.store.matchConvo("*");var e=a.a.map(t,t=>this.props.store.matchConvo(t.id));e=a.a.filter(e,t=>!!t),e=a.a.orderBy(e,"created","desc");var r=a.a.map(e,t=>{var e=a.a.agentsOfConvo(t);return p("div",{class:"convo-list--item",onClick:()=>this.goToConvo(t.id),key:t.id},p(G,{store:this.props.store,mode:"member",class:"d-flex flex-row",tooltipPos:"right",agent_ids:e}),this.renderConvoSummary(t))});let i=p("div",{class:"convo-list--list"},r);return 0===a.a.size(e)&&(i=p("div",{class:"convo-list--list"},p("div",{class:"empty-container"},p("img",{src:Et}),p("div",{class:"empty-desc"},this.$t("empty_convo"))))),p("div",{class:"convo-list"},p("div",{class:"convo-list--container"},p("div",{class:"convo-list--title"},this.$t("conversations")),i),p("div",{class:"convo-list--footer"},p("button",{class:"btn--start-convo",onClick:t=>this.goToConvo("")},p("span",null,this.$t("start_conversation")),p("img",{src:Ot,alt:!0})),p(W,{store:this.props.store})))}blur(){if(!this.props.store.isPreview){var t=this.msgInput;t&&(setTimeout(()=>t.blur()),setTimeout(()=>t.blur(),300))}}focusInput(){if(!this.props.store.isPreview){if(this.shouldShowForm()){let t="";return a.a.map(this.state.formData,(e,r)=>{"text"===e.type&&(t||e.value||(t=r))}),void setTimeout(()=>{var e=this["form_"+Dt(t)];e&&e.focus()},300)}var t=this.msgInput;t&&(setTimeout(()=>t.focus()),setTimeout(()=>t.focus(),300))}}onRate(t){this.props.cid&&(this.props.store.sendConvoEvent(this.props.cid,"conversation_rated",{conversation:{ratings:[t]}}),this.focusInput())}async sendMessage(t){let e=t.text;if(!this.props.cid){this.creating=!0;const{convo:r,error:i}=await this.props.store.startConvo({message:e});return this.creating=!1,this.props.store.sendConvoEvent(r.id,"message_sent",{message:t}),void this.props.onGo({view:"chat",cid:r.id})}this.props.store.sendConvoEvent(this.props.cid,"message_sent",{message:t})}createPostback(t){this.props.store.createPostback(this.props.cid,t)}renderChat(){let t=p(J,{store:this.props.store,ref:t=>this.msgInput=t,cid:this.props.cid,onSend:t=>this.sendMessage(t)}),e=this.props.store.matchConvo(this.props.cid)||{};return(this.isFormRequired()||"ended"===e.state)&&(t=p("div",{class:"message-input message-input--preform"},p("button",{class:"btn--start-convo",onClick:t=>this.onStartConvoClick(t)},this.$t("offline_preform_btn")))),p("div",{class:"widget-body"},p("div",{class:"widget-body--content",onClick:t=>this.onContainerClick(t)},p(xt,{isShow:this.props.isShow,store:this.props.store,onFormSubmit:t=>this.onEventFormSubmit(t),ref:t=>this.events=t,cid:this.props.cid,creating:this.creating,onSend:t=>this.sendMessage(t),onPostback:t=>this.createPostback(t)}),p(At,{store:this.props.store,cid:this.props.cid})),p(Ft,{store:this.props.store,onRate:t=>this.onRate(t),cid:this.props.cid}),t)}async onStartConvoClick(){if("ended"===(this.props.store.matchConvo(this.props.cid)||{}).state)return this.props.onGo({view:"chat",cid:""});this.setState({clickedJoin:!0})}onEventFormSubmit(){this.focusInput()}onContainerClick(){window.getSelection().toString().length>0||"mobile"!==jt.platform.type&&this.focusInput()}isFormRequired(){let t,e=this.props.store.matchAccountSetting()||{};a.a.get(e,"prechat_form.enabled")&&(t=e.prechat_form);let r=a.a.get(e,"offline_form.enabled");if(!e.is_online&&r&&(t=e.offline_form),!t)return!1;let i=this.fillForm(t),n=this.props.store.matchConvo(this.props.cid)||{};return"ended"===n.state||!this.userHasSent(this.props.cid)&&(n.state&&"pending"!==n.state&&delete i.group,!!a.a.find(i,t=>null==t.value||""===t.value))}renderConvoSummary(t){var e=this.agentsOfConvo(t),r=a.a.each(e,t=>t.fullname).join(", ");r||(r=this.props.store.matchAccount().name),r||(r=this.$t("agent"));var i=null;"user"===t.lastSenderType&&(i=p("span",{class:"yourmessage"},this.$t("you"),":"));var n=new Date(a.a.getMs(t.last_actived)||a.a.getMs(t.created)),s=p(yt,{ago:!0,time:n,key:(new Date).getTime()});let o=null;"ended"===t.state&&(o=p("img",{class:"convo-list--convo-completed",src:Pt}));let u=this.props.store.listEvents(t.id),c=a.a.isConvoSeen(this.props.store.matchUser().id,u),l=a.a.orderBy(u,"created","desc").filter(t=>"message_sent"===t.type).filter(t=>"user"!==a.a.get(t,"by.type")).filter(t=>a.a.get(t,"data.message.text"));var h=this.renderMessagePreview(l[0]||{data:{message:a.a.get(t,"last_message")}});let d=c?null:p("div",{class:"convo-list--item-unread"});return p("div",{class:"convo-list--convo-last-info"},p("div",{class:"d-flex flex-row"},p("div",{class:"convo-list--convo-name"},r),p("div",{class:"convo-list--convo-time"},s)),p("div",{class:"d-flex flex-row"},p("div",{class:"convo-list--convo-last-message"},i,o,h),d))}agentsOfConvo(t){let e=this.props.store.matchAgent("*");var r=a.a.agentsOfConvo(t);return a.a.map(r,t=>e[t]||{avatar_url:"https://file-subiz.com/fiqoahedjbgwclpouoml-avatar_default_baa8a1d7.png",fullname:"Offline Agent"})}renderMessagePreview(t){let e=this.$t("sent_you_a_message"),r=a.a.get(t,"data.message.text");if("plaintext"!==a.a.get(t,"data.message.format")&&(r=e),!r&&a.a.size(a.a.get(t,"data.message.attachments"))>0&&(r=e),!r)return null;let i=a.a.get(t,"by.type");return a.a.map(a.a.extractText(r),t=>"emoji"===t.type?p(L,{emojiCode:t.text,byType:i}):t.text)}userHasSent(t){var e=this.props.store.matchConvo(t)||{};let r=this.props.store.matchUser();if(a.a.find(e.members,t=>t.id===r.id&&"active"===t.membership))return!0;var i=this.props.store.listEvents(t)||{};return a.a.find(i,t=>a.a.get(t,"by.id")===r.id&&"message_sent"===t.type)}fillForm(t){if(0===a.a.size(t))return[];var e={};let r=this.props.store.matchUser();return a.a.each(t.fields,t=>{var i=Object.assign({},t);i.value=a.a.getUserAttr(r,t.key,t.type),"boolean"!==t.type||i.value||(i.value=!1),"datetime"===t.type&&i.value&&(i.value=new Date(e.value).toLocaleDateString("en-CA")),"list"===t.type&&(i.list=t.list),e["attr:"+t.key]=i}),t.group_required&&a.a.size(t.groups)>0&&(e.group={key:"group",is_required:!!t.group_required,label:t.group_label,type:"group",list:a.a.map(t.groups,t=>({value:t.id,label:t.name}))}),e}}class Rt extends D{componentDidMount(){this.props.onMount(this.props.form)}}function Dt(t){return btoa(t).split("=").join("")}const Lt=r(17).getParser(window.navigator.userAgent).parsedResult;class It extends D{constructor(t){super(t)}async componentDidMount(){if(this.setState({isShowWidget:!1,widgetView:"",widgetConvoId:""}),this.props.store.onConvoEvent(this,t=>this.checkExpand()),this.props.store.onUpdate(this,t=>this.checkExpand()),this.props.store.matchIsOpen()&&this.props.store.matchLastview().view){if("mobile"===Lt.platform.type)return;this.showWidget(Object.assign({},this.props.store.matchLastview().opts,{view:this.props.store.matchLastview().view}))}else this.hideWidget()}render(){return a.a.isUserBanned(this.props.store.matchUser())?null:p("div",{class:"mobile"===Lt.platform.type?"mobile":"desktop"},p($,{store:this.props.store,key:"chat_button",ref:t=>this.refButton=t,isShow:!this.state.isShowWidget,onClick:t=>this.showWidget(t)}),p(Tt,{store:this.props.store,view:this.state.widgetView,cid:this.state.widgetConvoId,isShow:this.state.isShowWidget,onClose:t=>this.onWidgetClose(t),onGo:t=>this.showWidget(t)}))}checkExpand(){if("mobile"===Lt.platform.type)return;if(this.props.store.matchHasManuallyClosed())return;let t=this.props.store.matchConvo("*"),e=a.a.find(t,t=>{let e=this.props.store.listEvents(t.id);return!a.a.isConvoSeen(this.props.store.matchUser().id,e)});e&&e.id&&(this.state.isShowWidget||this.showWidget({view:"chat",cid:e.id}))}async showWidget(t){this.refButton.current&&this.refButton.current.clearPreview(),t=t||{},"mobile"===Lt.platform.type&&function(){let t=document.createElement("meta");t.httpEquiv="X-UA-Compatible",t.name="viewport",t.id="subiz-meta-viewport",t.content="maximum-scale=1.0, user-scalable=no, width=device-width, initial-scale=1.0",document.getElementsByTagName("head")[0].appendChild(t)}(),this.setState({widgetConvoId:t.cid,widgetView:t.view}),this.props.store.setIsOpen(!0),this.forceUpdate(),this.setState({isShowWidget:!0}),this.props.store.setLastview(t.view,{cid:t.cid})}hideWidget(){!function(){let t=document.getElementById("subiz-meta-viewport");t&&t.remove()}(),this.props.store.setIsOpen(!1),this.setState({isShowWidget:!1})}onWidgetClose(){this.refButton.current&&this.refButton.current.clearPreview(),this.props.store.setHasManuallyClosed(),this.hideWidget()}}r(88);var Ut=r(113).default,$t=r(114).default,zt=r(62).default,Bt={kv:Ut,lsdb:r(115).default,chain:$t,inmem_localstorage:zt};const qt=r(63);qt.env.XMLHttpRequest=window.XMLHttpRequest;const Nt=t=>t.answer;function Wt(t,e){let r=t.request;"text/plain"===r.content_type&&void 0!==r.body&&(r.body=a.a.stringify(r.body)),e(!0)}var Gt=r(60),Ht=r(117),Yt=r(119),Vt=r(120);Yt.defaults.path="/",Yt.expiresMultiplier=86400,Yt.defaults.expires=3650;var Jt=r(121),Qt=r(11);r(122);const Zt=()=>r.e(69).then(r.bind(null,262)),Kt=()=>r.e(68).then(r.bind(null,263));let Xt=r.e(2).then(r.bind(null,264));class te{constructor(t,e,r,i){this.inmem=!1,this.cookie=Yt,this.isPreview=!1,this.forceAccSetting={},this.new_visitor=!0,this.matchUser=()=>(this._touchAcc(),this.kv.match("user")),this.matchSession=()=>this.kv.match("session")||{},this.matchAccount=()=>this.kv.match("account"),this.device={},this.browserVisibility="visible",this.matchAgent=t=>{let e=this.kv.match("agent")||{};return"*"===t?e:e[t]},this.matchAccountSetting=()=>{this._touchAcc();let t=this.kv.match("account_setting")||{};return a.a.assignDeep({},t,this.forceAccSetting)},this.matchConvo=t=>{if(t)return"*"===t?(this._touchAcc(),a.a.filter(this.kv.all(),(t,e)=>e.startsWith("convo_"))):(this.isInsync(t)||this.fetchConvo(t),this.kv.match("convo_"+t))},this.fetchConvo=async t=>{if(await this.readyGate.entry(),await this.reconnectGate.entry(void 0,!0),this.isInsync(t))return this.reconnectGate.open();this.markSync(t);let{body:e,error:r}=await this.api.getConversation(t);return e&&!r&&this._setConvo(e),this.reconnectGate.open()},this.listEvents=t=>{if(t&&"*"!==t&&"string"==typeof t)return this.isInsync("events"+t)||setTimeout(async()=>(await this.readyGate.entry(),await this.reconnectGate.entry(void 0,!0),this.isInsync("events"+t)||(this.markSync("events"+t),await this.chain.reload(t,(t,e,r)=>this.listmessageapi(t,e,r)),this.pubsub.publish("account")),this.reconnectGate.open()),10),this.chain.listM(t)},this.fetchMoreEvents=async t=>{let{error:e}=await this.chain.fetchMore(t,50,(t,e,r)=>this.listmessageapi(t,e,r));return this.pubsub.publish("account"),{error:e}},this.matchCampaign=()=>this.kv.match("campaign")||{},this.matchBot=()=>this.kv.match("bot")||{},this.readyGate=new a.a.Gate,this.convoGate=new a.a.Gate(!0),this.reconnectGate=new a.a.Gate(!0),this.matchLastview=()=>this.kv.match("lastview")||{},this.matchIsOpen=()=>!!this.kv.match("isopen"),this.matchHasManuallyClosed=()=>!!this.kv.match("hasManuallyClosed"),this.matchClosePreviewAt=()=>this.kv.match("close_preview_at")||0,this.sendPresence=a.a.throttle(async()=>{if(!this.isPreview&&(await this.readyGate.entry(),a.a.get(this.kv.match("user"),"id")&&!a.a.isUserBanned(this.kv.match("user"))))return this.api.sendPresence(this.device,"visible"===this.browserVisibility&&document.hasFocus())},1e3),this.now=()=>Date.now()+this.timeDiff,this.seenQueue=[],this._typing=a.a.throttle(t=>this.api.sendTyping(t),3e3),this.onConvoEvent=(t,e)=>this.pubsub.on2(t,"events",e),this.seenConvo=t=>{t&&"create"!==t&&this.seenQueue.push(t)},this.onUpdate=(t,e)=>this.pubsub.on2(t,"account",e),this.setHasManuallyClosed=()=>this.kv.put("hasManuallyClosed",!0),this.setIsOpen=t=>{let e=this.kv.match("isopen");this.kv.put("isopen",t),!e&&t&&Vt.sendEventToThirdParty("SUBIZ Chat","Opened","Subiz Windows")},this.closePreview=()=>this.kv.put("close_preview_at",(new Date).getTime()),this.setLastview=(t,e)=>this.kv.put("lastview",{view:t,opts:e}),this.matchImpressionLogs=t=>(this.kv.match("campaign_impression_logs")||{})[t],this.timeDiff=0,this.lang={},this.g_sync={},this.forceLang={},this.RealtimeURL=r,this.FileURL=e,this.api=new class{constructor(t,e){this.listConversations=t=>this.apireq.addQuery("user_id",this.uid).addQuery("integration_id",this.accid+".subizv4.subikon").get("/conversations"),this.listMessages=(t,e,r)=>this.apireq.addQuery("limit",e).addQuery("start_id",r).get(`/conversations/${t}/messages`),this.ajax=qt,this.start=t=>{let e={starter_id:this.uid,starter_type:"user",integration_id:this.accid+".subizv4.subikon"};return a.a.each(t,(t,r)=>{e[r]=t}),this.apireq.post("/conversations",e)},this.sendConvoEvent=(t,e)=>this.apireq.post(`/accounts/${this.accid}/conversations/${t}/events`,e),this.createPostback=(t,e)=>this.apireq.post(`/accounts/${this.accid}/conversations/${t}/postbacks`,e),this.markAsReceived=(t,e)=>this.apireq.post(`/conversations/${t}/messages/${e}/receive`),this.markAsSeen=(t,e)=>this.apireq.post(`/conversations/${t}/messages/${e}/seen`),this.getConversation=t=>this.apireq.get("/conversations/"+t),this.sendEvent=t=>this.apireq.post(`/users/${this.uid}/events`,t),this.sendTyping=t=>this.apireq.post(`/conversations/${t}/typing`),this.uploadToS3=async t=>{let{body:e,error:r}=await this.apireq.post(`/accounts/${this.accid}/files`,{account_id:this.accid,description:"upload\n user-client: web-widget",name:t.name.replace(/\s+/g,"_"),size:t.size,type:t.type});if(r)return{error:r};let i,n=t.type||"application/octet-stream";return({error:r}=await qt.setContentType(n).put(e.signed_url,t)),r?{error:r}:(({body:i,error:r}=await this.apireq.post(`/accounts/${this.accid}/files/${e.id}`,{account_id:this.accid})),r?{error:r}:{url:this.FileURL+"/"+i.url})},this.getChallenge=t=>this.apireq.post(`/accounts/${t}/scrypt-challenges`),this.time=t=>this.apireq.get("/time"),this.updateUser=t=>this.apireq.post("/users/"+this.uid,t),this.getUserSetting=()=>this.apireq.get(`/accounts/${this.accid}/widgets/${this.uid}`),this.updateUserSetting=t=>this.apireq.post(`/accounts/${this.accid}/widgets/${this.uid}`,t),this.sendImpression=t=>this.apireq.post(`/accounts/${this.accid}/campaigns/${t.campaign_id}/impressions`,t),this.sendConversion=t=>this.apireq.post(`/accounts/${this.accid}/campaigns/${t.campaign_id}/conversions`,t),this.setGoalReached=t=>this.apireq.post(`/accounts/${this.accid}/campaigns/${t.campaign_id}/user-campaign-status`,t),this.FileURL=e,this.apireq=qt.setBaseUrl(t).setContentType("text/plain").beforeHook(Wt).setParser("json").beforeHook((t,e)=>(this.mask&&(t.request=t.request.addQuery("x-user-mask",this.mask)),e(!0)))}setAuth(t){this.accid=t.accid,this.mask=t.mask,this.uid=t.uid}sendPresence(t,e){return this.sendEvent({by:{id:this.uid,device:t},type:"presence_updated",data:{presence:{pinged:Date.now(),is_focused:e}}})}sendContent(t,e,r){return this.sendEvent({by:{id:this.uid,device:t},type:"content_viewed",data:{product:{url:e,title:r}}})}async createUser(t){for(var e=0;e<10;e++){const{body:e}=await this.getChallenge(t),r=Nt(e),i={challenge_id:e.id,answer:""+r};let{body:n,error:s}=await this.apireq.post(`/accounts/${t}/scrypt-challenges/users`,i);if(!s)return n;await a.a.sleep(1e3)}}}(t,e),this.cssStyleDiv=document.createElement("style"),document.head.appendChild(this.cssStyleDiv),this.cssStyleDiv.type="text/css",this.cssStyleDiv.id="subiz-style-"+a.a.randomString(10),i&&(this.inmem=i,this.cookie=Jt.inmemCookie),this.pubsub=new a.a.Pubsub,this.kv=new Bt.kv(new Bt.lsdb("sbz2020",this.inmem),"kv"),this.chain=new Bt.chain(new Bt.lsdb("cbz2020",!0),"ch"),this.g_haveSentSeenM={},window.addEventListener("blur",()=>this.sendPresence()),window.addEventListener("focus",()=>this.sendPresence()),setInterval(()=>this.sendPresence(),3e4),Jt.onVisibilityChange(t=>{this.browserVisibility=t,this.sendPresence()}),this.loopTime(),this.device=Vt.getDeviceInfo();const n=setInterval(()=>{let t=this.kv.match("user")||{};if(!t.id)return;var e=Vt.getDeviceInfo();if(!e.ga_tracking_ids||!e.ga_client_id)return;clearInterval(n),this.device=e;let r=e.ga_client_id;r!==a.a.getUserAttr(t,"ga_client_id","text")&&this.setUser({attributes:[{type:"text",text:r,key:"ga_client_id"}]})},2e3)}isInsync(t){return Date.now()-(this.g_sync[t]||0)<5e4}disconnect(t){this.g_sync[t]=0}markSync(t){this.g_sync[t]=Date.now()}async _touchAcc(){this.isInsync("account")||(await this.readyGate.entry(),this.isInsync("account")||this.reconnect())}async init(t){this.readyGate.close(),t=(t||"").trim(),this.api.setAuth({accid:t}),this.g_sync={};let e="";try{e=this.cookie.get("__sbmask","")}catch(t){}let r=this.kv.match("mask");!e&&r&&(e=r),e&&r&&e!==r&&this.clearBrowserData();var i="";if(e){let r=e.split("@");r[0]!=t?(e="",this.clearBrowserData()):i=r[1]}if(e)this.new_visitor=!1;else{let r=await this.api.createUser(t);this.new_visitor=!0,e=r.mask,i=r.id}this.cookie.set("__sbmask",e),this.kv.put("mask",e),this.realtime&&this.realtime.stop(),this.realtime=new Ht(this.RealtimeURL,{user_mask:e}),this.realtime.onEvent(this.onWs.bind(this)),this.realtime.onInterrupted(()=>this.reconnectWs(t,i)),this.api.setAuth({accid:t,uid:i,mask:e}),this.seenLoop();let n=this.kv.match("account");0===a.a.size(n)?await this.reconnect():(this.reconnect(),await this._setAccountSetting(this.kv.match("account_setting"))),this.readyGate.open(),this.reconnectWs(t,i)}seenLoop(){this.seenQueue=[],clearInterval(this._seenInterval),this._seenInterval=setInterval(()=>{this.seenQueue=[...new Set(this.seenQueue)];let t=this.kv.match("user")||{};a.a.map(this.seenQueue,e=>{var r=this.listEvents(e);if(!r)return;if(0===a.a.size(r))return;var i=(r=a.a.filter(r,t=>"message_sent"===t.type))[a.a.size(r)-1];if(!i)return;if(this.g_haveSentSeenM[i.id])return;let n=a.a.get(i,"data.message.pongs",[]);a.a.find(n,e=>"seen"===e.type&&e.member_id===t.id)||i.id!==a.a.getMsgField(i,"idempotency")&&(this.api.markAsSeen(e,i.id),this.g_haveSentSeenM[i.id]=!0)}),this.seenQueue=[]},1e3)}async reconnectWs(t,e){return await this.realtime.subscribe([`conversation_state_updated.account.${t}.user.${e}`,`conversation_joined.account.${t}.user.${e}`,`conversation_left.account.${t}.user.${e}`,`conversation_typing.account.${t}.user.${e}`,`message_sent.account.${t}.user.${e}`,`conversation_pending.account.${t}.user.${e}`,`user_info_updated.account.${t}.user.${e}`,`message_pong.account.${t}.user.${e}`,`conversation_rating_requested.account.${t}.user.${e}`,`conversation_rated.account.${t}.user.${e}`]),this.disconnect("account"),await this.readyGate.entry(),this.reconnect()}async reconnect(){if(!this._die&&!this.isPreview)return await this.reconnectGate.entry(void 0,!0),this.isInsync("account")||(this.markSync("account"),await Promise.all([(async()=>{let{body:t,error:e}=await this.api.getUserSetting();if(!e)return this._setSetting(t)})(),(async()=>{let{body:t,error:e}=await this.api.listConversations();if(!e){let e=a.a.get(t,"conversations",[]);a.a.map(this.kv.all(),(t,e)=>{e.startsWith("convo_")&&this.now()-a.a.getMs(a.a.get(t,"actived"))>12096e5&&this.kv.del(e)}),a.a.map(e,t=>this._setConvo(t))}})()])),this.reconnectGate.open()}preview(){this.isPreview=!0}async setAccountSettingForce(t){this.forceAccSetting=t,await this._setAccountSetting(this.kv.match("account_setting"))}async setUser(t){if(t&&(await this.readyGate.entry(),this._setUser(t),!this.isPreview))return this.api.updateUser(t)}_setUser(t){let e=this.kv.match("user")||{};var r=e.account_id||t.account_id,i=e.id||t.id;a.a.each(t.attributes,t=>{t&&(e.attributes=a.a.filter(e.attributes,e=>!!e&&e.key!==t.key))}),e.attributes=e.attributes||[],e.attributes=e.attributes.concat(t.attributes),e.account_id=r,e.id=i,this.kv.put("user",e),this.pubsub.publish("account")}setCss(t){this.cssStyleDiv.styleSheet?this.cssStyleDiv.styleSheet.cssText=t:(this.cssStyleDiv.innerHTML="",this.cssStyleDiv.appendChild(document.createTextNode(t)))}async setSetting(t){if(t)return await this.readyGate.entry(),this._setSetting(t)}fixMissingSetting(t){a.a.get(t,"account.logo_url")||a.a.set(t,"account.logo_url","https://file-subiz.com/fiqpezhkmeyesdscyetk-default_logo.jpg"),a.a.get(t,"account_setting.desktop_button.background_image_url")&&(t.account_setting.desktop_button.background_image_url=this.replaceFileUrl(t.account_setting.desktop_button.background_image_url)),a.a.get(t,"account_setting.desktop_button.background_mask_url")&&(t.account_setting.desktop_button.background_mask_url=this.replaceFileUrl(t.account_setting.desktop_button.background_mask_url)),a.a.get(t,"account_setting.mobile_button.background_image_url")&&(t.account_setting.mobile_button.background_image_url=this.replaceFileUrl(t.account_setting.mobile_button.background_image_url)),a.a.get(t,"account_setting.mobile_button.background_mask_url")&&(t.account_setting.mobile_button.background_mask_url=this.replaceFileUrl(t.account_setting.mobile_button.background_mask_url))}async _setSetting(t){if(t=a.a.cloneDeep(t),this.fixMissingSetting(t),t.user){let e=this.matchSession(),r=t.user.session;for(r?r.id===e.id&&(r._urls=e._urls):r=e,r._urls=r._urls||[],r._urls.push(location.href);r._urls.length>1e3;)r._urls.shift();this.kv.put("session",r),delete t.user.session,this._setUser(t.user)}t.account&&(this.kv.put("account",t.account),delete t.account);let e=a.a.get(t,"bots",[]),r={};a.a.map(e,t=>{r[t.id]=t}),this.kv.put("bot",r);let i=a.a.get(t,"campaigns",[]),n={};a.a.map(i,t=>{n[t.id]=t}),this.kv.put("campaign",n),t.account_setting&&await this._setAccountSetting(t.account_setting),this.pubsub.publish("account")}async _setAccountSetting(t){var e=t.agents||[];if(e.length>0){let r={};a.a.map(e,t=>{r[t.id]=t}),this.kv.put("agent",r),delete t.agents}let r=a.a.assignDeep({},t,this.forceAccSetting),i=(await Xt).default.default.toString(),n=Jt.replaceCssVariable(i,r);this.setCss(n),this.setLanguage(r.language,r.custom_language_url),this.kv.put("account_setting",t)}async setLanguage(t,e,r){var i=t||"";a.a.isValidLanguageCode(i)||(i=navigator.language);const n=this.replaceFileUrl(e);if(r=r||{},n&&t===i){const{body:t}=await this.api.ajax.get(n);r=Object.assign({},t,r)}Qt.locale(i),this.pubsub.publish("lang",{code:i,custom:r});var s="vi-VN"===i||"vi"===i?Zt:Kt,o=a.a.get(await s(),"default.translations",{});let u={};a.a.map(o,t=>{let e=a.a.get(t,[Object.keys(t)[0]],{});u[a.a.trimStart(e.msgctxt,".")]=e.msgstr[0]}),this.lang=Object.assign({},u,r)}async track(){if(this.isPreview)return;this.kv.match("user");await this.api.sendContent(this.device,location.href,document.title),this.sendPresence()}async onWs(t){if(!t||!t.type)return;t.created=a.a.getMs(t.created);let e=this.kv.match("user")||{};const r=a.a.getIntegrationId(e.account_id);let i,n=a.a.convoOfEv(t);if(n){if(i=this.matchConvo(n),!i||!i.id){let{body:t,error:e}=await this.api.getConversation(n);if(!t)return;i=t}let e=a.a.get(i,"integration.id","");if(e||(e=a.a.get(t,"data.message.integration_id","")),!e||e!==r)return;this.pubsub.publish("events",t)}if("conversation_joined"===t.type){let e=a.a.get(t,"data.conversation.members",[]);a.a.find(e,t=>t.id===this.kv.match("user").id)&&(await this.chain.reload(n,(t,e,r)=>this.listmessageapi(t,e,r)),this.markSync("events"+n),this.pubsub.publish("account"))}if("message_sent"===t.type&&a.a.get(t,"by.id")!==e.id&&this.api.markAsReceived(n,t.id),a.a.startsWith(t.type,"message_")||a.a.startsWith(t.type,"conversation_"))return this.restConvoEvent(t),void("message_sent"===t.type&&a.a.get(t,"by.id")!==e.id&&Vt.sendEventToThirdParty("SUBIZ Chat","Received","User"));if("user_info_updated"===t.type){let e=a.a.cloneDeep(this.kv.match("user")),r=a.a.get(t,"data.user.attributes")||[];return a.a.map(r,t=>a.a.setUserAttr(e,t)),void this._setUser(e)}}async restConvoEvent(t){let e=this.kv.match("user");a.a.backwardCompatibleEv(t,e);let r=a.a.convoOfEv(t),i=this.kv.match("convo_"+r)||{};if("conversation_state_updated"===t.type){if(!a.a.get(i,"id")){let{body:t,error:e}=await this.api.getConversation(r);if(e)return}i=Object.assign(i,a.a.get(t,"data.conversation")),this._setConvo(i)}if("message_pong"===t.type){var n=a.a.get(t,"data.message.id"),s=this.chain.match(r,n);if(!a.a.get(s,"data.message"))return;var o=a.a.get(s,"data.message.pongs",[]);o=o.concat(a.a.get(t,"data.message.pongs",[])),s.data.message.pongs=o,this.chain.put(r,s.id,a.a.getMs(s.created),s)}if("message_sent"===t.type){let e=a.a.getMsgField(t,"idempotency"),n=a.a.find(this.listEvents(r),t=>t.id===e);n&&(this.chain.del(r,n.id),t.created=n.created),i.last_message=a.a.get(t,"data.message",{}),i.last_message_id=t.id,this._setConvo(i)}"message_pong"!==t.type&&"conversation_typing"!==t.type&&this.chain.put(r,t.id,a.a.getMs(t.created),t),this.pubsub.publish("account")}handleFormSubmit(t,e){if("message_sent"!==e.type)return;let r=[],i=a.a.get(e,"data.message.attachments")||[];a.a.each(i,t=>{t&&"form_submit"===t.type&&r.push(t.form_submit)}),a.a.each(r,e=>{let r=a.a.get(this.convoEventM,t+"."+e.form_message_id);if(!r)return;let i=a.a.filter(a.a.get(r,"data.message.attachments"),t=>!!t&&("form"===t.type||"ask_info_form"===t.type));a.a.each(i,t=>{t=t.form,a.a.each(t.fields,t=>{a.a.each(e.fields,e=>{t.name===e.name&&(t.default_answer||(t.default_answer=e.value))})})}),a.a.size(i)>0&&this.pubsub.publish("state.convoEventM",this.convoEventM,t)})}typing(t){t&&(this.isPreview||this._typing(t))}async startConvo(t){if(this.isPreview)return;this.convoGate.close();let{body:e,error:r}=await this.api.start(t);return this.convoGate.open(),r?{error:r}:(this._setConvo(e),{convo:e})}createPostback(t,e){if(!this.isPreview)return this.api.createPostback(t,e)}async sendConvoEvent(t,e,r){if(this.isPreview)return;var i=a.a.randomString(36);var n={id:i,by:{id:(this.kv.match("user")||{}).id,type:"user",device:{referrer:document.URL}},data:r,type:e,created:this.now()};a.a.convoToEv(t,n);let s=[];if("message_sent"===e&&(a.a.setMsgField(n,"idempotency",i),n.data.message.conversation_id=t,await Gt.map(n.data.message.attachments,2,async(t,e)=>{var r;"file"===t.type&&(t._file&&(s.push(t),ee.includes(t._file.type)&&(t.url=await(r=t._file,new Promise(t=>{var e=new window.FileReader;e.onload=e=>{t(e.target.result)},e.readAsDataURL(r)})))))})),this.onWs(n),await this.convoGate.entry(),await Gt.map(s,1,async t=>{const{url:e,error:r}=await this.api.uploadToS3(t._file);n._error=r,t.url=e}),n._error)return this.onWs(n);let{body:o,error:u}=await this.api.sendConvoEvent(t,n);if(u)return n._error=u,void this.onWs(n);this.onWs(o),Vt.sendEventToThirdParty("SUBIZ Chat","Sent","User")}_setConvo(t){let e=this.kv.match("user");const r=a.a.getIntegrationId(e.account_id);let i=a.a.get(t,"integration.id","");if(!i||i!==r)return;let n={};if(a.a.map(this.kv.all(),(t,e)=>{e.startsWith("convo_")&&(n[e]=t)}),a.a.size(n)>28){n=a.a.orderBy(a.a.map(n),"created","desc");for(var s=28;s<a.a.size(n);s++){let t=n[s];this.kv.del("convo_"+t.id)}}this.markSync(t.id),this.pubsub.publish("account"),this.kv.put("convo_"+t.id,t)}matchLastBotRun(t){return(this.kv.match("bot_run_logs")||{})[t]}logBotRun(t){let e=this.matchSession(),r=this.kv.match("bot_run_logs")||{};r[t]={bot_id:t,created:this.now(),session_id:e.id},this.kv.put("bot_run_logs",r)}sendImpression(t,e){let r=this.kv.match("user")||{},i=this.kv.match("campaign_impression_logs")||{},n=this.matchSession();return i[t]={campaign_id:t,created:this.now(),session_id:n.id},this.kv.put("campaign_impression_logs",i),this.api.sendImpression({account_id:r.account_id,campaign_id:t,user_id:r.id,url:window.location.href,device:this.device,by_trigger:e})}sendConversion(t,e,r,i){let n=this.kv.match("user")||{};return this.api.sendConversion({account_id:n.account_id,campaign_id:t,user_id:a.a.get(n,"id"),url:window.location.href,device:this.device,by_trigger:e,submission:r,impression_token:i})}setGoalReached(t){let e=this.kv.match("user")||{};return this.api.setGoalReached({account_id:e.account_id,campaign_id:t,user_id:e.id,status:"goal_reached"})}async listmessageapi(t,e,r){let i=t,{body:n,code:s,error:o}=await this.api.listMessages(i,-r,e);if(o||200!==s)return[[],e,o];e=a.a.get(a.a.last(n),"id"),n=a.a.map(n,t=>(t.created=a.a.getMs(t.created),{id:t.id,index:t.created,value:t}));let u=this.kv.match("user")||{};for(let t=0;t<n.length;t++){let e=n[t].value;if("message_sent"===e.type&&a.a.get(e,"by.id")!==u.id){if(a.a.find(a.a.get(e,"data.message.pongs"),t=>t.member_id===u.id))break;this.api.markAsReceived(i,e.id);break}}return[n,e]}async loopTime(){let t=Date.now();if(!a.a.get(this.kv.match("user"),"id"))return setTimeout(()=>this.loopTime(),3e4);let{body:e,error:r}=await this.api.time();if(r)return setTimeout(()=>this.loopTime(),3e4);var i=Math.abs(Date.now()-t)/2,n=new Date(e).getTime()+i,s=Date.now();this.timeDiff=Math.floor(n-s),setTimeout(()=>this.loopTime(),3e4)}$t(t){if(this.langdebug)return"{{"+t+"}}";let e=this.forceLang[t]||this.lang[t];return null==e?t:e}toggleLangDebugMode(){this.langdebug=!this.langdebug,this.pubsub.publish("account")}setLang(t){a.a.map(t,(t,e)=>this.forceLang[e]=t),this.langdebug=!1,this.pubsub.publish("account")}replaceFileUrl(t){if(!t)return"";if(a.a.startsWith(t,"data:"))return t;a.a.startsWith(t,"http://")||a.a.startsWith(t,"https://")||a.a.startsWith(t,"//")||(t=a.a.trim(this.FileURL,"/")+"/"+a.a.trimStart(t,"/"));let e=new URL(t);if(e.host.endsWith(".subiz.com")){let t=new URL(this.FileURL);return e.host=t.host,e.toString()}return t}clearBrowserData(){a.a.each(this.cookie.all(),(t,e)=>{(e||"").startsWith("__sb")&&this.cookie.remove(e)}),this.kv.destroy(),this.kv=new Bt.kv(new Bt.lsdb("sbz2020",this.inmem),"kv"),this.chain.destroy(),this.chain=new Bt.chain(new Bt.lsdb("cbz2020",!0),"ch")}destroy(){this._die=!0,this.clearBrowserData(),this.realtime&&this.realtime.stop(),this.readyGate.close()}}const ee=["image/gif","image/jpeg","image/png","image/svg+xml"],re=()=>{};var ie=document.createElement("link");ie.href="https://fonts.googleapis.com/css?family=Roboto:400,500&display=swap&subset=vietnamese",ie.rel="stylesheet",document.head.append(ie);class ne{constructor(t,e,r,i){this.showChatButton=()=>!1,this.showButton=()=>!1,this.hideChatButton=()=>!1,this.askPushNotification=re,this.askInfo=re,this.askFeedback=re,this.showProduct=re,this.version=()=>"4.25",this.preview=()=>this.store.preview(),this.upsertSetting=async t=>{await this.store.readyGate.entry(),this.store.setSetting({account_setting:t})},this.setSetting=t=>this.store.setSetting(t),this.getSetting=t=>({account_setting:a.a.cloneDeep(this.store.matchAccountSetting())}),this.getUser=()=>JSON.parse(JSON.stringify(this.store.matchUser())),this.sendWs=async t=>{await this.store.readyGate.entry(),this.store.onWs(t)},this.setCss=t=>this.store.setCss(t),this.domGate=new a.a.Gate,this.ref={current:null},this.store=new te(t,e,r,i),window.sbz_store=this.store}setInfo(t){if(t){var e=[];t.name&&e.push({key:"fullname",text:t.name}),t.email&&e.push({key:"emails",text:t.email}),t.phone&&e.push({key:"phones",text:t.phone}),0!==e.length&&this.updateUserAttributes(e)}}setLang(t){this.store.setLang(t)}toggleLangDebugMode(){this.store.toggleLangDebugMode()}async setAccount(t){return this.store.init(t)}_setAccount(t){return this.setAccount(t)}async updateUserAttributes(t){await this.store.setUser({attributes:t});let e=this.store.matchUser();return a.a.cloneDeep(e.attributes)}async getUserAttributes(){await this.store.readyGate.entry();let t=this.store.matchUser();return a.a.cloneDeep(a.a.get(t,"attributes",[]))}expandWidget(t,e){return this.showWidget(t,e)}shrinkWidget(){return this.hideWidget()}async sendMessage(t,e){await this.store.readyGate.entry(),this.store.sendConvoEvent(t,"message_sent",{message:e})}async startConvo(t){return await this.store.readyGate.entry(),this.store.startConvo(t)}async showWidget(t,e){await this.domGate.entry(),this.ref.current.showWidget({view:t,cid:e})}async hideWidget(){await this.domGate.entry(),this.ref.current.hideWidget()}async showConvo(t){await this.domGate.entry(),this.ref.current.showWidget({view:"chat",cid:t})}async setLanguage(t,e){a.a.isValidLanguageCode(t)&&(await this.store.readyGate.entry(),await this.store.setLanguage(t,"",e))}waitReady(){return this.store.readyGate.entry()}shadowSetting(t){this.store.setAccountSettingForce(t)}async destroy(){await this.store.readyGate.entry(),R(null,this.$div,this.$root),this.store.destroy(),this.store.setCss("")}async mount(t){this.$div=t,await this.store.readyGate.entry(),this.$root=R(p(It,{store:this.store,ref:this.ref}),t),this.domGate.open()}}window.__sbz_WIDGET=ne;var se=ne;if(window._subiz_init_2094850928430&&!window._subiz_init_2094850928430_keep_loading)throw new Error("subiz have already initialized");window._subiz_init_2094850928430=!0,window._subiz_init_2094850928430_keep_loading=!1;const oe=r(63),ae=r(123);let ue=window._sbzaccid?"4.3":function(){if(window.sbz_v4)return!0;var t=document.getElementsByTagName("script");if("function"!=typeof window.subiz)return!1;for(let e of t)if(e&&e.src){if(-1!==e.src.indexOf(ae.BaseURL))return!0;if(-1!==e.src.indexOf("https://widgetv4.subiz.com"))return!0;if(-1!==e.src.indexOf("https://widget.mysubiz.com"))return!0;if(-1!==e.src.indexOf("https://storage.googleapis.com/sbz"))return!0}return!1}()?"4.2":window.subiz_account_id&&window.subiz_account_id>0?"1":function(){var t=document.getElementsByTagName("script");if(!(window._sbzq instanceof Array))return!1;for(let e of t)if(e&&e.src){if(-1!==e.src.indexOf(ae.BaseURL))return!0;if(-1!==e.src.indexOf("https://widgetv4.subiz.com"))return!0}return!1}()?"4.1":function(){if(!window._sbzq)return!1;var t=document.getElementsByTagName("script");for(let e of t)if(e&&e.src&&-1!==e.src.indexOf("static.subiz.com"))return!0;return!1}()?"2":void 0;if(!ue)throw new Error("subiz cannot detect version");let ce=new se(ae.ApiURL,ae.FileURL,ae.RealtimeURL);function le(t){if(t=function(t,e){if(!t)return[];e||(e=t=>t);var r=[];if(Array.isArray(t)){for(let i=0;i<t.length;i++)r.push(e(t[i],i));return r}if("object"==typeof t){var i=Object.keys(t);for(let s=0;s<i.length;s++){var n=i[s];r.push(e(t[n],n))}return r}return r}(t,t=>t),Array.isArray(t)&&!(t.length<1)){var e=t.shift();if("function"==typeof ce[e])return ce[e](...t)}}window.addEventListener("keydown",t=>{"Escape"===t.key&&ce.hideWidget()});!async function(){if("1"===ue||"2"===ue){let t,e=window.subiz_account_id;if(!e){let t=window._sbzq||[];Array.isArray(t)||(t=[]),t.forEach(t=>{"_setAccount"===t[0]&&(e=t[1])})}console.log("GOT V3",e);try{let{body:r}=await oe.setParser("json").get(ae.ApiURL+"/__link?id="+e);if(t=r&&r.account_id,console.log("GOT V4",t),!t)return}catch(t){return void console.log(t)}window.subiz_account_id=t;let r=window._sbzq||[];Array.isArray(r)||(r=[]),r.forEach(e=>{"_setAccount"===e[0]&&(e[1]=t)})}if("1"===ue&&ce._setAccount(window.subiz_account_id),"2"===ue||"4.1"===ue){let t=window._sbzq||[];Array.isArray(t)||(t=[]),window._sbzq={push:le},t.forEach(t=>le(t))}if("4.2"===ue||"4.3"===ue){let t=window.subiz&&window.subiz.q||[];window.subiz=function(){return le(arguments)},t.forEach(t=>le(t))}ce.waitReady().then(()=>{var t=document.createElement("div");t.id="subiz",document.body.appendChild(t),ce.mount(t),ce.store.track(),window.sbz_store=ce.store,Promise.all([r.e(1),r.e(67)]).then(r.bind(null,259)).then(t=>new t.default(ce)),r.e(70).then(r.bind(null,260)).then(t=>new t.default(ce))})}()}]);